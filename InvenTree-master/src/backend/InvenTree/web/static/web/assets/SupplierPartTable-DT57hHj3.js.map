{"version":3,"file":"SupplierPartTable-DT57hHj3.js","sources":["../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconBuildingWarehouse.mjs","../../../../../../frontend/src/tables/purchasing/SupplierPartTable.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3 21v-13l9 -4l9 4v13\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M13 13h4v8h-10v-6h6\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M13 21v-9a1 1 0 0 0 -1 -1h-2a1 1 0 0 0 -1 1v3\", \"key\": \"svg-2\" }]];\nconst IconBuildingWarehouse = createReactComponent(\"outline\", \"building-warehouse\", \"BuildingWarehouse\", __iconNode);\n\nexport { __iconNode, IconBuildingWarehouse as default };\n//# sourceMappingURL=IconBuildingWarehouse.mjs.map\n","import { t } from '@lingui/core/macro';\nimport { Text } from '@mantine/core';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\n\nimport { ActionButton } from '@lib/components/ActionButton';\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowDuplicateAction,\n  RowEditAction\n} from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { IconPackageImport } from '@tabler/icons-react';\nimport ImportPartWizard from '../../components/wizards/ImportPartWizard';\nimport { useSupplierPartFields } from '../../forms/CompanyForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { usePluginsWithMixin } from '../../hooks/UsePlugins';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  BooleanColumn,\n  CompanyColumn,\n  DecimalColumn,\n  DescriptionColumn,\n  LinkColumn,\n  NoteColumn,\n  PartColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\nimport { TableHoverCard } from '../TableHoverCard';\n\n/*\n * Construct a table listing supplier parts\n */\n\nexport function SupplierPartTable({\n  manufacturerId,\n  manufacturerPartId,\n  partId,\n  supplierId\n}: Readonly<{\n  manufacturerId?: number;\n  manufacturerPartId?: number;\n  partId?: number;\n  supplierId?: number;\n}>): ReactNode {\n  const table = useTable('supplierparts');\n\n  const user = useUserState();\n\n  // Construct table columns for this table\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      PartColumn({\n        switchable: !!partId,\n        part: 'part_detail'\n      }),\n      {\n        accessor: 'part_detail.IPN',\n        title: t`IPN`,\n        sortable: false,\n        switchable: true\n      },\n      {\n        accessor: 'supplier',\n        sortable: true,\n        render: (record: any) => (\n          <CompanyColumn company={record?.supplier_detail} />\n        )\n      },\n      {\n        accessor: 'SKU',\n        title: t`Supplier Part`,\n        sortable: true\n      },\n      DescriptionColumn({}),\n      {\n        accessor: 'manufacturer',\n        title: t`Manufacturer`,\n        sortable: true,\n        render: (record: any) => (\n          <CompanyColumn company={record?.manufacturer_detail} />\n        )\n      },\n      {\n        accessor: 'MPN',\n\n        sortable: true,\n        title: t`MPN`,\n        render: (record: any) => record?.manufacturer_part_detail?.MPN\n      },\n      BooleanColumn({\n        accessor: 'active',\n        title: t`Active`,\n        sortable: true,\n        switchable: true,\n        defaultVisible: false\n      }),\n      DecimalColumn({\n        accessor: 'in_stock',\n        sortable: true\n      }),\n      {\n        accessor: 'packaging',\n        sortable: true,\n        defaultVisible: false\n      },\n      {\n        accessor: 'pack_quantity',\n        sortable: true,\n        render: (record: any) => {\n          const part = record?.part_detail ?? {};\n\n          const extra = [];\n\n          if (part.units) {\n            extra.push(\n              <Text key='base' size='sm'>\n                {t`Base units`} : {part.units}\n              </Text>\n            );\n          }\n\n          return (\n            <TableHoverCard\n              value={record.pack_quantity}\n              extra={extra}\n              title={t`Pack Quantity`}\n            />\n          );\n        }\n      },\n      LinkColumn({}),\n      NoteColumn({}),\n      {\n        accessor: 'available',\n        sortable: true,\n        defaultVisible: false,\n        render: (record: any) => {\n          const extra = [];\n\n          if (record.availablility_updated) {\n            extra.push(\n              <Text>\n                {t`Updated`} : {record.availablility_updated}\n              </Text>\n            );\n          }\n\n          return <TableHoverCard value={record.available} extra={extra} />;\n        }\n      }\n    ];\n  }, [partId]);\n\n  const supplierPartFields = useSupplierPartFields({\n    partId: partId\n  });\n\n  const addSupplierPart = useCreateApiFormModal({\n    url: ApiEndpoints.supplier_part_list,\n    title: t`Add Supplier Part`,\n    fields: supplierPartFields,\n    initialData: {\n      part: partId,\n      supplier: supplierId,\n      manufacturer_part: manufacturerPartId\n    },\n    table: table,\n    successMessage: t`Supplier part created`\n  });\n\n  const supplierPlugins = usePluginsWithMixin('supplier');\n  const importPartWizard = ImportPartWizard({\n    partId: partId\n  });\n\n  const tableActions = useMemo(() => {\n    return [\n      <AddItemButton\n        key='add-supplier-part'\n        tooltip={t`Add supplier part`}\n        onClick={() => addSupplierPart.open()}\n        hidden={!user.hasAddRole(UserRoles.purchase_order)}\n      />,\n      <ActionButton\n        key='import-part'\n        icon={<IconPackageImport />}\n        color='green'\n        tooltip={t`Import supplier part`}\n        onClick={() => importPartWizard.openWizard()}\n        hidden={\n          supplierPlugins.length === 0 ||\n          !user.hasAddRole(UserRoles.part) ||\n          !partId\n        }\n      />\n    ];\n  }, [user, partId, supplierPlugins]);\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'active',\n        label: t`Active`,\n        description: t`Show active supplier parts`\n      },\n      {\n        name: 'part_active',\n        label: t`Active Part`,\n        description: t`Show active internal parts`\n      },\n      {\n        name: 'supplier_active',\n        label: t`Active Supplier`,\n        description: t`Show active suppliers`\n      },\n      {\n        name: 'has_stock',\n        label: t`In Stock`,\n        description: t`Show supplier parts with stock`\n      }\n    ];\n  }, []);\n\n  const editSupplierPartFields = useSupplierPartFields({});\n\n  const [selectedSupplierPart, setSelectedSupplierPart] =\n    useState<any>(undefined);\n\n  const editSupplierPart = useEditApiFormModal({\n    url: ApiEndpoints.supplier_part_list,\n    pk: selectedSupplierPart?.pk,\n    title: t`Edit Supplier Part`,\n    fields: useMemo(() => editSupplierPartFields, [editSupplierPartFields]),\n    table: table\n  });\n\n  const duplicateSupplierPart = useCreateApiFormModal({\n    url: ApiEndpoints.supplier_part_list,\n    title: t`Add Supplier Part`,\n    fields: useMemo(() => editSupplierPartFields, [editSupplierPartFields]),\n    initialData: {\n      ...selectedSupplierPart,\n      active: true\n    },\n    table: table,\n    successMessage: t`Supplier part created`\n  });\n\n  const deleteSupplierPart = useDeleteApiFormModal({\n    url: ApiEndpoints.supplier_part_list,\n    pk: selectedSupplierPart?.pk,\n    title: t`Delete Supplier Part`,\n    table: table\n  });\n\n  // Row action callback\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !user.hasChangeRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedSupplierPart(record);\n            editSupplierPart.open();\n          }\n        }),\n        RowDuplicateAction({\n          hidden: !user.hasAddRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedSupplierPart(record);\n            duplicateSupplierPart.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !user.hasDeleteRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedSupplierPart(record);\n            deleteSupplierPart.open();\n          }\n        })\n      ];\n    },\n    [user, editSupplierPartFields]\n  );\n\n  return (\n    <>\n      {addSupplierPart.modal}\n      {editSupplierPart.modal}\n      {duplicateSupplierPart.modal}\n      {deleteSupplierPart.modal}\n      {importPartWizard.wizard}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.supplier_part_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          params: {\n            manufacturer: manufacturerId,\n            manufacturer_part: manufacturerPartId,\n            supplier: supplierId,\n            part: partId,\n            part_detail: true,\n            supplier_detail: true,\n            manufacturer_detail: true\n          },\n          rowActions: rowActions,\n          enableDownload: true,\n          tableActions: tableActions,\n          tableFilters: tableFilters,\n          modelType: ModelType.supplierpart\n        }}\n      />\n    </>\n  );\n}\n"],"names":["__iconNode","IconBuildingWarehouse","createReactComponent","SupplierPartTable","manufacturerId","manufacturerPartId","partId","supplierId","table","useTable","user","useUserState","tableColumns","useMemo","PartColumn","switchable","part","accessor","title","_i18n","_","id","sortable","render","record","CompanyColumn","supplier_detail","DescriptionColumn","manufacturer_detail","manufacturer_part_detail","MPN","BooleanColumn","defaultVisible","DecimalColumn","part_detail","extra","units","push","jsxs","Text","TableHoverCard","pack_quantity","LinkColumn","NoteColumn","availablility_updated","jsx","available","supplierPartFields","useSupplierPartFields","addSupplierPart","useCreateApiFormModal","url","ApiEndpoints","supplier_part_list","fields","initialData","supplier","manufacturer_part","successMessage","supplierPlugins","usePluginsWithMixin","importPartWizard","ImportPartWizard","tableActions","AddItemButton","open","hasAddRole","UserRoles","purchase_order","ActionButton","IconPackageImport","openWizard","length","tableFilters","name","label","description","editSupplierPartFields","selectedSupplierPart","setSelectedSupplierPart","useState","undefined","editSupplierPart","useEditApiFormModal","pk","duplicateSupplierPart","active","deleteSupplierPart","useDeleteApiFormModal","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","onClick","RowDuplicateAction","RowDeleteAction","hasDeleteRole","Fragment","modal","wizard","InvenTreeTable","apiUrl","params","manufacturer","enableDownload","modelType","ModelType","supplierpart"],"mappings":"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","x_google_ignoreList":[0]}