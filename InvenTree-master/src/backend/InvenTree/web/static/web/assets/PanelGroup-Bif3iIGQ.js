import{K as A,j as e,S as B,az as H,r as c,an as J,ao as O,e as V,u as G,a as X,bk as N,ab as w,bg as W,bh as Y,b8 as Z,$ as K,ar as S,M as ee,d as ae,b5 as R,aj as C,aa as T,N as $,a4 as ne,ai as se,g as te,ac as ie,bd as le}from"./index-Db7AGPIq.js";import{v as oe,g as re,h as F,j as ce,u as de,a as ue,E as he,B as U,S as pe}from"./ThemeContext-CxdCkKtz.js";import{A as xe}from"./Filter-BgnAqEQC.js";import{u as me,P as fe}from"./PluginUIFeature-DCu8wTdG.js";import{R as ge}from"./RemoteComponent-uZoHDwds.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 4v16",key:"svg-1"}],["path",{d:"M15 10l-2 2l2 2",key:"svg-2"}]],je=A("outline","layout-sidebar-left-collapse","LayoutSidebarLeftCollapse",be);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M15 4v16",key:"svg-1"}],["path",{d:"M9 10l2 2l-2 2",key:"svg-2"}]],ve=A("outline","layout-sidebar-right-collapse","LayoutSidebarRightCollapse",ye);function Pe({pluginFeature:s,pluginContext:r}){return e.jsx(B,{gap:"xs",children:e.jsx(ge,{source:s.source,defaultFunctionName:"renderPanel",context:r})})}function Se({instance:s,reloadFunc:r,model:t,id:l}){const d=H(),p=c.useMemo(()=>d.isSet("ENABLE_PLUGINS_INTERFACE"),[d]),u=oe({enabled:p&&!!t&&l!==void 0,queryKey:["custom-plugin-panels",t,l,s],throwOnError:i=>(console.error("ERR: Failed to fetch plugin panels"),!1),queryFn:async()=>{if(!p||!t)return Promise.resolve([]);const i=J(O.plugin_ui_features_list,void 0,{feature_type:fe.panel});return V.get(i,{params:{target_model:t,target_id:l}}).then(x=>x.data)}}),o=me(),v=c.useMemo(()=>({...o,id:l,model:t,instance:s,reloadInstance:r}),[t,l,s,o]),j=c.useMemo(()=>u?.data?.map(i=>{const x=i?.icon||"ti:plug:outline",m={...v,context:i.context};return{name:i.key,pluginName:i.plugin_name,label:i.title,icon:e.jsx(xe,{name:x}),content:e.jsx(Pe,{pluginFeature:i,pluginContext:m})}})??[],[u.data,v]);return c.useMemo(()=>({panels:j,isLoading:u.isLoading||u.isFetching,query:u}),[j,u])}var $e="vvj8hc0";function Le({pageKey:s,panels:r,groups:t,onPanelChange:l,selectedPanel:d,reloadInstance:p,instance:u,model:o,id:v,collapsible:j=!0}){const M=G(),i=de(),x=ue(),{panel:m}=he(),[g,z]=c.useState(!0),L=Se({id:v,model:o,instance:u,reloadFunc:p}),[_,D]=c.useMemo(()=>{const a=[],n=[...r],b=[...r];t?.forEach(h=>{const f={...h,panels:[]};h.panelIDs?.forEach(I=>{const y=n.findIndex(Q=>Q.name===I);y!==-1&&(f.panels.push(n[y]),n.splice(y,1))}),a.push(f)}),n.length>0&&a.push({id:"ungrouped",label:"",panels:n});const E=[];return L.panels?.forEach(h=>{let f=h.name;r.find(y=>y.name===f)&&(f=N(`${h.pluginName}-${h.name}`)),E.push({...h,name:f}),b.push({...h,name:f})}),E.length>0&&a.push({id:"plugins",label:w._({id:"GdSEwD"}),panels:E}),[b,a]},[t,r,L]),P=c.useMemo(()=>_.filter(a=>!a.hidden&&!a.disabled),[_]),k=c.useCallback((a,n)=>{if(W(n),n&&Y(n)){const b=`${i.pathname}/../${a}`;Z(b,x,n)}else x(`../${a}`);M.setLastUsedPanel(s)(a),a&&l&&l(a)},[P,x,i,l]);c.useEffect(()=>{d&&d!==m&&k(d)},[d,m]);const q=c.useMemo(()=>P.findIndex(a=>a.name===m)===-1?P[0]?.name??"":m??"",[P,m]);return e.jsx(U,{label:`PanelGroup-${s}`,children:e.jsx(K,{p:"sm",radius:"xs",shadow:"xs","aria-label":`${s}`,children:e.jsxs(S,{value:q,orientation:"vertical",keepMounted:!1,"aria-label":`panel-group-${s}`,classNames:{tab:$e},children:[e.jsxs(S.List,{justify:"left","aria-label":`panel-tabs-${s}`,children:[D.map(a=>e.jsxs(ee,{w:"100%",children:[e.jsx(ae,{hidden:!a.label||!g,c:R.colors.primaryColors[7],style:{paddingLeft:"10px"},children:a.label},`group-label-${a.id}`),a.label&&e.jsx(C,{c:R.colors.primaryColors[7]}),a.panels?.map(n=>!n.hidden&&e.jsx(T,{label:n.label??n.name,disabled:g,position:"right",children:e.jsx(S.Tab,{p:"xs",w:"100%",value:n.name,leftSection:n.icon,hidden:n.hidden,disabled:n.disabled,style:{cursor:n.disabled?"unset":"pointer"},onClick:b=>k(n.name,b),children:e.jsx($,{justify:"left",gap:"xs",wrap:"nowrap",children:e.jsx(ne,{component:"a",style:{textAlign:"left"},href:se(`/${te()}${i.pathname}/${n.name}`),children:g&&n.label})})},`panel-label-${n.name}`)},n.name))]},`group-${a.id}`)),j&&e.jsx(C,{}),j&&e.jsxs($,{wrap:"nowrap",gap:"xs",children:[e.jsx(T,{position:"right",label:g?w._({id:"vpmaDJ"}):w._({id:"L6p1/r"}),children:e.jsx(ie,{style:{paddingLeft:"10px"},onClick:()=>z(!g),variant:"transparent",size:"lg",children:g?e.jsx(je,{opacity:.75}):e.jsx(ve,{opacity:.75})})}),L.isLoading&&e.jsx(le,{size:"xs"})]})]}),_.map(a=>!a.hidden&&e.jsx(S.Panel,{value:a.name,"aria-label":`nav-panel-${N(`${s}-${a.name}`)}`,p:"sm",style:{overflowX:"scroll",width:"100%"},children:e.jsxs(B,{gap:"md",children:[a.showHeadline!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs($,{justify:"space-between",children:[e.jsx(pe,{size:"xl",children:a.label}),a.controls&&e.jsx($,{justify:"right",wrap:"nowrap",children:a.controls})]}),e.jsx(C,{})]}),e.jsx(U,{label:`PanelContent-${a.name}`,children:a.content})]})},`panel-${a.name}`))]})})})}function _e({pageKey:s,selectedPanel:r,panels:t}){const l=G(X(d=>{const p=r||d.lastUsedPanels[s]||t[0]?.name;return t.findIndex(o=>o.name===p&&!o.disabled&&!o.hidden)===-1?t.find(o=>!o.disabled&&!o.hidden)?.name||"":p}));return e.jsx(ce,{to:l,replace:!0})}function Ie(s){return e.jsxs(re,{children:[e.jsx(F,{index:!0,element:e.jsx(_e,{...s})}),e.jsx(F,{path:"/:panel/*",element:e.jsx(Le,{...s})})]})}export{Ie as P};
//# sourceMappingURL=PanelGroup-Bif3iIGQ.js.map
