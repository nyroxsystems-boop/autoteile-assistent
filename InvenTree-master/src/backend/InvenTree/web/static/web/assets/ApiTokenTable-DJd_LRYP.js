import{r as a,bi as U,ab as s,ao as n,j as e,am as f,c as d,an as u,e as A,bz as P,U as z,d as B,$ as M,bc as v,cU as S}from"./index-Db7AGPIq.js";import{a as E,d as I,U as w}from"./Filter-BgnAqEQC.js";import{ac as L,ap as W,S as G}from"./ThemeContext-CxdCkKtz.js";import{u as O,I as q}from"./InvenTreeTable-DmN557zY.js";import{B as p,U as J}from"./ColumnRenderers-BUH0stTX.js";function Z({only_myself:r=!0}){const[l,x]=a.useState(""),[m,{open:b,close:j}]=U(!1),c=E({url:n.user_tokens,title:s._({id:"PxJ9W6"}),fields:{name:{}},successMessage:s._({id:"jUAqIc"}),onFormSuccess:t=>{x(t.token),b(),o.refreshTable()}}),h=a.useMemo(()=>r?[e.jsx(I,{tooltip:s._({id:"PxJ9W6"}),onClick:()=>c.open()},"generate")]:[],[r]),o=O("api-tokens","id"),k=a.useMemo(()=>{const t=[{accessor:"name",title:s._({id:"6YtxFj"}),sortable:!0},p({accessor:"active",title:s._({id:"F6pfE9"}),sortable:!1}),p({accessor:"revoked",title:s._({id:"xGiT1z"})}),{accessor:"token",title:s._({id:"TP9/K5"}),render:i=>e.jsxs(e.Fragment,{children:[i.token," ",i.in_use?e.jsx(f,{color:"green",children:e.jsx(d,{id:"OxPEUg"})}):null]})},{accessor:"last_seen",title:s._({id:"bLZksC"}),sortable:!0},{accessor:"expiry",title:s._({id:"agO/T/"}),sortable:!0},{accessor:"created",title:s._({id:"d+F6q9"}),sortable:!0}];return r||t.push(J({accessor:"user_detail",ordering:"user",title:s._({id:"7PzzBU"})})),t},[r]),T=a.useMemo(()=>{const t=[{name:"revoked",label:s._({id:"xGiT1z"}),description:s._({id:"iFQOwR"})}];return r||t.push(w({name:"user",label:s._({id:"7PzzBU"}),description:s._({id:"FVjW63"})})),t},[r]),_=a.useCallback(t=>[{title:s._({id:"GXsAby"}),color:"red",hidden:!t.active||t.in_use,icon:e.jsx(L,{}),onClick:()=>{g(t.id)}}],[]),g=async t=>{let i=u(n.user_tokens,t);r||(i+="?all_users=true"),A.delete(i).then(()=>{o.refreshTable()}).catch(F=>{P({error:F,title:s._({id:"LQLPLZ"})})})},C=a.useMemo(()=>r?{}:{all_users:!0},[r]);return e.jsxs(e.Fragment,{children:[r&&e.jsxs(e.Fragment,{children:[c.modal,e.jsxs(z,{opened:m,onClose:j,title:e.jsx(G,{size:"xl",children:s._({id:"TP9/K5"})}),centered:!0,children:[e.jsx(B,{c:"dimmed",children:e.jsx(d,{id:"VWjAuB"})}),e.jsx(M,{p:"sm",children:e.jsxs(v,{children:[e.jsx(S,{children:l}),e.jsx(W,{value:l})]})})]})]}),e.jsx(q,{tableState:o,url:u(n.user_tokens),columns:k,props:{params:C,rowActions:_,enableSearch:!1,enableColumnSwitching:!1,tableActions:h,tableFilters:T}})]})}export{Z as A};
//# sourceMappingURL=ApiTokenTable-DJd_LRYP.js.map
