{"version":3,"mappings":"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","names":["__iconNode","IconDeviceDesktop","createReactComponent","IconRestore","getReauthFlow","err","flows","response","data","find","flow","id","FlowEnum","MfaReauthenticate","Reauthenticate","extractErrorMessage","defaultMsg","backupMsg","status","errors","length","message","ReauthenticateModalComponent","inputProps","setOpen","setAuthContext","useServerApiState","getState","value","setValue","useState","error","setError","onSubmit","useCallback","api","post","url","name","then","showNotification","title","_i18n","_","color","icon","IconCircleCheck","catch","IconExclamationCircle","Stack","jsx","Divider","Alert","PasswordInput","label","description","event","target","jsxs","Group","Button","_Trans","ReauthenticateModal","opened","Modal","StylishText","ReauthenticatePasswordModal","apiUrl","ApiEndpoints","auth_reauthenticate","ReauthenticateTOTPModal","auth_mfa_reauthenticate","RemoveWebauthnModal","tokenId","onReauthFlow","onSuccess","processing","setProcessing","useEffect","removeCredential","authApi","auth_webauthn","timeout","authenticators","finally","IconAlertCircle","RemoveTOTPModal","deleteToken","delete","auth_totp","RegisterTOTPModal","setUrl","secret","setSecret","totpQuery","useQuery","enabled","queryKey","queryFn","get","_response","meta","totp_url","refetch","submitCode","code","QrRegistrationForm","RecoveryCodesModal","recoveryCodesQuery","auth_recovery","undefined","queryClient","cancelQueries","unusedCodes","useMemo","unused_codes","isFetching","isLoading","Loader","IconInfoCircle","Paper","map","Text","CopyButton","join","MFASettings","auth_config","useShallow","state","auth_authenticators","res","usedFactors","token","type","webauthnToken","setWebauthnToken","recoveryCodesOpen","setRecoveryCodesOpen","reauthPassOpen","setReauthPassModalOpen","reauthTOTPOpen","setReauthTOTPModalOpen","registerTOTPModalOpen","setRegisterTOTPModalOpen","removeTOTPModalOpen","setRemoveTOTPModalOpen","removeWebauthnModalOpen","setRemoveWebauthnModalOpen","reauthenticate","registerRecoveryCodes","registerWebauthn","key","create","publicKey","PublicKeyCredential","parseCreationOptionsFromJSON","credential","credentialString","JSON","stringify","errorMsg","requestWebauthn","options","creation_options","removeTOTP","viewRecoveryCodes","removeWebauthn","possibleFactors","function","used","includes","filter","factor","mfa","supported_types","mfaRows","Table","parseDate","last_used_at","created_at","Fragment","SimpleGrid","xs","md","Tooltip","SecurityContent","sso_enabled","user","useUserState","Accordion","EmailSection","ProviderSection","ApiTokenTable","isSuperuser","AuthContextSection","auth_context","fetchAuthContext","auth_session","resp","ActionIcon","IconRefresh","methods","method","index","at","selectedEmail","setSelectedEmail","newEmailValue","setNewEmailValue","auth_email","emailAvailable","runServerAction","action","vals","email","hideNotification","Radio","String","primary","Badge","verified","TextInput","IconAt","currentTarget","IconX","ProviderButton","provider","ProviderLogin","auth_providers","availableProviders","configuredProviders","item","socialaccount","providers","removeProvider","uid","split","account","console","log","Grid","link","display","date","Date","toLocaleString","AccountDetailPanel","navigate","useNavigate","fetchUserState","userFields","first_name","last_name","editAccount","useEditApiFormModal","user_me","onFormSuccess","fields","successMessage","profileFields","displayname","position","location","active","contact","organisation","primary_group","editProfile","user_profile","accountDetailFields","username","YesNoUndefinedButton","profile","is_staff","is_superuser","profileDetailFields","modal","ActionDropdown","IconUser","IconEdit","tooltip","onClick","open","IconKey","renderDetailTable","ActionButton","values","0","getLkp","DEFAULT_THEME","colors","LOOKUP","Object","assign","keys","clr","UserTheme","height","theme","useMantineTheme","userTheme","setTheme","setLanguage","useLocalState","getRadiusFromValue","obj","SizeMarks","mark","radius","setRadius","changeRadius","r","toString","Container","LanguageSelect","IS_DEV","ColorToggle","ColorPicker","v","primaryColor","ColorInput","whiteColor","blackColor","Slider","val","Select","loader","AccountContent","base","SECONDARY_COL_HEIGHT","PluginSettingsGroup","Loadable","lazy","UserSettings","isLoggedIn","userSettingsPanels","IconUserCircle","content","IconLock","UserSettingList","IconSearch","IconBellCog","IconFileAnalytics","IconPlugConnected","PageTitle","SettingsHeader","PanelGroup","Skeleton"],"ignoreList":[0,1],"sources":["../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconDeviceDesktop.mjs","../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconRestore.mjs","../../../../../../frontend/src/pages/Index/Settings/AccountSettings/MFASettings.tsx","../../../../../../frontend/src/pages/Index/Settings/AccountSettings/SecurityContent.tsx","../../../../../../frontend/src/pages/Index/Settings/AccountSettings/AccountDetailPanel.tsx","../../../../../../frontend/src/pages/Index/Settings/AccountSettings/UserThemePanel.tsx","../../../../../../frontend/src/pages/Index/Settings/AccountSettings/UserPanel.tsx","../../../../../../frontend/src/pages/Index/Settings/UserSettings.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M7 20h10\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M9 16v4\", \"key\": \"svg-2\" }], [\"path\", { \"d\": \"M15 16v4\", \"key\": \"svg-3\" }]];\nconst IconDeviceDesktop = createReactComponent(\"outline\", \"device-desktop\", \"DeviceDesktop\", __iconNode);\n\nexport { __iconNode, IconDeviceDesktop as default };\n//# sourceMappingURL=IconDeviceDesktop.mjs.map\n","/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3.06 13a9 9 0 1 0 .49 -4.087\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M3 4.001v5h5\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0\", \"key\": \"svg-2\" }]];\nconst IconRestore = createReactComponent(\"outline\", \"restore\", \"Restore\", __iconNode);\n\nexport { __iconNode, IconRestore as default };\n//# sourceMappingURL=IconRestore.mjs.map\n","import { create } from '@github/webauthn-json/browser-ponyfill';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { apiUrl } from '@lib/functions/Api';\nimport { FlowEnum } from '@lib/types/Auth';\nimport { t } from '@lingui/core/macro';\nimport { Trans } from '@lingui/react/macro';\nimport {\n  Alert,\n  Button,\n  Divider,\n  Group,\n  Loader,\n  Modal,\n  Paper,\n  PasswordInput,\n  SimpleGrid,\n  Stack,\n  Table,\n  Text,\n  Tooltip\n} from '@mantine/core';\nimport { showNotification } from '@mantine/notifications';\nimport {\n  IconAlertCircle,\n  IconCircleCheck,\n  IconExclamationCircle,\n  IconInfoCircle\n} from '@tabler/icons-react';\nimport { useQuery } from '@tanstack/react-query';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useShallow } from 'zustand/react/shallow';\nimport { api, queryClient } from '../../../../App';\nimport { CopyButton } from '../../../../components/buttons/CopyButton';\nimport { StylishText } from '../../../../components/items/StylishText';\nimport { authApi } from '../../../../functions/auth';\nimport { useServerApiState } from '../../../../states/ServerApiState';\nimport { QrRegistrationForm } from './QrRegistrationForm';\nimport { parseDate } from './SecurityContent';\n\n/**\n * Extract the required re-authentication flow from an error response\n */\nfunction getReauthFlow(err: any): FlowEnum | null {\n  const flows: any = err.response?.data?.data?.flows ?? [];\n\n  if (flows.find((flow: any) => flow.id == FlowEnum.MfaReauthenticate)) {\n    return FlowEnum.MfaReauthenticate;\n  } else if (flows.find((flow: any) => flow.id == FlowEnum.Reauthenticate)) {\n    return FlowEnum.Reauthenticate;\n  } else {\n    // No match found\n    return null;\n  }\n}\n\n/**\n * Extract an error message from an allauth error response.\n *\n * The allauth flows have a particular response structure,\n * which this function handles.\n */\nfunction extractErrorMessage(err: any, defaultMsg: string): string {\n  const backupMsg = `${defaultMsg}: ${err.status}`;\n\n  if (err.response?.data?.errors && err.response?.data?.errors.length > 0) {\n    return err.response?.data?.errors[0]?.message ?? backupMsg;\n  }\n\n  return backupMsg;\n}\n\ntype ReauthInputProps = {\n  label: string;\n  name: string;\n  description: string;\n  url: string;\n};\n\n/**\n * Internal modal component for re-authentication\n */\nfunction ReauthenticateModalComponent({\n  inputProps,\n  setOpen\n}: {\n  inputProps: ReauthInputProps;\n  setOpen: (open: boolean) => void;\n}) {\n  const { setAuthContext } = useServerApiState.getState();\n\n  const [value, setValue] = useState<string>('');\n  const [error, setError] = useState<string>('');\n\n  const onSubmit = useCallback(\n    (value: string) => {\n      api\n        .post(inputProps.url, {\n          [inputProps.name]: value\n        })\n        .then((response) => {\n          setAuthContext(response.data?.data);\n          showNotification({\n            title: t`Reauthentication Succeeded`,\n            message: t`You have been reauthenticated successfully.`,\n            color: 'green',\n            icon: <IconCircleCheck />\n          });\n          setOpen(false);\n        })\n        .catch((error) => {\n          setError(\n            extractErrorMessage(error, t`Error during reauthentication`)\n          );\n          showNotification({\n            title: t`Reauthentication Failed`,\n            message: `${t`Failed to reauthenticate`}: ${error.status}`,\n            color: 'red',\n            icon: <IconExclamationCircle />\n          });\n        });\n    },\n    [inputProps]\n  );\n\n  return (\n    <Stack>\n      <Divider />\n      <Alert\n        color='yellow'\n        icon={<IconExclamationCircle />}\n        title={t`Reauthenticate`}\n      >\n        {t`Reauthentiction is required to continue.`}\n      </Alert>\n      <PasswordInput\n        required\n        label={inputProps.label}\n        name={inputProps.name}\n        description={inputProps.description}\n        value={value}\n        error={error}\n        onChange={(event) => setValue(event.target.value)}\n      />\n      <Group justify='right'>\n        <Button onClick={() => setOpen(false)} color='red'>\n          <Trans>Cancel</Trans>\n        </Button>\n        <Button onClick={() => onSubmit(value)} color='green'>\n          <Trans>Submit</Trans>\n        </Button>\n      </Group>\n    </Stack>\n  );\n}\n\nfunction ReauthenticateModal({\n  inputProps,\n  opened,\n  setOpen\n}: {\n  inputProps: ReauthInputProps;\n  opened: boolean;\n  setOpen: (open: boolean) => void;\n}) {\n  return (\n    <Modal\n      opened={opened}\n      zIndex={9999}\n      size='lg'\n      onClose={() => setOpen(false)}\n      title={<StylishText size='lg'>{t`Reauthenticate`}</StylishText>}\n    >\n      <ReauthenticateModalComponent inputProps={inputProps} setOpen={setOpen} />\n    </Modal>\n  );\n}\n\n/**\n * Modal for re-authenticating with password\n */\nfunction ReauthenticatePasswordModal({\n  opened,\n  setOpen\n}: {\n  opened: boolean;\n  setOpen: (open: boolean) => void;\n}) {\n  return (\n    <ReauthenticateModal\n      opened={opened}\n      setOpen={setOpen}\n      inputProps={{\n        label: t`Password`,\n        name: 'password',\n        description: t`Enter your password`,\n        url: apiUrl(ApiEndpoints.auth_reauthenticate)\n      }}\n    />\n  );\n}\n\n/**\n * Modal for re-authenticating with TOTP code\n */\nfunction ReauthenticateTOTPModal({\n  opened,\n  setOpen\n}: {\n  opened: boolean;\n  setOpen: (open: boolean) => void;\n}) {\n  return (\n    <ReauthenticateModal\n      opened={opened}\n      setOpen={setOpen}\n      inputProps={{\n        label: t`TOTP Code`,\n        name: 'code',\n        description: t`Enter one of your TOTP codes`,\n        url: apiUrl(ApiEndpoints.auth_mfa_reauthenticate)\n      }}\n    />\n  );\n}\n\n/**\n * Modal for removing a registered WebAuthn credential:\n * - Deletes the WebAuthn credential from the server\n * - Handles errors and re-authentication flows as needed\n */\nfunction RemoveWebauthnModal({\n  tokenId,\n  opened,\n  setOpen,\n  onReauthFlow,\n  onSuccess\n}: {\n  opened: boolean;\n  tokenId: number | null;\n  setOpen: (open: boolean) => void;\n  onReauthFlow: (flow: FlowEnum) => void;\n  onSuccess: () => void;\n}) {\n  const [processing, setProcessing] = useState<boolean>(false);\n  const [error, setError] = useState<string>('');\n\n  useEffect(() => {\n    setProcessing(false);\n    setError('');\n  }, [opened]);\n\n  const removeCredential = useCallback(() => {\n    setProcessing(true);\n\n    if (!tokenId) {\n      return;\n    }\n\n    authApi(\n      apiUrl(ApiEndpoints.auth_webauthn),\n      {\n        timeout: 30 * 1000\n      },\n      'delete',\n      {\n        authenticators: [tokenId]\n      }\n    )\n      .then((response) => {\n        showNotification({\n          title: t`WebAuthn Credential Removed`,\n          message: t`WebAuthn credential removed successfully.`,\n          color: 'green',\n          icon: <IconCircleCheck />\n        });\n        setOpen(false);\n        onSuccess();\n      })\n      .catch((error) => {\n        setError(\n          extractErrorMessage(error, t`Error removing WebAuthn credential`)\n        );\n\n        // A 401 error indicates that re-authentication is required\n        if (error.status === 401) {\n          const flow = getReauthFlow(error);\n          if (flow !== null) {\n            onReauthFlow(flow);\n          }\n        }\n      })\n      .finally(() => {\n        setProcessing(false);\n      });\n  }, [tokenId]);\n\n  return (\n    <Modal\n      opened={opened}\n      onClose={() => setOpen(false)}\n      title={\n        <StylishText size='lg'>{t`Remove WebAuthn Credential`}</StylishText>\n      }\n    >\n      <Stack>\n        <Divider />\n        <Alert\n          color='red'\n          icon={<IconAlertCircle />}\n          title={t`Confirm Removal`}\n        >\n          <Trans>Confirm removal of webauth credential</Trans>\n        </Alert>\n        {error && (\n          <Alert color='red' icon={<IconExclamationCircle />} title={t`Error`}>\n            {error}\n          </Alert>\n        )}\n        <Group justify='right'>\n          <Button onClick={() => setOpen(false)}>\n            <Trans>Cancel</Trans>\n          </Button>\n          <Button onClick={removeCredential} color='red' disabled={processing}>\n            <Trans>Remove</Trans>\n          </Button>\n        </Group>\n      </Stack>\n    </Modal>\n  );\n}\n\n/**\n * Modal for removing a registered TOTP token:\n * - Deletes the TOTP token from the server\n * - Handles errors and re-authentication flows as needed\n */\nfunction RemoveTOTPModal({\n  opened,\n  setOpen,\n  onReauthFlow,\n  onSuccess\n}: {\n  opened: boolean;\n  setOpen: (open: boolean) => void;\n  onReauthFlow: (flow: FlowEnum) => void;\n  onSuccess: () => void;\n}) {\n  const [processing, setProcessing] = useState<boolean>(false);\n  const [error, setError] = useState<string>('');\n\n  useEffect(() => {\n    setProcessing(false);\n    setError('');\n  }, [opened]);\n\n  const deleteToken = useCallback(() => {\n    setProcessing(true);\n    api\n      .delete(apiUrl(ApiEndpoints.auth_totp), {\n        timeout: 30 * 1000\n      })\n      .then((response) => {\n        showNotification({\n          title: t`TOTP Removed`,\n          message: t`TOTP token removed successfully.`,\n          color: 'green',\n          icon: <IconCircleCheck />\n        });\n        setOpen(false);\n        onSuccess();\n\n        return response.data;\n      })\n      .catch((error) => {\n        setError(extractErrorMessage(error, t`Error removing TOTP token`));\n\n        // A 401 error indicates that re-authentication is required\n        if (error.status === 401) {\n          const flow = getReauthFlow(error);\n          if (flow !== null) {\n            onReauthFlow(flow);\n          }\n        }\n      })\n      .finally(() => {\n        setProcessing(false);\n      });\n  }, []);\n\n  return (\n    <Modal\n      opened={opened}\n      onClose={() => setOpen(false)}\n      title={<StylishText size='lg'>{t`Remove TOTP Token`}</StylishText>}\n    >\n      <Stack>\n        <Divider />\n        <Alert\n          color='red'\n          icon={<IconAlertCircle />}\n          title={t`Confirm Removal`}\n        >\n          <Trans>Confirm removal of TOTP code</Trans>\n        </Alert>\n        {error && (\n          <Alert color='red' icon={<IconExclamationCircle />} title={t`Error`}>\n            {error}\n          </Alert>\n        )}\n        <Group justify='right'>\n          <Button onClick={() => setOpen(false)}>\n            <Trans>Cancel</Trans>\n          </Button>\n          <Button onClick={deleteToken} color='red' disabled={processing}>\n            <Trans>Remove</Trans>\n          </Button>\n        </Group>\n      </Stack>\n    </Modal>\n  );\n}\n\n/**\n * Modal for registering a new TOTP token\n * - Fetches TOTP registration details from the server\n * - Displays QR code and secret to the user\n * - Accepts TOTP code input from the user\n * - Submits TOTP code to the server for registration\n * - Handles errors and re-authentication flows as needed\n */\nfunction RegisterTOTPModal({\n  opened,\n  setOpen,\n  onReauthFlow,\n  onSuccess\n}: {\n  opened: boolean;\n  setOpen: (open: boolean) => void;\n  onReauthFlow: (flow: FlowEnum) => void;\n  onSuccess: () => void;\n}) {\n  const [url, setUrl] = useState<string>('');\n  const [secret, setSecret] = useState<string>('');\n  const [value, setValue] = useState<string>('');\n  const [error, setError] = useState<string>('');\n  const [processing, setProcessing] = useState<boolean>(false);\n\n  // Query to fetch TOTP registration details\n  const totpQuery = useQuery({\n    enabled: false,\n    queryKey: ['mfa-totp-registration'],\n    queryFn: async () => {\n      setUrl('');\n      setSecret('');\n\n      return api\n        .get(apiUrl(ApiEndpoints.auth_totp))\n        .then((_response) => {\n          // A successful response indicates that TOTP is already registered\n          // Close the modal and show an error\n          setOpen(false);\n          showNotification({\n            title: t`TOTP Already Registered`,\n            message: t`A TOTP token is already registered for this account.`,\n            color: 'green'\n          });\n          return {};\n        })\n        .catch((error) => {\n          switch (error.status) {\n            case 404:\n              // A 404 indicates that a new TOTP registration can be started\n              setUrl(error.response?.data?.meta?.totp_url ?? '');\n              setSecret(error.response?.data?.meta?.secret ?? '');\n              break;\n            default:\n              // Any other error is unexpected\n              showNotification({\n                title: t`Error Fetching TOTP Registration`,\n                message: t`An unexpected error occurred while fetching TOTP registration data.`,\n                color: 'red'\n              });\n              throw error;\n          }\n\n          return null;\n        });\n    }\n  });\n\n  // Retrieve TOTP QR code and secret from server, when modal is opened\n  useEffect(() => {\n    // Reset state\n    setUrl('');\n    setSecret('');\n    setValue('');\n    setError('');\n    setProcessing(false);\n\n    if (opened) {\n      totpQuery.refetch();\n    }\n  }, [opened]);\n\n  // Function to submit TOTP code for registration\n  const submitCode = useCallback((code: string) => {\n    setProcessing(true);\n    setError('');\n\n    api\n      .post(\n        apiUrl(ApiEndpoints.auth_totp),\n        {\n          code: code\n        },\n        {\n          timeout: 30 * 1000\n        }\n      )\n      .then((response) => {\n        showNotification({\n          title: t`TOTP Registered`,\n          message: t`TOTP token registered successfully.`,\n          color: 'green',\n          icon: <IconCircleCheck />\n        });\n        setOpen(false);\n        onSuccess();\n      })\n      .catch((error) => {\n        // Set error message\n        setError(extractErrorMessage(error, t`Error registering TOTP token`));\n\n        // A 401 error indicates that re-authentication is required\n        if (error.status === 401) {\n          const flow = getReauthFlow(error);\n          if (flow !== null) {\n            onReauthFlow(flow);\n          }\n        }\n      })\n      .finally(() => {\n        setProcessing(false);\n      });\n  }, []);\n\n  return (\n    <Modal\n      opened={opened}\n      onClose={() => setOpen(false)}\n      title={<StylishText size='lg'>{t`Register TOTP Token`}</StylishText>}\n    >\n      <Stack>\n        <QrRegistrationForm\n          url={url}\n          secret={secret}\n          value={value}\n          error={error}\n          setValue={setValue}\n        />\n        <Button\n          fullWidth\n          onClick={() => {\n            submitCode(value);\n          }}\n          disabled={processing}\n        >\n          <Trans>Submit</Trans>\n        </Button>\n      </Stack>\n    </Modal>\n  );\n}\n\nfunction RecoveryCodesModal({\n  opened,\n  setOpen,\n  onReauthFlow\n}: {\n  opened: boolean;\n  setOpen: (open: boolean) => void;\n  onReauthFlow: (flow: FlowEnum) => void;\n}) {\n  const [error, setError] = useState<string>('');\n\n  const recoveryCodesQuery = useQuery({\n    enabled: false,\n    queryKey: ['mfa-recovery-codes'],\n    queryFn: async () => {\n      return api\n        .post(apiUrl(ApiEndpoints.auth_recovery), undefined, {\n          timeout: 30 * 1000\n        })\n        .catch((error) => {\n          setError(\n            extractErrorMessage(error, t`Error fetching recovery codes`)\n          );\n\n          // A 401 error indicates that re-authentication is required\n          if (error.status === 401) {\n            const flow = getReauthFlow(error);\n            if (flow !== null) {\n              setOpen(false);\n              onReauthFlow(flow);\n            }\n          } else {\n            queryClient.cancelQueries({ queryKey: ['mfa-recovery-codes'] });\n          }\n\n          throw error;\n        });\n    }\n  });\n\n  const unusedCodes = useMemo(() => {\n    return recoveryCodesQuery.data?.data?.data?.unused_codes ?? [];\n  }, [recoveryCodesQuery.data]);\n\n  useEffect(() => {\n    setError('');\n\n    // Re-fetch codes on opened\n    if (opened) {\n      recoveryCodesQuery.refetch();\n    }\n  }, [opened]);\n\n  return (\n    <Modal\n      opened={opened}\n      onClose={() => setOpen(false)}\n      title={<StylishText size='lg'>{t`Recovery Codes`}</StylishText>}\n    >\n      <Stack>\n        <Divider />\n        {error && (\n          <Alert color='red' icon={<IconExclamationCircle />} title={t`Error`}>\n            {error}\n          </Alert>\n        )}\n        {recoveryCodesQuery.isFetching || recoveryCodesQuery.isLoading ? (\n          <Loader />\n        ) : unusedCodes.length > 0 ? (\n          <Stack gap='xs'>\n            <Alert\n              color='blue'\n              icon={<IconInfoCircle />}\n              title={t`Recovery Codes`}\n            >\n              <Trans>\n                The following one time recovery codes are available for use\n              </Trans>\n            </Alert>\n            <Paper p='sm' withBorder>\n              <Stack gap='xs'>\n                {unusedCodes.map((code: string) => (\n                  <Group\n                    p={3}\n                    justify='space-between'\n                    key={`mfa-recovery-code-${code}`}\n                  >\n                    <Text>{code}</Text>\n                  </Group>\n                ))}\n                <Divider />\n                <Group justify='space-between'>\n                  <Trans>Copy recovery codes to clipboard</Trans>\n                  <CopyButton value={unusedCodes.join('\\n')} />\n                </Group>\n              </Stack>\n            </Paper>\n          </Stack>\n        ) : (\n          <Alert\n            color='yellow'\n            icon={<IconAlertCircle />}\n            title={t`No Unused Codes`}\n          >\n            <Trans>There are no available recovery codes</Trans>\n          </Alert>\n        )}\n        <Divider />\n        <Group justify='right'>\n          <Button onClick={() => setOpen(false)}>\n            <Trans>Close</Trans>\n          </Button>\n        </Group>\n      </Stack>\n    </Modal>\n  );\n}\n\n/**\n * Section for adding new MFA methods for the user\n */\nexport default function MFASettings() {\n  const [auth_config] = useServerApiState(\n    useShallow((state) => [state.auth_config])\n  );\n\n  // Fetch list of MFA methods currently configured for the user\n  const { isLoading, data, refetch } = useQuery({\n    queryKey: ['mfa-list'],\n    queryFn: () =>\n      api\n        .get(apiUrl(ApiEndpoints.auth_authenticators))\n        .then((res) => res?.data?.data ?? [])\n        .catch(() => [])\n  });\n\n  // Memoize the list of currently used MFA factors\n  const usedFactors: string[] = useMemo(() => {\n    if (isLoading || !data) return [];\n    return data.map((token: any) => token.type);\n  }, [isLoading, data]);\n\n  const [webauthnToken, setWebauthnToken] = useState<number | null>(null);\n\n  const [recoveryCodesOpen, setRecoveryCodesOpen] = useState<boolean>(false);\n  const [reauthPassOpen, setReauthPassModalOpen] = useState<boolean>(false);\n  const [reauthTOTPOpen, setReauthTOTPModalOpen] = useState<boolean>(false);\n  const [registerTOTPModalOpen, setRegisterTOTPModalOpen] =\n    useState<boolean>(false);\n  const [removeTOTPModalOpen, setRemoveTOTPModalOpen] =\n    useState<boolean>(false);\n  const [removeWebauthnModalOpen, setRemoveWebauthnModalOpen] =\n    useState<boolean>(false);\n\n  // Callback function used to re-authenticate the user\n  const reauthenticate = useCallback((flow: FlowEnum) => {\n    switch (flow) {\n      case FlowEnum.Reauthenticate:\n        setReauthPassModalOpen(true);\n        break;\n      case FlowEnum.MfaReauthenticate:\n        setReauthTOTPModalOpen(true);\n        break;\n      default:\n        // Un-handled reauthentication flow\n        break;\n    }\n  }, []);\n\n  const registerRecoveryCodes = useCallback(() => {\n    setRecoveryCodesOpen(true);\n  }, []);\n\n  // Register a WebAuthn credential with the provided key\n  const registerWebauthn = useCallback((key: any) => {\n    create({\n      publicKey: PublicKeyCredential.parseCreationOptionsFromJSON(key)\n    }).then((credential) => {\n      const credentialString: string = JSON.stringify(credential);\n\n      api\n        .post(\n          apiUrl(ApiEndpoints.auth_webauthn),\n          {\n            name: 'Master Key',\n            credential: credentialString\n          },\n          {\n            timeout: 30 * 1000\n          }\n        )\n        .then((response) => {\n          showNotification({\n            title: t`WebAuthn Registered`,\n            message: t`WebAuthn credential registered successfully`,\n            color: 'green',\n            icon: <IconCircleCheck />\n          });\n          refetch();\n        })\n        .catch((error) => {\n          const errorMsg = extractErrorMessage(\n            error,\n            t`Error registering WebAuthn credential`\n          );\n          showNotification({\n            title: t`WebAuthn Registration Failed`,\n            message: `${t`Failed to register WebAuthn credential`}: ${errorMsg}`,\n            color: 'red',\n            icon: <IconExclamationCircle />\n          });\n        });\n    });\n  }, []);\n\n  // Request a WebAuthn registration challenge from the server\n  const requestWebauthn = useCallback(() => {\n    api\n      .get(apiUrl(ApiEndpoints.auth_webauthn))\n      .then((response) => {\n        // Extract credential creation options from the response\n        const options = response.data?.data?.creation_options;\n        if (options) {\n          registerWebauthn(options.publicKey);\n        }\n        return response.data;\n      })\n      .catch((error) => {\n        const errorMsg: string = extractErrorMessage(\n          error,\n          t`Error fetching WebAuthn registration`\n        );\n\n        // A 401 error indicates that re-authentication is required\n        if (error.status === 401) {\n          const flow = getReauthFlow(error);\n          if (flow !== null) {\n            reauthenticate(flow);\n          }\n        } else {\n          showNotification({\n            title: t`Error`,\n            message: errorMsg,\n            color: 'red',\n            icon: <IconExclamationCircle />\n          });\n        }\n\n        throw error;\n      });\n  }, []);\n\n  const removeTOTP = useCallback(() => {\n    setRemoveTOTPModalOpen(true);\n  }, []);\n\n  const viewRecoveryCodes = useCallback(() => {\n    setRecoveryCodesOpen(true);\n  }, []);\n\n  const removeWebauthn = useCallback((id: number) => {\n    setWebauthnToken(id);\n    setRemoveWebauthnModalOpen(true);\n  }, []);\n\n  // Memoize the list of possible MFA factors that can be registered\n  const possibleFactors = useMemo(() => {\n    return [\n      {\n        type: 'totp',\n        name: t`TOTP`,\n        description: t`Time-based One-Time Password`,\n        function: () => setRegisterTOTPModalOpen(true),\n        used: usedFactors?.includes('totp')\n      },\n      {\n        type: 'recovery_codes',\n        name: t`Recovery Codes`,\n        description: t`One-Time pre-generated recovery codes`,\n        function: registerRecoveryCodes,\n        used: usedFactors?.includes('recovery_codes')\n      },\n      {\n        type: 'webauthn',\n        name: t`WebAuthn`,\n        description: t`Web Authentication (WebAuthn) is a web standard for secure authentication`,\n        function: requestWebauthn,\n        used: usedFactors?.includes('webauthn')\n      }\n    ].filter((factor) => {\n      return auth_config?.mfa?.supported_types.includes(factor.type);\n    });\n  }, [usedFactors, auth_config]);\n\n  const mfaRows = useMemo(() => {\n    return (\n      data?.map((token: any) => (\n        <Table.Tr key={`${token.created_at}-${token.type}`}>\n          <Table.Td>{token.type}</Table.Td>\n          <Table.Td>{parseDate(token.last_used_at)}</Table.Td>\n          <Table.Td>{parseDate(token.created_at)}</Table.Td>\n          <Table.Td>\n            <Group grow>\n              {token.type == 'totp' && (\n                <Button\n                  aria-label={'remove-totp'}\n                  color='red'\n                  onClick={removeTOTP}\n                >\n                  <Trans>Remove</Trans>\n                </Button>\n              )}\n              {token.type == 'recovery_codes' && (\n                <Button\n                  aria-label={'view-recovery-codes'}\n                  onClick={viewRecoveryCodes}\n                >\n                  <Trans>View</Trans>\n                </Button>\n              )}\n              {token.type == 'webauthn' && (\n                <Button\n                  aria-label={'remove-webauthn'}\n                  color='red'\n                  onClick={() => {\n                    removeWebauthn(token.id);\n                  }}\n                >\n                  <Trans>Remove</Trans>\n                </Button>\n              )}\n            </Group>\n          </Table.Td>\n        </Table.Tr>\n      )) ?? []\n    );\n  }, [data]);\n\n  return (\n    <>\n      <RecoveryCodesModal\n        opened={recoveryCodesOpen}\n        setOpen={setRecoveryCodesOpen}\n        onReauthFlow={reauthenticate}\n      />\n      <RemoveTOTPModal\n        opened={removeTOTPModalOpen}\n        setOpen={setRemoveTOTPModalOpen}\n        onReauthFlow={reauthenticate}\n        onSuccess={refetch}\n      />\n      <RemoveWebauthnModal\n        tokenId={webauthnToken}\n        opened={removeWebauthnModalOpen}\n        setOpen={setRemoveWebauthnModalOpen}\n        onReauthFlow={reauthenticate}\n        onSuccess={refetch}\n      />\n      <RegisterTOTPModal\n        opened={registerTOTPModalOpen}\n        setOpen={setRegisterTOTPModalOpen}\n        onReauthFlow={reauthenticate}\n        onSuccess={refetch}\n      />\n      <ReauthenticatePasswordModal\n        opened={reauthPassOpen}\n        setOpen={setReauthPassModalOpen}\n      />\n      <ReauthenticateTOTPModal\n        opened={reauthTOTPOpen}\n        setOpen={setReauthTOTPModalOpen}\n      />\n      <SimpleGrid cols={{ xs: 1, md: 2 }} spacing='sm'>\n        {mfaRows.length > 0 ? (\n          <Table stickyHeader striped highlightOnHover withTableBorder>\n            <Table.Thead>\n              <Table.Tr>\n                <Table.Th>\n                  <Trans>Type</Trans>\n                </Table.Th>\n                <Table.Th>\n                  <Trans>Last used at</Trans>\n                </Table.Th>\n                <Table.Th>\n                  <Trans>Created at</Trans>\n                </Table.Th>\n                <Table.Th>\n                  <Trans>Actions</Trans>\n                </Table.Th>\n              </Table.Tr>\n            </Table.Thead>\n            <Table.Tbody>{mfaRows}</Table.Tbody>\n          </Table>\n        ) : (\n          <Alert\n            title={t`Not Configured`}\n            icon={<IconAlertCircle size='1rem' />}\n            color='yellow'\n          >\n            <Trans>No multi-factor tokens configured for this account</Trans>\n          </Alert>\n        )}\n        {possibleFactors.length > 0 ? (\n          <Stack>\n            <StylishText size='md'>{t`Register Authentication Method`}</StylishText>\n            {possibleFactors.map((factor) => (\n              <Tooltip label={factor.description} key={factor.type}>\n                <Button\n                  onClick={factor.function}\n                  disabled={factor.used}\n                  variant='outline'\n                  aria-label={`add-factor-${factor.type}`}\n                >\n                  {factor.name}\n                </Button>\n              </Tooltip>\n            ))}\n          </Stack>\n        ) : (\n          <Alert\n            title={t`No MFA Methods Available`}\n            icon={<IconAlertCircle size='1rem' />}\n            color='yellow'\n          >\n            <Trans>There are no MFA methods available for configuration</Trans>\n          </Alert>\n        )}\n      </SimpleGrid>\n    </>\n  );\n}\n","import { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { AuthConfig, AuthProvider } from '@lib/types/Auth';\nimport { t } from '@lingui/core/macro';\nimport { Trans } from '@lingui/react/macro';\nimport {\n  Accordion,\n  ActionIcon,\n  Alert,\n  Badge,\n  Button,\n  Grid,\n  Group,\n  Loader,\n  Radio,\n  SimpleGrid,\n  Stack,\n  Table,\n  Text,\n  TextInput\n} from '@mantine/core';\nimport { hideNotification, showNotification } from '@mantine/notifications';\nimport {\n  IconAlertCircle,\n  IconAt,\n  IconRefresh,\n  IconX\n} from '@tabler/icons-react';\nimport { useQuery } from '@tanstack/react-query';\nimport { useCallback, useMemo, useState } from 'react';\nimport { useShallow } from 'zustand/react/shallow';\nimport { StylishText } from '../../../../components/items/StylishText';\nimport { ProviderLogin, authApi } from '../../../../functions/auth';\nimport { useServerApiState } from '../../../../states/ServerApiState';\nimport { useUserState } from '../../../../states/UserState';\nimport { ApiTokenTable } from '../../../../tables/settings/ApiTokenTable';\nimport MFASettings from './MFASettings';\n\nexport function SecurityContent() {\n  const [auth_config, sso_enabled] = useServerApiState(\n    useShallow((state) => [state.auth_config, state.sso_enabled])\n  );\n\n  const user = useUserState();\n\n  return (\n    <Stack>\n      <Accordion multiple defaultValue={['email']}>\n        <Accordion.Item value='email'>\n          <Accordion.Control>\n            <StylishText size='lg'>{t`Email Addresses`}</StylishText>\n          </Accordion.Control>\n          <Accordion.Panel>\n            <EmailSection />\n          </Accordion.Panel>\n        </Accordion.Item>\n        <Accordion.Item value='sso'>\n          <Accordion.Control>\n            <StylishText size='lg'>{t`Single Sign On`}</StylishText>\n          </Accordion.Control>\n          <Accordion.Panel>\n            {sso_enabled() ? (\n              <ProviderSection auth_config={auth_config} />\n            ) : (\n              <Alert\n                icon={<IconAlertCircle size='1rem' />}\n                title={t`Not enabled`}\n                color='yellow'\n              >\n                <Trans>Single Sign On is not enabled for this server </Trans>\n              </Alert>\n            )}\n          </Accordion.Panel>\n        </Accordion.Item>\n        <Accordion.Item value='mfa'>\n          <Accordion.Control>\n            <StylishText size='lg'>{t`Multi-Factor Authentication`}</StylishText>\n          </Accordion.Control>\n          <Accordion.Panel>\n            <MFASettings />\n          </Accordion.Panel>\n        </Accordion.Item>\n        <Accordion.Item value='token'>\n          <Accordion.Control>\n            <StylishText size='lg'>{t`Access Tokens`}</StylishText>\n          </Accordion.Control>\n          <Accordion.Panel>\n            <ApiTokenTable only_myself />\n          </Accordion.Panel>\n        </Accordion.Item>\n        {user.isSuperuser() && (\n          <Accordion.Item value='session'>\n            <Accordion.Control>\n              <StylishText size='lg'>{t`Session Information`}</StylishText>\n            </Accordion.Control>\n            <Accordion.Panel>\n              <AuthContextSection />\n            </Accordion.Panel>\n          </Accordion.Item>\n        )}\n      </Accordion>\n    </Stack>\n  );\n}\n\nfunction AuthContextSection() {\n  const [auth_context, setAuthContext] = useServerApiState(\n    useShallow((state) => [state.auth_context, state.setAuthContext])\n  );\n\n  const fetchAuthContext = useCallback(() => {\n    authApi(apiUrl(ApiEndpoints.auth_session)).then((resp) => {\n      setAuthContext(resp.data.data);\n    });\n  }, [setAuthContext]);\n\n  return (\n    <Stack gap='xs'>\n      <Group>\n        <ActionIcon\n          onClick={fetchAuthContext}\n          variant='transparent'\n          aria-label='refresh-auth-context'\n        >\n          <IconRefresh />\n        </ActionIcon>\n      </Group>\n\n      <Table>\n        <Table.Thead>\n          <Table.Tr>\n            <Table.Th>{t`Timestamp`}</Table.Th>\n            <Table.Th>{t`Method`}</Table.Th>\n          </Table.Tr>\n        </Table.Thead>\n        <Table.Tbody>\n          {auth_context?.methods?.map((method: any, index: number) => (\n            <Table.Tr key={`auth-method-${index}`}>\n              <Table.Td>{parseDate(method.at)}</Table.Td>\n              <Table.Td>{method.method}</Table.Td>\n            </Table.Tr>\n          ))}\n        </Table.Tbody>\n      </Table>\n    </Stack>\n  );\n}\n\nfunction EmailSection() {\n  const [selectedEmail, setSelectedEmail] = useState<string>('');\n  const [newEmailValue, setNewEmailValue] = useState('');\n  const { isLoading, data, refetch } = useQuery({\n    queryKey: ['emails'],\n    queryFn: () =>\n      authApi(apiUrl(ApiEndpoints.auth_email)).then((res) => res.data.data)\n  });\n  const emailAvailable = useMemo(() => {\n    return data == undefined || data.length == 0;\n  }, [data]);\n\n  function runServerAction(\n    action: 'patch' | 'post' | 'put' | 'delete' = 'post',\n    data?: any\n  ) {\n    const vals: any = data || { email: selectedEmail };\n    return authApi(apiUrl(ApiEndpoints.auth_email), undefined, action, vals)\n      .then(() => {\n        refetch();\n      })\n      .catch((err) => {\n        hideNotification('email-error');\n\n        showNotification({\n          id: 'email-error',\n          title: t`Error`,\n          message: t`Error while updating email`,\n          color: 'red'\n        });\n      });\n  }\n\n  if (isLoading) return <Loader />;\n\n  return (\n    <SimpleGrid cols={{ xs: 1, md: 2 }} spacing='sm'>\n      {emailAvailable ? (\n        <Stack gap='xs'>\n          <Alert\n            icon={<IconAlertCircle size='1rem' />}\n            title={t`Not Configured`}\n            color='yellow'\n          >\n            <Trans>Currently no email addresses are registered.</Trans>\n          </Alert>\n        </Stack>\n      ) : (\n        <Radio.Group\n          value={selectedEmail}\n          onChange={setSelectedEmail}\n          name='email_accounts'\n          label={t`The following email addresses are associated with your account:`}\n        >\n          <Stack mt='xs'>\n            {data.map((email: any) => (\n              <Radio\n                key={email.email}\n                value={String(email.email)}\n                label={\n                  <Group justify='space-apart'>\n                    {email.email}\n                    <Group justify='right'>\n                      {email.primary && (\n                        <Badge color='blue'>\n                          <Trans>Primary</Trans>\n                        </Badge>\n                      )}\n                      {email.verified ? (\n                        <Badge color='green'>\n                          <Trans>Verified</Trans>\n                        </Badge>\n                      ) : (\n                        <Badge color='yellow'>\n                          <Trans>Unverified</Trans>\n                        </Badge>\n                      )}\n                    </Group>\n                  </Group>\n                }\n              />\n            ))}\n            <Group>\n              <Button\n                onClick={() =>\n                  runServerAction('patch', {\n                    email: selectedEmail,\n                    primary: true\n                  })\n                }\n                disabled={!selectedEmail}\n              >\n                <Trans>Make Primary</Trans>\n              </Button>\n              <Button\n                onClick={() => runServerAction('put')}\n                disabled={!selectedEmail}\n              >\n                <Trans>Re-send Verification</Trans>\n              </Button>\n              <Button\n                onClick={() => runServerAction('delete')}\n                disabled={!selectedEmail}\n                color='red'\n              >\n                <Trans>Remove</Trans>\n              </Button>\n            </Group>\n          </Stack>\n        </Radio.Group>\n      )}\n      <Stack>\n        <StylishText size='md'>{t`Add Email Address`}</StylishText>\n        <TextInput\n          label={t`E-Mail`}\n          placeholder={t`E-Mail address`}\n          leftSection={<IconAt />}\n          aria-label='email-address-input'\n          value={newEmailValue}\n          onChange={(event) => setNewEmailValue(event.currentTarget.value)}\n        />\n        <Button\n          aria-label='email-address-submit'\n          onClick={() =>\n            runServerAction('post', { email: newEmailValue }).catch((err) => {\n              if (err.status == 400) {\n                showNotification({\n                  title: t`Error while adding email`,\n                  message: err.response.data.errors\n                    .map((error: any) => error.message)\n                    .join('\\n'),\n                  color: 'red',\n                  icon: <IconX />\n                });\n              }\n            })\n          }\n        >\n          <Trans>Add Email</Trans>\n        </Button>\n      </Stack>\n    </SimpleGrid>\n  );\n}\n\nfunction ProviderButton({ provider }: Readonly<{ provider: AuthProvider }>) {\n  return (\n    <Button\n      key={provider.id}\n      variant='outline'\n      onClick={() => ProviderLogin(provider, 'connect')}\n    >\n      <Group justify='space-between'>{provider.name}</Group>\n    </Button>\n  );\n}\n\nfunction ProviderSection({\n  auth_config\n}: Readonly<{ auth_config: AuthConfig | undefined }>) {\n  const [value, setValue] = useState<string>('');\n  const { isLoading, data, refetch } = useQuery({\n    queryKey: ['provider-list'],\n    queryFn: () =>\n      authApi(apiUrl(ApiEndpoints.auth_providers))\n        .then((res) => res?.data?.data ?? [])\n        .catch(() => [])\n  });\n\n  const availableProviders = useMemo(() => {\n    if (!auth_config || !data) return [];\n\n    const configuredProviders = data.map((item: any) => item.provider.id);\n    return auth_config.socialaccount.providers.filter(\n      (provider: any) => !configuredProviders.includes(provider.id)\n    );\n  }, [auth_config, data]);\n\n  function removeProvider() {\n    const [uid, provider] = value.split('$');\n    authApi(apiUrl(ApiEndpoints.auth_providers), undefined, 'delete', {\n      provider,\n      account: uid\n    })\n      .then(() => {\n        refetch();\n      })\n      .catch((res) => console.log(res.data));\n  }\n\n  if (isLoading) return <Loader />;\n\n  return (\n    <Grid>\n      <Grid.Col span={6}>\n        {data.length == 0 ? (\n          <Stack gap='xs'>\n            <Alert\n              icon={<IconAlertCircle size='1rem' />}\n              title={t`Not Configured`}\n              color='yellow'\n            >\n              <Trans>There are no providers connected to this account.</Trans>\n            </Alert>\n          </Stack>\n        ) : (\n          <Stack>\n            <Radio.Group\n              value={value}\n              onChange={setValue}\n              name='sso_accounts'\n              label={t`You can sign in to your account using any of the following providers`}\n            >\n              <Stack mt='xs'>\n                {data.map((link: any) => (\n                  <Radio\n                    key={link.uid}\n                    value={[link.uid, link.provider.id].join('$')}\n                    label={`${link.provider.name}: ${link.display}`}\n                  />\n                ))}\n              </Stack>\n            </Radio.Group>\n            <Button onClick={removeProvider}>\n              <Trans>Remove Provider Link</Trans>\n            </Button>\n          </Stack>\n        )}\n      </Grid.Col>\n      <Grid.Col span={6}>\n        <Stack>\n          <Text>Add SSO Account</Text>\n          {availableProviders === undefined ? (\n            <Text>\n              <Trans>Loading</Trans>\n            </Text>\n          ) : (\n            <Stack gap='xs'>\n              {availableProviders.map((provider: any) => (\n                <ProviderButton key={provider.id} provider={provider} />\n              ))}\n            </Stack>\n          )}\n        </Stack>\n      </Grid.Col>\n    </Grid>\n  );\n}\n\nexport const parseDate = (date: number) =>\n  date == null ? 'Never' : new Date(date * 1000).toLocaleString();\n","import { t } from '@lingui/core/macro';\nimport { Trans } from '@lingui/react/macro';\nimport { Badge, Group, Stack, Table } from '@mantine/core';\nimport { IconEdit, IconKey, IconUser } from '@tabler/icons-react';\nimport { useMemo } from 'react';\n\nimport { ActionButton } from '@lib/components/ActionButton';\nimport { YesNoUndefinedButton } from '@lib/components/YesNoButton';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport type { ApiFormFieldSet } from '@lib/types/Forms';\nimport { useNavigate } from 'react-router-dom';\nimport { useShallow } from 'zustand/react/shallow';\nimport { ActionDropdown } from '../../../../components/items/ActionDropdown';\nimport { StylishText } from '../../../../components/items/StylishText';\nimport { useEditApiFormModal } from '../../../../hooks/UseForm';\nimport { useUserState } from '../../../../states/UserState';\n\nexport function AccountDetailPanel() {\n  const navigate = useNavigate();\n\n  const [user, fetchUserState] = useUserState(\n    useShallow((state) => [state.user, state.fetchUserState])\n  );\n\n  const userFields: ApiFormFieldSet = useMemo(() => {\n    return {\n      first_name: {},\n      last_name: {}\n    };\n  }, []);\n\n  const editAccount = useEditApiFormModal({\n    title: t`Edit Account Information`,\n    url: ApiEndpoints.user_me,\n    onFormSuccess: fetchUserState,\n    fields: userFields,\n    successMessage: t`Account details updated`\n  });\n\n  const profileFields: ApiFormFieldSet = useMemo(() => {\n    return {\n      displayname: {},\n      position: {},\n      status: {},\n      location: {},\n      active: {},\n      contact: {},\n      type: {},\n      organisation: {},\n      primary_group: {}\n    };\n  }, []);\n\n  const editProfile = useEditApiFormModal({\n    title: t`Edit Profile Information`,\n    url: ApiEndpoints.user_profile,\n    onFormSuccess: fetchUserState,\n    fields: profileFields,\n    successMessage: t`Profile details updated`\n  });\n\n  const accountDetailFields = useMemo(\n    () => [\n      { label: t`Username`, value: user?.username },\n      { label: t`First Name`, value: user?.first_name },\n      { label: t`Last Name`, value: user?.last_name },\n      {\n        label: t`Active`,\n        value: <YesNoUndefinedButton value={user?.profile?.active} />\n      },\n      {\n        label: t`Staff Access`,\n        value: <YesNoUndefinedButton value={user?.is_staff} />\n      },\n      {\n        label: t`Superuser`,\n        value: <YesNoUndefinedButton value={user?.is_superuser} />\n      }\n    ],\n    [user]\n  );\n\n  const profileDetailFields = useMemo(\n    () => [\n      { label: t`Display Name`, value: user?.profile?.displayname },\n      { label: t`Position`, value: user?.profile?.position },\n      { label: t`Status`, value: user?.profile?.status },\n      { label: t`Location`, value: user?.profile?.location },\n      { label: t`Contact`, value: user?.profile?.contact },\n      { label: t`Type`, value: <Badge>{user?.profile?.type}</Badge> },\n      { label: t`Organisation`, value: user?.profile?.organisation },\n      { label: t`Primary Group`, value: user?.profile?.primary_group }\n    ],\n    [user]\n  );\n\n  return (\n    <>\n      {editAccount.modal}\n      {editProfile.modal}\n      <Stack gap='xs'>\n        <Group justify='space-between'>\n          <StylishText size='lg'>\n            <Trans>Account Details</Trans>\n          </StylishText>\n          <ActionDropdown\n            tooltip={t`Account Actions`}\n            icon={<IconUser />}\n            actions={[\n              {\n                name: t`Edit Account`,\n                icon: <IconEdit />,\n                tooltip: t`Edit Account Information`,\n                onClick: editAccount.open\n              },\n              {\n                name: t`Change Password`,\n                icon: <IconKey />,\n                tooltip: t`Change User Password`,\n                onClick: () => {\n                  navigate('/change-password');\n                }\n              }\n            ]}\n          />\n        </Group>\n        {renderDetailTable(accountDetailFields)}\n\n        <Group justify='space-between'>\n          <StylishText size='lg'>\n            <Trans>Profile Details</Trans>\n          </StylishText>\n          <ActionButton\n            text={t`Edit Profile`}\n            icon={<IconEdit />}\n            tooltip={t`Edit Profile Information`}\n            onClick={editProfile.open}\n            variant='light'\n          />\n        </Group>\n        {renderDetailTable(profileDetailFields)}\n      </Stack>\n    </>\n  );\n\n  function renderDetailTable(data: { label: string; value: any }[]) {\n    return (\n      <Table>\n        <Table.Tbody>\n          {data.map((item) => (\n            <Table.Tr key={item.label}>\n              <Table.Td>\n                <Trans>{item.label}</Trans>\n              </Table.Td>\n              <Table.Td>{item.value}</Table.Td>\n            </Table.Tr>\n          ))}\n        </Table.Tbody>\n      </Table>\n    );\n  }\n}\n","import { t } from '@lingui/core/macro';\nimport { Trans } from '@lingui/react/macro';\nimport {\n  ActionIcon,\n  Button,\n  ColorInput,\n  ColorPicker,\n  Container,\n  DEFAULT_THEME,\n  Group,\n  Loader,\n  Select,\n  Slider,\n  Table,\n  useMantineTheme\n} from '@mantine/core';\nimport { IconRestore } from '@tabler/icons-react';\nimport { useState } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport { ColorToggle } from '../../../../components/items/ColorToggle';\nimport { LanguageSelect } from '../../../../components/items/LanguageSelect';\nimport { StylishText } from '../../../../components/items/StylishText';\nimport { SizeMarks } from '../../../../defaults/defaults';\nimport { IS_DEV } from '../../../../main';\nimport { useLocalState } from '../../../../states/LocalState';\n\nfunction getLkp(color: string) {\n  return { [DEFAULT_THEME.colors[color][6]]: color };\n}\nconst LOOKUP = Object.assign(\n  {},\n  ...Object.keys(DEFAULT_THEME.colors).map((clr) => getLkp(clr))\n);\n\nexport function UserTheme({ height }: Readonly<{ height: number }>) {\n  const theme = useMantineTheme();\n  const [userTheme, setTheme, setLanguage] = useLocalState(\n    useShallow((state) => [state.userTheme, state.setTheme, state.setLanguage])\n  );\n\n  // radius\n  function getRadiusFromValue(value: number) {\n    const obj = SizeMarks.find((mark) => mark.value === value);\n    if (obj) return obj.label;\n    return 'sm';\n  }\n\n  const [radius, setRadius] = useState(25);\n\n  function changeRadius(value: number) {\n    const r = getRadiusFromValue(value);\n    setRadius(value);\n\n    setTheme([{ key: 'radius', value: r.toString() }]);\n  }\n\n  return (\n    <Container w='100%' mih={height} p={0}>\n      <StylishText size='lg'>\n        <Trans>Display Settings</Trans>\n      </StylishText>\n      <Table>\n        <Table.Tbody>\n          <Table.Tr>\n            <Table.Td>\n              <Trans>Language</Trans>\n            </Table.Td>\n            <Table.Td>\n              <LanguageSelect width={200} />\n            </Table.Td>\n            <Table.Td>\n              {IS_DEV && (\n                <Button\n                  onClick={() => setLanguage('pseudo-LOCALE', true)}\n                  variant='light'\n                >\n                  <Trans>Use pseudo language</Trans>\n                </Button>\n              )}\n            </Table.Td>\n          </Table.Tr>\n          <Table.Tr>\n            <Table.Td>\n              <Trans>Color Mode</Trans>\n            </Table.Td>\n            <Table.Td>\n              <Group justify='left'>\n                <ColorToggle />\n              </Group>\n            </Table.Td>\n            <Table.Td />\n          </Table.Tr>\n          <Table.Tr>\n            <Table.Td>\n              <Trans>Highlight color</Trans>\n            </Table.Td>\n            <Table.Td>\n              <ColorPicker\n                format='hex'\n                onChange={(v) =>\n                  setTheme([{ key: 'primaryColor', value: LOOKUP[v] }])\n                }\n                withPicker={false}\n                swatches={Object.keys(LOOKUP)}\n              />\n            </Table.Td>\n            <Table.Td>\n              <Button color={theme.primaryColor} variant='light'>\n                <Trans>Example</Trans>\n              </Button>\n            </Table.Td>\n          </Table.Tr>\n          <Table.Tr>\n            <Table.Td>\n              <Trans>White color</Trans>\n            </Table.Td>\n            <Table.Td>\n              <ColorInput\n                aria-label='Color Picker White'\n                value={userTheme.whiteColor}\n                onChange={(v) => setTheme([{ key: 'whiteColor', value: v }])}\n              />\n            </Table.Td>\n            <Table.Td>\n              <ActionIcon\n                variant='default'\n                aria-label='Reset White Color'\n                onClick={() =>\n                  setTheme([{ key: 'whiteColor', value: '#FFFFFF' }])\n                }\n              >\n                <IconRestore />\n              </ActionIcon>\n            </Table.Td>\n          </Table.Tr>\n          <Table.Tr>\n            <Table.Td>\n              <Trans>Black color</Trans>\n            </Table.Td>\n            <Table.Td>\n              <ColorInput\n                aria-label='Color Picker Black'\n                value={userTheme.blackColor}\n                onChange={(v) => setTheme([{ key: 'blackColor', value: v }])}\n              />\n            </Table.Td>\n            <Table.Td>\n              <ActionIcon\n                variant='default'\n                aria-label='Reset Black Color'\n                onClick={() =>\n                  setTheme([{ key: 'blackColor', value: '#000000' }])\n                }\n              >\n                <IconRestore />\n              </ActionIcon>\n            </Table.Td>\n          </Table.Tr>\n          <Table.Tr>\n            <Table.Td>\n              <Trans>Border Radius</Trans>\n            </Table.Td>\n            <Table.Td>\n              <Slider\n                label={(val) => getRadiusFromValue(val)}\n                defaultValue={50}\n                step={25}\n                marks={SizeMarks}\n                value={radius}\n                onChange={changeRadius}\n                mb={18}\n              />\n            </Table.Td>\n          </Table.Tr>\n          <Table.Tr>\n            <Table.Td>\n              <Trans>Loader</Trans>\n            </Table.Td>\n            <Table.Td>\n              <Group justify='left'>\n                <Select\n                  aria-label='Loader Type Selector'\n                  data={[\n                    { value: 'bars', label: t`Bars` },\n                    { value: 'oval', label: t`Oval` },\n                    { value: 'dots', label: t`Dots` }\n                  ]}\n                  value={userTheme.loader}\n                  onChange={(v) => {\n                    if (v != null) setTheme([{ key: 'loader', value: v }]);\n                  }}\n                />\n              </Group>\n            </Table.Td>\n            <Table.Td>\n              <Group justify='left'>\n                <Loader type={userTheme.loader} mah={16} size='sm' />\n              </Group>\n            </Table.Td>\n          </Table.Tr>\n        </Table.Tbody>\n      </Table>\n    </Container>\n  );\n}\n","import { Container, Grid, SimpleGrid } from '@mantine/core';\n\nimport { AccountDetailPanel } from './AccountDetailPanel';\nimport { UserTheme } from './UserThemePanel';\n\nexport function AccountContent() {\n  const PRIMARY_COL_HEIGHT = 300;\n  const SECONDARY_COL_HEIGHT = PRIMARY_COL_HEIGHT / 2 - 8;\n\n  return (\n    <div>\n      <SimpleGrid cols={{ base: 1, md: 2 }} spacing='md'>\n        <Container w='100%'>\n          <AccountDetailPanel />\n        </Container>\n        <Grid gutter='md'>\n          <Grid.Col>\n            <UserTheme height={SECONDARY_COL_HEIGHT} />\n          </Grid.Col>\n        </Grid>\n      </SimpleGrid>\n    </div>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Skeleton, Stack } from '@mantine/core';\nimport {\n  IconBellCog,\n  IconDeviceDesktop,\n  IconFileAnalytics,\n  IconLock,\n  IconPlugConnected,\n  IconSearch,\n  IconUserCircle\n} from '@tabler/icons-react';\nimport { lazy, useMemo } from 'react';\n\nimport { useShallow } from 'zustand/react/shallow';\nimport PageTitle from '../../../components/nav/PageTitle';\nimport { SettingsHeader } from '../../../components/nav/SettingsHeader';\nimport type { PanelType } from '../../../components/panels/Panel';\nimport { PanelGroup } from '../../../components/panels/PanelGroup';\nimport { UserSettingList } from '../../../components/settings/SettingList';\nimport { Loadable } from '../../../functions/loading';\nimport { useUserState } from '../../../states/UserState';\nimport { SecurityContent } from './AccountSettings/SecurityContent';\nimport { AccountContent } from './AccountSettings/UserPanel';\n\nconst PluginSettingsGroup = Loadable(\n  lazy(() => import('./PluginSettingsGroup'))\n);\n\n/**\n * User settings page\n */\nexport default function UserSettings() {\n  const [user, isLoggedIn] = useUserState(\n    useShallow((state) => [state.user, state.isLoggedIn])\n  );\n\n  const userSettingsPanels: PanelType[] = useMemo(() => {\n    return [\n      {\n        name: 'account',\n        label: t`Account`,\n        icon: <IconUserCircle />,\n        content: <AccountContent />\n      },\n      {\n        name: 'security',\n        label: t`Security`,\n        icon: <IconLock />,\n        content: <SecurityContent />\n      },\n      {\n        name: 'display',\n        label: t`Display Options`,\n        icon: <IconDeviceDesktop />,\n        content: (\n          <UserSettingList\n            keys={[\n              'ICONS_IN_NAVBAR',\n              'STICKY_HEADER',\n              'STICKY_TABLE_HEADER',\n              'SHOW_SPOTLIGHT',\n              'BARCODE_IN_FORM_FIELDS',\n              'DATE_DISPLAY_FORMAT',\n              'FORMS_CLOSE_USING_ESCAPE',\n              'DISPLAY_STOCKTAKE_TAB',\n              'ENABLE_LAST_BREADCRUMB',\n              'SHOW_FULL_LOCATION_IN_TABLES',\n              'SHOW_FULL_CATEGORY_IN_TABLES'\n            ]}\n          />\n        )\n      },\n      {\n        name: 'search',\n        label: t`Search`,\n        icon: <IconSearch />,\n        content: (\n          <UserSettingList\n            keys={[\n              'SEARCH_WHOLE',\n              'SEARCH_REGEX',\n              'SEARCH_NOTES',\n              'SEARCH_PREVIEW_RESULTS',\n              'SEARCH_PREVIEW_SHOW_PARTS',\n              'SEARCH_HIDE_INACTIVE_PARTS',\n              'SEARCH_PREVIEW_SHOW_SUPPLIER_PARTS',\n              'SEARCH_PREVIEW_SHOW_MANUFACTURER_PARTS',\n              'SEARCH_PREVIEW_SHOW_CATEGORIES',\n              'SEARCH_PREVIEW_SHOW_STOCK',\n              'SEARCH_PREVIEW_HIDE_UNAVAILABLE_STOCK',\n              'SEARCH_PREVIEW_SHOW_LOCATIONS',\n              'SEARCH_PREVIEW_SHOW_COMPANIES',\n              'SEARCH_PREVIEW_SHOW_BUILD_ORDERS',\n              'SEARCH_PREVIEW_SHOW_PURCHASE_ORDERS',\n              'SEARCH_PREVIEW_EXCLUDE_INACTIVE_PURCHASE_ORDERS',\n              'SEARCH_PREVIEW_SHOW_SALES_ORDERS',\n              'SEARCH_PREVIEW_EXCLUDE_INACTIVE_SALES_ORDERS',\n              'SEARCH_PREVIEW_SHOW_SALES_ORDER_SHIPMENTS',\n              'SEARCH_PREVIEW_SHOW_RETURN_ORDERS',\n              'SEARCH_PREVIEW_EXCLUDE_INACTIVE_RETURN_ORDERS'\n            ]}\n          />\n        )\n      },\n      {\n        name: 'notifications',\n        label: t`Notifications`,\n        icon: <IconBellCog />,\n        content: (\n          <PluginSettingsGroup\n            mixin='notification'\n            global={false}\n            message={t`The settings below are specific to each available notification method`}\n          />\n        )\n      },\n      {\n        name: 'reporting',\n        label: t`Reporting`,\n        icon: <IconFileAnalytics />,\n        content: (\n          <UserSettingList\n            keys={['REPORT_INLINE', 'LABEL_INLINE', 'LABEL_DEFAULT_PRINTER']}\n          />\n        )\n      },\n      {\n        name: 'plugins',\n        label: t`Plugin Settings`,\n        icon: <IconPlugConnected />,\n        content: <PluginSettingsGroup global={false} />\n      }\n    ];\n  }, []);\n\n  if (!isLoggedIn()) {\n    return <Skeleton />;\n  }\n\n  return (\n    <>\n      <PageTitle title={t`User Settings`} />\n      <Stack gap='xs'>\n        <SettingsHeader\n          label='user'\n          title={t`User Settings`}\n          subtitle={\n            user?.first_name && user?.last_name\n              ? `${user?.first_name} ${user?.last_name}`\n              : null\n          }\n          shorthand={user?.username || ''}\n        />\n        <PanelGroup\n          pageKey='user-settings'\n          panels={userSettingsPanels}\n          model='usersettings'\n          id={null}\n        />\n      </Stack>\n    </>\n  );\n}\n"],"file":"UserSettings-DK8YYi_4.js"}