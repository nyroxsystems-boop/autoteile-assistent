{"version":3,"file":"MFA-BDo2e4C9.js","sources":["../../../../../../frontend/src/pages/Auth/MFA.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Trans } from '@lingui/react/macro';\nimport { Button, Checkbox, TextInput } from '@mantine/core';\nimport { useForm } from '@mantine/form';\nimport { useEffect, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { useShallow } from 'zustand/react/shallow';\nimport { handleMfaLogin, handleWebauthnLogin } from '../../functions/auth';\nimport { useServerApiState } from '../../states/ServerApiState';\nimport { Wrapper } from './Layout';\n\nexport default function Mfa() {\n  const simpleForm = useForm({ initialValues: { code: '', remember: false } });\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loginError, setLoginError] = useState<string | undefined>(undefined);\n  const [mfa_context] = useServerApiState(\n    useShallow((state) => [state.mfa_context])\n  );\n  const mfa_types = mfa_context?.types || [];\n\n  useEffect(() => {\n    if (mfa_types.includes('webauthn') || mfa_types.includes('webauthn_2fa')) {\n      handleWebauthnLogin(navigate, location);\n    }\n  }, [mfa_types]);\n\n  return (\n    <Wrapper titleText={t`Multi-Factor Authentication`} logOff>\n      {(mfa_types.includes('recovery_codes') || mfa_types.includes('totp')) && (\n        <TextInput\n          required\n          label={t`TOTP Code`}\n          name='TOTP'\n          description={t`Enter one of your codes: ${mfa_types}`}\n          {...simpleForm.getInputProps('code')}\n          error={loginError}\n        />\n      )}\n\n      <Checkbox\n        label={t`Remember this device`}\n        name='remember'\n        description={t`If enabled, you will not be asked for MFA on this device for 30 days.`}\n        {...simpleForm.getInputProps('remember', { type: 'checkbox' })}\n      />\n      <Button\n        type='submit'\n        onClick={() =>\n          handleMfaLogin(navigate, location, simpleForm.values, setLoginError)\n        }\n      >\n        <Trans>Log in</Trans>\n      </Button>\n    </Wrapper>\n  );\n}\n"],"names":["Mfa","simpleForm","useForm","initialValues","code","remember","navigate","useNavigate","location","useLocation","loginError","setLoginError","useState","undefined","mfa_context","useServerApiState","useShallow","state","mfa_types","types","useEffect","includes","handleWebauthnLogin","jsxs","Wrapper","_i18n","_","id","jsx","TextInput","values","getInputProps","Checkbox","type","Button","handleMfaLogin","_Trans"],"mappings":"oQAWA,SAAwBA,GAAM,CAC5B,MAAMC,EAAaC,EAAQ,CAAEC,cAAe,CAAEC,KAAM,GAAIC,SAAU,EAAA,CAAM,CAAG,EACrEC,EAAWC,EAAAA,EACXC,EAAWC,EAAAA,EACX,CAACC,EAAYC,CAAa,EAAIC,EAAAA,SAA6BC,MAAS,EACpE,CAACC,CAAW,EAAIC,EACpBC,KAAsB,CAACC,EAAMH,WAAW,CAAC,CAC3C,EACMI,EAAYJ,GAAaK,OAAS,CAAA,EAExCC,OAAAA,EAAAA,UAAU,IAAM,EACVF,EAAUG,SAAS,UAAU,GAAKH,EAAUG,SAAS,cAAc,IACrEC,EAAoBhB,EAAUE,CAAQ,CAE1C,EAAG,CAACU,CAAS,CAAC,EAGZK,EAAAA,KAACC,EAAA,CAAQ,UAAUC,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAA6B,EAAG,OAAM,GACtDT,SAAAA,EAAAA,EAAUG,SAAS,gBAAgB,GAAKH,EAAUG,SAAS,MAAM,IACjEO,EAAAA,IAACC,EAAA,CACC,SAAQ,GACR,MAAMJ,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAW,EAClB,KAAK,OACL,YAAYF,EAAAC,EAAC,CAAAC,GAAA,SAAAG,OAAA,CAAAZ,UAAAA,CAAAA,CAAsC,CAAC,EACpD,GAAIjB,EAAW8B,cAAc,MAAM,EACnC,MAAOrB,EAAW,EAItBkB,EAAAA,IAACI,EAAA,CACC,MAAMP,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAsB,EAC7B,KAAK,WACL,YAAYF,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAuE,EACpF,GAAI1B,EAAW8B,cAAc,WAAY,CAAEE,KAAM,UAAA,CAAY,EAAE,EAEjEL,EAAAA,IAACM,EAAA,CACC,KAAK,SACL,QAAS,IACPC,EAAe7B,EAAUE,EAAUP,EAAW6B,OAAQnB,CAAa,EAGrE,eAAAyB,EAAA,CAAAT,GAAA,SAAqB,CAAA,CACvB,CAAA,EACF,CAEJ"}