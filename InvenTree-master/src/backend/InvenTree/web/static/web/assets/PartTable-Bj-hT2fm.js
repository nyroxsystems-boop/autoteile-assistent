import{r as n,ag as V,az as J,bb as m,ab as e,ao as b,j as a,b1 as g,an as K,d as r,N as Q}from"./index-Db7AGPIq.js";import{u as U,R as H,d as X,A as z,I as Z}from"./InvenTreeTable-DmN557zY.js";import{d as ee,I as ae}from"./ImporterForms-D2fp0CPO.js";import{u as P,I as te}from"./ImportPartWizard-DE8Rg4Ga.js";import{O as ie}from"./OrderPartsWizard-BcMgRjfh.js";import{a as se}from"./formatters-B4ehJgEk.js";import{t as D,F as oe,W as le,a7 as ne}from"./ThemeContext-CxdCkKtz.js";import{a as S,b as re,e as de,I as O,f as c,T as ce}from"./Filter-BgnAqEQC.js";import{u as pe}from"./UsePlugins-BAQCKs7Q.js";import{P as _e,D as ue,C as me,e as be,L as he}from"./ColumnRenderers-BUH0stTX.js";function fe(){return[_e({part:"",accessor:"name"}),{accessor:"IPN",sortable:!0},{accessor:"revision",sortable:!0},{accessor:"units",sortable:!0},ue({}),me({accessor:"category_detail"}),be({accessor:"default_location_detail"}),{accessor:"total_in_stock",sortable:!0,render:t=>{const l=[],o=t?.total_in_stock??0,_=(t?.allocated_to_build_orders??0)+(t?.allocated_to_sales_orders??0),u=Math.max(0,o-_),h=t?.minimum_stock??0;let s=String(c(o)),i;return h>o&&(l.push(a.jsx(r,{c:"orange",children:`${e._({id:"Lgnuy/"})}: ${c(h)}`},"min-stock")),i="orange"),t.ordering>0&&l.push(a.jsx(r,{children:`${e._({id:"0lg3zX"})}: ${c(t.ordering)}`},"on-order")),t.building&&l.push(a.jsx(r,{children:`${e._({id:"oZd08v"})}: ${c(t.building)}`},"building")),t.allocated_to_build_orders>0&&l.push(a.jsx(r,{children:`${e._({id:"KCpl4N"})}: ${c(t.allocated_to_build_orders)}`},"bo-allocations")),t.allocated_to_sales_orders>0&&l.push(a.jsx(r,{children:`${e._({id:"DaWMWw"})}: ${c(t.allocated_to_sales_orders)}`},"so-allocations")),u!=o&&l.push(a.jsxs(r,{children:[e._({id:"csDS2L"}),": ",c(u)]},"available")),t.external_stock>0&&l.push(a.jsxs(r,{children:[e._({id:"e8fwfT"}),": ",c(t.external_stock)]},"external")),o<=0?(i="red",s=e._({id:"AbC1Px"})):u<=0?i="orange":u<h&&(i="yellow"),a.jsx(ce,{value:a.jsxs(Q,{gap:"xs",justify:"left",wrap:"nowrap",children:[a.jsx(r,{c:i,children:s}),t.units&&a.jsxs(r,{size:"xs",c:i,children:["[",t.units,"]"]})]}),title:e._({id:"odasNw"}),extra:l})}},{accessor:"price_range",title:e._({id:"YA4hwj"}),sortable:!0,ordering:"pricing_max",defaultVisible:!1,render:t=>se(t.pricing_min,t.pricing_max)},he({})]}function ye(){return[{name:"active",label:e._({id:"F6pfE9"}),description:e._({id:"PHri/6"}),type:"boolean"},{name:"locked",label:e._({id:"G2fuEb"}),description:e._({id:"j5DYyt"}),type:"boolean"},{name:"assembly",label:e._({id:"WL36Yh"}),description:e._({id:"oQzKsK"}),type:"boolean"},{name:"bom_valid",label:e._({id:"RqzqYw"}),description:e._({id:"weW3ee"}),type:"boolean"},{name:"cascade",label:e._({id:"NgZniC"}),description:e._({id:"5JhtGd"}),type:"boolean"},{name:"component",label:e._({id:"dK3Z9j"}),description:e._({id:"oO7QIX"}),type:"boolean"},{name:"testable",label:e._({id:"bJsTOf"}),description:e._({id:"n8MVvQ"}),type:"boolean"},{name:"trackable",label:e._({id:"y6MnU0"}),description:e._({id:"MbixSq"}),type:"boolean"},{name:"has_units",label:e._({id:"YyRdJQ"}),description:e._({id:"WyFVby"}),type:"boolean"},{name:"has_ipn",label:e._({id:"c9/Fqb"}),description:e._({id:"jh/Aa+"}),type:"boolean"},{name:"has_stock",label:e._({id:"JqmfuT"}),description:e._({id:"6Kd+HK"}),type:"boolean"},{name:"low_stock",label:e._({id:"UgdO7s"}),description:e._({id:"GDYPCw"}),type:"boolean"},{name:"purchaseable",label:e._({id:"TW9g28"}),description:e._({id:"KMdl2R"}),type:"boolean"},{name:"salable",label:e._({id:"/3xNJ4"}),description:e._({id:"V5i7hf"}),type:"boolean"},{name:"virtual",label:e._({id:"ksX7Wx"}),description:e._({id:"QDTpY6"}),type:"choice",choices:[{value:"true",label:e._({id:"ksX7Wx"})},{value:"false",label:e._({id:"+SkaI8"})}]},{name:"is_template",label:e._({id:"62zyX+"}),description:e._({id:"utmCBg"}),type:"boolean"},{name:"is_variant",label:e._({id:"t/zat7"}),description:e._({id:"7xsBld"}),type:"boolean"},{name:"is_revision",label:e._({id:"wV5kLq"}),description:e._({id:"bvyXYp"})},{name:"has_revisions",label:e._({id:"uN6v7B"}),description:e._({id:"mWe3zs"})},{name:"has_pricing",label:e._({id:"T43R5B"}),description:e._({id:"/t4j0O"}),type:"boolean"},{name:"unallocated_stock",label:e._({id:"oGd3rK"}),description:e._({id:"NINff3"}),type:"boolean"},{name:"starred",label:e._({id:"7VIaU3"}),description:e._({id:"PNFIYy"}),type:"boolean"}]}function Ie({enableImport:t=!0,basePartInstance:l,props:o,defaultPartData:_}){const u=n.useMemo(()=>fe(),[]),h=n.useMemo(()=>ye(),[]),s=U("part-list"),i=V(),f=J(),[E,k]=n.useState(!1),[v,C]=n.useState(void 0),B=n.useMemo(()=>{const p=ee({modelType:m.part});return p.field_defaults.value={...o?.params,..._},p},[_,o?.params]),j=S({url:b.import_session_list,title:e._({id:"WQcuFz"}),fields:B,onFormSuccess:p=>{C(p.pk),k(!0)}}),T=n.useMemo(()=>_??o?.params??{},[_,o?.params]),Y=P({create:!0,duplicatePartInstance:l}),w=S({url:b.part_list,title:e._({id:"rGfVOS"}),fields:Y,initialData:T,follow:!0,modelType:m.part}),[d,I]=n.useState({}),y=re({url:b.part_list,pk:d.pk,title:e._({id:"enG3o5"}),fields:P({create:!1}),onFormSuccess:s.refreshTable}),F=P({create:!0}),G=n.useMemo(()=>({...F,duplicate:{children:{part:{value:d.pk,hidden:!0},copy_image:{value:!0},copy_bom:{value:d.assembly&&f.isSet("PART_COPY_BOM"),hidden:!d.assembly},copy_notes:{value:!0},copy_parameters:{value:f.isSet("PART_COPY_PARAMETERS")},copy_tests:{value:d.testable,hidden:!d.testable}}}}),[F,f,d]),x=S({url:b.part_list,title:e._({id:"rGfVOS"}),fields:G,initialData:{...d,active:!0,locked:!1},follow:!1,modelType:m.part,onFormSuccess:s.refreshTable}),R=de({url:b.part_list,items:s.selectedIds,title:e._({id:"JSqPHE"}),fields:{category:{}},onFormSuccess:s.refreshTable}),A=ie({parts:s.selectedRecords}),M=pe("supplier"),W=te({categoryId:T.category}),L=n.useCallback(p=>{const $=i.hasChangePermission(m.part),q=i.hasAddPermission(m.part);return[H({hidden:!$,onClick:()=>{I(p),y.open()}}),X({hidden:!q,onClick:()=>{I(p),x.open()}})]},[i,y,x]),N=n.useMemo(()=>[a.jsx(z,{tooltip:e._({id:"loB51L"}),icon:a.jsx(D,{icon:"part"}),disabled:!s.hasSelectedRecords,position:"bottom-start",actions:[{name:e._({id:"JSqPHE"}),icon:a.jsx(D,{icon:"category"}),tooltip:e._({id:"AVPs2p"}),hidden:!i.hasChangeRole(g.part),disabled:!s.hasSelectedRecords,onClick:()=>{R.open()}},{name:e._({id:"3u5ICq"}),icon:a.jsx(oe,{color:"blue"}),tooltip:e._({id:"RBzQBd"}),hidden:!i.hasAddRole(g.purchase_order),onClick:()=>{A.openWizard()}}]}),a.jsx(z,{tooltip:e._({id:"BxO1rJ"}),position:"bottom-start",icon:a.jsx(O,{}),hidden:!i.hasAddRole(g.part),actions:[{name:e._({id:"22eAtb"}),icon:a.jsx(O,{}),tooltip:e._({id:"rwFPbf"}),onClick:()=>w.open()},{name:e._({id:"abGM9h"}),icon:a.jsx(le,{}),tooltip:e._({id:"Wau0Eb"}),onClick:()=>j.open(),hidden:!t},{name:e._({id:"3r3vHi"}),icon:a.jsx(ne,{}),tooltip:e._({id:"BMdZ4D"}),hidden:!t||M.length===0,onClick:()=>W.openWizard()}]},"add-parts-actions")],[i,t,s.hasSelectedRecords,M]);return a.jsxs(a.Fragment,{children:[w.modal,x.modal,y.modal,R.modal,j.modal,A.wizard,W.wizard,a.jsx(Z,{url:K(b.part_list),tableState:s,columns:u,props:{...o,enableDownload:!0,modelType:m.part,tableFilters:h,tableActions:N,rowActions:L,enableSelection:!0,enableReports:!0,enableLabels:!0,params:{...o?.params,category_detail:!0,location_detail:!0}}}),a.jsx(ae,{sessionId:v??-1,opened:v!=null&&E,onClose:()=>{C(void 0),k(!1),s.refreshTable()}})]})}export{Ie as P};
//# sourceMappingURL=PartTable-Bj-hT2fm.js.map
