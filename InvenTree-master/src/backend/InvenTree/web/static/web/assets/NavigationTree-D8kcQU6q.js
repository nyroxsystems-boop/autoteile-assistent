import{bH as S,r as h,aD as A,bh as D,b8 as I,j as a,N as x,al as E,ac as N,A as q,b9 as z,S as T,aj as L,ap as U,aq as F,ab as m,a8 as M,bI as R,an as _}from"./index-Db7AGPIq.js";import{a as $,v as B,U as G,S as H}from"./ThemeContext-CxdCkKtz.js";import{u as K}from"./DesktopAppView-BuH2j218.js";import{A as O}from"./Filter-BgnAqEQC.js";import{a as Q}from"./IconChevronDown-CzbIU38Y.js";import{I as Y}from"./IconChevronRight-V14UdNcU.js";function Z({title:v,opened:o,onClose:p,selectedId:l,modelType:c,endpoint:f}){const b=K(),d=$(),u=S(),t=B({enabled:o,queryKey:[c,o],queryFn:async()=>b.get(_(f),{data:{ordering:"level"}}).then(e=>e.data??[])}),w=h.useCallback((e,n)=>{const s=A(c,e.value);D(n)?I(s,d,n):(p(),d(s))},[c,d]),k=h.useMemo(()=>{const e={},n=[];if(!t||!t?.data?.length)return[];for(let s=0;s<t.data.length;s++){const r={...t.data[s],children:[],label:a.jsxs(x,{gap:"xs",children:[a.jsx(O,{name:t.data[s].icon}),t.data[s].name]}),value:t.data[s].pk.toString(),selected:t.data[s].pk===l},j=r.pk,g=r.parent;if(g?e[g]?.children.push(r):n.push(r),e[j]=r,j===l){let i=e[r.parent];for(;i;)i.expanded=!0,i=e[i.parent]}}return n},[l,t.data]),C=h.useCallback(e=>a.jsxs(x,{p:3,gap:"xs",justify:"left",wrap:"nowrap",onClick:()=>{e.hasChildren&&u.toggleExpanded(e.node.value)},children:[a.jsx(E,{w:10*(e.level-1)}),a.jsx(N,{size:"sm",variant:"transparent","aria-label":`nav-tree-toggle-${e.node.value}}`,children:e.hasChildren?e.expanded?a.jsx(Q,{}):a.jsx(Y,{}):null}),a.jsx(q,{onClick:n=>w(e.node,n),"aria-label":`nav-tree-item-${e.node.value}`,c:"var(--mantine-color-text)",children:e.node.label})]},e.node.value),[u]);return a.jsx(z,{opened:o,size:"md",position:"left",onClose:p,withCloseButton:!0,styles:{header:{width:"100%"},title:{width:"100%"}},title:a.jsxs(x,{justify:"left",p:"ms",gap:"md",wrap:"nowrap",children:[a.jsx(G,{}),a.jsx(H,{size:"lg",children:v})]}),children:a.jsxs(T,{gap:"xs",children:[a.jsx(L,{}),a.jsx(U,{visible:t.isFetching||t.isLoading}),t.isError?a.jsx(F,{color:"red",title:m._({id:"SlfejT"}),icon:a.jsx(M,{}),children:m._({id:"nY0zwD"})}):a.jsx(R,{data:k,tree:u,renderNode:C})]})})}export{Z as N};
//# sourceMappingURL=NavigationTree-D8kcQU6q.js.map
