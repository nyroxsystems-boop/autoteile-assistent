{"version":3,"file":"OrderPartsWizard-BcMgRjfh.js","sources":["../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconArrowLeft.mjs","../../../../../../frontend/src/forms/PurchaseOrderForms.tsx","../../../../../../frontend/src/components/wizards/WizardDrawer.tsx","../../../../../../frontend/src/hooks/UseWizard.tsx","../../../../../../frontend/src/components/wizards/OrderPartsWizard.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M5 12l14 0\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M5 12l6 6\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M5 12l6 -6\", \"key\": \"svg-2\" }]];\nconst IconArrowLeft = createReactComponent(\"outline\", \"arrow-left\", \"ArrowLeft\", __iconNode);\n\nexport { __iconNode, IconArrowLeft as default };\n//# sourceMappingURL=IconArrowLeft.mjs.map\n","import { t } from '@lingui/core/macro';\nimport {\n  Container,\n  Flex,\n  FocusTrap,\n  Group,\n  Modal,\n  Table,\n  TextInput\n} from '@mantine/core';\nimport { useDisclosure } from '@mantine/hooks';\nimport {\n  IconAddressBook,\n  IconCalendar,\n  IconCoins,\n  IconCurrencyDollar,\n  IconHash,\n  IconLink,\n  IconList,\n  IconNotes,\n  IconSitemap,\n  IconUser,\n  IconUsers\n} from '@tabler/icons-react';\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { ActionButton } from '@lib/components/ActionButton';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { IconCalendarExclamation } from '@tabler/icons-react';\nimport dayjs from 'dayjs';\nimport RemoveRowButton from '../components/buttons/RemoveRowButton';\nimport { StandaloneField } from '../components/forms/StandaloneField';\n\nimport { ProgressBar } from '@lib/components/ProgressBar';\nimport { apiUrl } from '@lib/functions/Api';\nimport { toNumber } from '@lib/functions/Conversion';\nimport type {\n  ApiFormAdjustFilterType,\n  ApiFormFieldSet\n} from '@lib/types/Forms';\nimport {\n  TableFieldExtraRow,\n  type TableFieldRowProps\n} from '../components/forms/fields/TableField';\nimport { Thumbnail } from '../components/images/Thumbnail';\nimport { StylishText } from '../components/items/StylishText';\nimport { getStatusCodeOptions } from '../components/render/StatusRenderer';\nimport { InvenTreeIcon } from '../functions/icons';\nimport { useCreateApiFormModal } from '../hooks/UseForm';\nimport {\n  useBatchCodeGenerator,\n  useSerialNumberGenerator\n} from '../hooks/UseGenerator';\nimport { useGlobalSettingsState } from '../states/SettingsStates';\n/*\n * Construct a set of fields for creating / editing a PurchaseOrderLineItem instance\n */\nexport function usePurchaseOrderLineItemFields({\n  supplierId,\n  orderId,\n  currency,\n  create\n}: {\n  supplierId?: number;\n  orderId?: number;\n  currency?: string;\n  create?: boolean;\n}) {\n  const globalSettings = useGlobalSettingsState();\n\n  const [purchasePrice, setPurchasePrice] = useState<string>('');\n  const [purchasePriceCurrency, setPurchasePriceCurrency] = useState<string>(\n    currency ?? ''\n  );\n\n  const [autoPricing, setAutoPricing] = useState(false);\n\n  const [quantity, setQuantity] = useState<string>('1');\n\n  // Internal part information\n  const [part, setPart] = useState<any>({});\n  const [priceBreaks, setPriceBreaks] = useState<any[]>([]);\n  const [suggestedPurchasePrice, setSuggestedPurchasePrice] = useState<\n    string | undefined\n  >(undefined);\n\n  // Update suggested purchase price when part, quantity, or price breaks change\n  useEffect(() => {\n    // Only attempt to set purchase price for new line items\n    if (!create) return;\n\n    const qty = toNumber(quantity, null);\n\n    if (qty == null || qty <= 0) {\n      setSuggestedPurchasePrice(undefined);\n      return;\n    }\n\n    if (!part || !priceBreaks || priceBreaks.length === 0) {\n      setSuggestedPurchasePrice(undefined);\n      return;\n    }\n\n    const applicablePriceBreaks = priceBreaks\n      .filter((pb: any) => qty >= pb.quantity)\n      .sort((a: any, b: any) => b.quantity - a.quantity);\n\n    if (applicablePriceBreaks.length) {\n      setSuggestedPurchasePrice(applicablePriceBreaks[0].price);\n    } else {\n      setSuggestedPurchasePrice(undefined);\n    }\n  }, [create, part, quantity, priceBreaks]);\n\n  useEffect(() => {\n    if (autoPricing) {\n      setPurchasePrice('');\n    }\n  }, [autoPricing]);\n\n  useEffect(() => {\n    setAutoPricing(purchasePrice === '');\n  }, [purchasePrice]);\n\n  const fields = useMemo(() => {\n    const fields: ApiFormFieldSet = {\n      order: {\n        filters: {\n          supplier_detail: true\n        },\n        disabled: true\n      },\n      part: {\n        filters: {\n          part_detail: true,\n          supplier_detail: true,\n          active: true,\n          part_active: true,\n          price_breaks: true\n        },\n        onValueChange: (value, record) => {\n          setPriceBreaks(record?.price_breaks ?? []);\n          setPart(record?.part_detail ?? {});\n        },\n        adjustFilters: (adjust: ApiFormAdjustFilterType) => {\n          return {\n            ...adjust.filters,\n            supplier: supplierId\n          };\n        }\n      },\n      reference: {},\n      quantity: {\n        onValueChange: (value) => {\n          setQuantity(value);\n        }\n      },\n      purchase_price: {\n        icon: <IconCurrencyDollar />,\n        value: purchasePrice,\n        placeholder: suggestedPurchasePrice,\n        placeholderAutofill: true,\n        onValueChange: setPurchasePrice\n      },\n      purchase_price_currency: {\n        icon: <IconCoins />,\n        value: purchasePriceCurrency,\n        onValueChange: setPurchasePriceCurrency\n      },\n      auto_pricing: {\n        value: autoPricing,\n        onValueChange: setAutoPricing\n      },\n      project_code: {\n        description: t`Select project code for this line item`\n      },\n      target_date: {\n        icon: <IconCalendar />\n      },\n      destination: {\n        icon: <IconSitemap />\n      },\n      build_order: {\n        disabled: !part?.assembly,\n        filters: {\n          external: true,\n          outstanding: true,\n          part: part?.pk\n        }\n      },\n      notes: {\n        icon: <IconNotes />\n      },\n      link: {\n        icon: <IconLink />\n      }\n    };\n\n    if (!globalSettings.isSet('BUILDORDER_EXTERNAL_BUILDS', false)) {\n      delete fields.build_order;\n    }\n\n    if (create) {\n      fields['merge_items'] = {};\n    }\n\n    return fields;\n  }, [\n    create,\n    orderId,\n    part,\n    globalSettings,\n    supplierId,\n    autoPricing,\n    purchasePrice,\n    suggestedPurchasePrice\n  ]);\n\n  return fields;\n}\n\n/**\n * Construct a set of fields for creating / editing a PurchaseOrder instance\n */\nexport function usePurchaseOrderFields({\n  supplierId,\n  duplicateOrderId\n}: {\n  supplierId?: number;\n  duplicateOrderId?: number;\n}): ApiFormFieldSet {\n  const globalSettings = useGlobalSettingsState();\n\n  return useMemo(() => {\n    const fields: ApiFormFieldSet = {\n      reference: {\n        icon: <IconHash />\n      },\n      description: {},\n      supplier: {\n        value: supplierId,\n        disabled: !!duplicateOrderId || !!supplierId,\n        filters: {\n          is_supplier: true,\n          active: true\n        }\n      },\n      supplier_reference: {},\n      project_code: {\n        icon: <IconList />\n      },\n      order_currency: {\n        icon: <IconCoins />\n      },\n      start_date: {\n        icon: <IconCalendar />\n      },\n      target_date: {\n        icon: <IconCalendar />\n      },\n      destination: {\n        filters: {\n          structural: false\n        }\n      },\n      link: {},\n      contact: {\n        icon: <IconUser />,\n        adjustFilters: (value: ApiFormAdjustFilterType) => {\n          return {\n            ...value.filters,\n            company: value.data.supplier\n          };\n        }\n      },\n      address: {\n        icon: <IconAddressBook />,\n        adjustFilters: (value: ApiFormAdjustFilterType) => {\n          return {\n            ...value.filters,\n            company: value.data.supplier\n          };\n        }\n      },\n      responsible: {\n        filters: {\n          is_active: true\n        },\n        icon: <IconUsers />\n      }\n    };\n\n    // Order duplication fields\n    if (!!duplicateOrderId) {\n      fields.duplicate = {\n        children: {\n          order_id: {\n            hidden: true,\n            value: duplicateOrderId\n          },\n          copy_lines: {},\n          copy_extra_lines: {}\n        }\n      };\n    }\n\n    if (!globalSettings.isSet('PROJECT_CODES_ENABLED', true)) {\n      delete fields.project_code;\n    }\n\n    return fields;\n  }, [duplicateOrderId, supplierId, globalSettings]);\n}\n\n/**\n * Render a table row for a single TableField entry\n */\nfunction LineItemFormRow({\n  props,\n  record,\n  statuses\n}: Readonly<{\n  props: TableFieldRowProps;\n  record: any;\n  statuses: any;\n}>) {\n  // Barcode Modal state\n  const [opened, { open, close }] = useDisclosure(false, {\n    onClose: () => props.changeFn(props.idx, 'barcode', undefined)\n  });\n\n  const [locationOpen, locationHandlers] = useDisclosure(false, {\n    onClose: () => props.changeFn(props.idx, 'location', undefined)\n  });\n\n  // Is this a trackable part?\n  const trackable: boolean = useMemo(\n    () => record.part_detail?.trackable ?? false,\n    [record]\n  );\n\n  const settings = useGlobalSettingsState();\n\n  useEffect(() => {\n    if (!!record.destination) {\n      props.changeFn(props.idx, 'location', record.destination);\n      locationHandlers.open();\n    }\n  }, [record.destination]);\n\n  // Batch code generator\n  const batchCodeGenerator = useBatchCodeGenerator({\n    isEnabled: () => batchOpen,\n    onGenerate: (value: any) => {\n      if (value) {\n        props.changeFn(props.idx, 'batch_code', value);\n      }\n    }\n  });\n\n  // Serial number generator\n  const serialNumberGenerator = useSerialNumberGenerator({\n    isEnabled: () => batchOpen && trackable,\n    onGenerate: (value: any) => {\n      if (value) {\n        props.changeFn(props.idx, 'serial_numbers', value);\n      }\n    }\n  });\n\n  const [packagingOpen, packagingHandlers] = useDisclosure(false, {\n    onClose: () => {\n      props.changeFn(props.idx, 'packaging', undefined);\n    }\n  });\n\n  const [noteOpen, noteHandlers] = useDisclosure(false, {\n    onClose: () => {\n      props.changeFn(props.idx, 'note', undefined);\n    }\n  });\n\n  const [batchOpen, batchHandlers] = useDisclosure(false, {\n    onClose: () => {\n      props.changeFn(props.idx, 'batch_code', undefined);\n      props.changeFn(props.idx, 'serial_numbers', undefined);\n    },\n    onOpen: () => {\n      // Generate a new batch code\n      batchCodeGenerator.update({\n        part: record?.supplier_part_detail?.part,\n        order: record?.order\n      });\n      // Generate new serial numbers\n      if (trackable) {\n        serialNumberGenerator.update({\n          part: record?.supplier_part_detail?.part,\n          quantity: props.item.quantity\n        });\n      } else {\n        props.changeFn(props.idx, 'serial_numbers', undefined);\n      }\n    }\n  });\n\n  const [expiryDateOpen, expiryDateHandlers] = useDisclosure(false, {\n    onOpen: () => {\n      // check the default part expiry. Assume expiry is relative to today\n      const defaultExpiry = record.part_detail?.default_expiry;\n      if (defaultExpiry !== undefined && defaultExpiry > 0) {\n        props.changeFn(\n          props.idx,\n          'expiry_date',\n          dayjs().add(defaultExpiry, 'day').format('YYYY-MM-DD')\n        );\n      }\n    },\n    onClose: () => {\n      props.changeFn(props.idx, 'expiry_date', undefined);\n    }\n  });\n\n  // Status value\n  const [statusOpen, statusHandlers] = useDisclosure(false, {\n    onClose: () => props.changeFn(props.idx, 'status', undefined)\n  });\n\n  // Barcode value\n  const [barcodeInput, setBarcodeInput] = useState<any>('');\n  const [barcode, setBarcode] = useState<string | undefined>(undefined);\n\n  // Change form value when state is altered\n  useEffect(() => {\n    props.changeFn(props.idx, 'barcode', barcode);\n  }, [barcode]);\n\n  const batchToolTip: string = useMemo(() => {\n    if (trackable) {\n      return t`Assign Batch Code and Serial Numbers`;\n    } else {\n      return t`Assign Batch Code`;\n    }\n  }, [trackable]);\n\n  // Update location field description on state change\n  useEffect(() => {\n    if (!opened) {\n      return;\n    }\n\n    const timeoutId = setTimeout(() => {\n      setBarcode(barcodeInput.length ? barcodeInput : null);\n      close();\n      setBarcodeInput('');\n    }, 500);\n    return () => clearTimeout(timeoutId);\n  }, [barcodeInput]);\n\n  // Info string with details about certain selected locations\n  const locationDescription = useMemo(() => {\n    const text = t`Choose Location`;\n\n    if (location === null) {\n      return text;\n    }\n\n    // Selected location is order line destination\n    if (location === record.destination) {\n      return t`Item Destination selected`;\n    }\n\n    // Selected location is base part's category default location\n    if (\n      !record.destination &&\n      !record.destination_detail &&\n      record.part_detail &&\n      location === record.part_detail?.category_default_location\n    ) {\n      return t`Part category default location selected`;\n    }\n\n    // Selected location is identical to already received stock for this line\n    if (\n      !record.destination &&\n      record.destination_detail &&\n      location === record.destination_detail.pk &&\n      record.received > 0\n    ) {\n      return t`Received stock location selected`;\n    }\n\n    // Selected location is base part's default location\n    if (\n      record.part_detail?.default_location &&\n      location === record.part_detail.default_location\n    ) {\n      return t`Default location selected`;\n    }\n\n    return text;\n  }, [location]);\n\n  return (\n    <>\n      <Modal\n        opened={opened}\n        onClose={close}\n        title={<StylishText>{t`Scan Barcode`}</StylishText>}\n      >\n        <FocusTrap>\n          <TextInput\n            label='Barcode data'\n            data-autofocus\n            value={barcodeInput}\n            onChange={(e) => setBarcodeInput(e.target.value)}\n          />\n        </FocusTrap>\n      </Modal>\n      <Table.Tr>\n        <Table.Td>\n          <Flex gap='sm' align='center'>\n            <Thumbnail\n              size={40}\n              src={record.part_detail.thumbnail}\n              align='center'\n            />\n            <div>{record.part_detail.name}</div>\n          </Flex>\n        </Table.Td>\n        <Table.Td>{record.supplier_part_detail.SKU}</Table.Td>\n        <Table.Td>\n          <ProgressBar\n            value={record.received}\n            maximum={record.quantity}\n            progressLabel\n          />\n        </Table.Td>\n        <Table.Td style={{ whiteSpace: 'nowrap' }}>\n          <StandaloneField\n            fieldName='quantity'\n            fieldDefinition={{\n              field_type: 'number',\n              value: props.item.quantity,\n              onValueChange: (value) => {\n                props.changeFn(props.idx, 'quantity', value);\n                serialNumberGenerator.update({ quantity: value });\n              }\n            }}\n            error={props.rowErrors?.quantity?.message}\n          />\n        </Table.Td>\n        <Table.Td style={{ width: '1%', whiteSpace: 'nowrap' }}>\n          <Flex gap='1px'>\n            <ActionButton\n              size='sm'\n              onClick={() => locationHandlers.toggle()}\n              icon={<InvenTreeIcon icon='location' />}\n              tooltip={t`Set Location`}\n              tooltipAlignment='top'\n              variant={locationOpen ? 'outline' : 'transparent'}\n            />\n            <ActionButton\n              size='sm'\n              onClick={() => batchHandlers.toggle()}\n              icon={<InvenTreeIcon icon='batch_code' />}\n              tooltip={batchToolTip}\n              tooltipAlignment='top'\n              variant={batchOpen ? 'outline' : 'transparent'}\n            />\n            {settings.isSet('STOCK_ENABLE_EXPIRY') && (\n              <ActionButton\n                size='sm'\n                onClick={() => expiryDateHandlers.toggle()}\n                icon={<IconCalendarExclamation />}\n                tooltip={t`Set Expiry Date`}\n                tooltipAlignment='top'\n                variant={expiryDateOpen ? 'outline' : 'transparent'}\n              />\n            )}\n            <ActionButton\n              size='sm'\n              icon={<InvenTreeIcon icon='packaging' />}\n              tooltip={t`Adjust Packaging`}\n              tooltipAlignment='top'\n              onClick={() => packagingHandlers.toggle()}\n              variant={packagingOpen ? 'outline' : 'transparent'}\n            />\n            <ActionButton\n              onClick={() => statusHandlers.toggle()}\n              icon={<InvenTreeIcon icon='status' />}\n              tooltip={t`Change Status`}\n              tooltipAlignment='top'\n              variant={statusOpen ? 'outline' : 'transparent'}\n            />\n            <ActionButton\n              icon={<InvenTreeIcon icon='note' />}\n              tooltip={t`Add Note`}\n              tooltipAlignment='top'\n              variant={noteOpen ? 'outline' : 'transparent'}\n              onClick={() => noteHandlers.toggle()}\n            />\n            {barcode ? (\n              <ActionButton\n                icon={<InvenTreeIcon icon='unlink' />}\n                tooltip={t`Unlink Barcode`}\n                tooltipAlignment='top'\n                variant='filled'\n                color='red'\n                onClick={() => setBarcode(undefined)}\n              />\n            ) : (\n              <ActionButton\n                icon={<InvenTreeIcon icon='barcode' />}\n                tooltip={t`Scan Barcode`}\n                tooltipAlignment='top'\n                variant='transparent'\n                onClick={() => open()}\n              />\n            )}\n          </Flex>\n        </Table.Td>\n        <Table.Td>\n          <RemoveRowButton onClick={() => props.removeFn(props.idx)} />\n        </Table.Td>\n      </Table.Tr>\n      {locationOpen && (\n        <Table.Tr>\n          <Table.Td colSpan={10}>\n            <Group grow preventGrowOverflow={false} justify='flex-apart' p='xs'>\n              <Container flex={0} p='xs'>\n                <InvenTreeIcon icon='downright' />\n              </Container>\n              <StandaloneField\n                fieldDefinition={{\n                  field_type: 'related field',\n                  model: ModelType.stocklocation,\n                  api_url: apiUrl(ApiEndpoints.stock_location_list),\n                  filters: {\n                    structural: false\n                  },\n                  onValueChange: (value) => {\n                    props.changeFn(props.idx, 'location', value);\n                  },\n                  description: locationDescription,\n                  value: props.item.location,\n                  label: t`Location`,\n                  icon: <InvenTreeIcon icon='location' />\n                }}\n                defaultValue={\n                  record.destination ??\n                  (record.destination_detail\n                    ? record.destination_detail.pk\n                    : null)\n                }\n              />\n              <Flex style={{ marginBottom: '7px' }}>\n                {(record.part_detail?.default_location ||\n                  record.part_detail?.category_default_location) && (\n                  <ActionButton\n                    icon={<InvenTreeIcon icon='default_location' />}\n                    tooltip={t`Store at default location`}\n                    onClick={() =>\n                      props.changeFn(\n                        props.idx,\n                        'location',\n                        record.part_detail?.default_location ??\n                          record.part_detail?.category_default_location\n                      )\n                    }\n                    tooltipAlignment='top'\n                  />\n                )}\n                {record.destination && (\n                  <ActionButton\n                    icon={<InvenTreeIcon icon='destination' />}\n                    tooltip={t`Store at line item destination `}\n                    onClick={() =>\n                      props.changeFn(props.idx, 'location', record.destination)\n                    }\n                    tooltipAlignment='top'\n                  />\n                )}\n                {!record.destination &&\n                  record.destination_detail &&\n                  record.received > 0 && (\n                    <ActionButton\n                      icon={<InvenTreeIcon icon='repeat_destination' />}\n                      tooltip={t`Store with already received stock`}\n                      onClick={() =>\n                        props.changeFn(\n                          props.idx,\n                          'location',\n                          record.destination_detail.pk\n                        )\n                      }\n                      tooltipAlignment='top'\n                    />\n                  )}\n              </Flex>\n            </Group>\n          </Table.Td>\n        </Table.Tr>\n      )}\n      <TableFieldExtraRow\n        visible={batchOpen}\n        onValueChange={(value) => {\n          props.changeFn(props.idx, 'batch_code', value);\n        }}\n        fieldName='batch_code'\n        fieldDefinition={{\n          field_type: 'string',\n          label: t`Batch Code`,\n          description: t`Enter batch code for received items`,\n          value: props.item.batch_code\n        }}\n        error={props.rowErrors?.batch_code?.message}\n      />\n      <TableFieldExtraRow\n        visible={batchOpen && trackable}\n        onValueChange={(value) =>\n          props.changeFn(props.idx, 'serial_numbers', value)\n        }\n        fieldName='serial_numbers'\n        fieldDefinition={{\n          field_type: 'string',\n          label: t`Serial Numbers`,\n          description: t`Enter serial numbers for received items`,\n          value: props.item.serial_numbers\n        }}\n        error={props.rowErrors?.serial_numbers?.message}\n      />\n      {settings.isSet('STOCK_ENABLE_EXPIRY') && (\n        <TableFieldExtraRow\n          visible={expiryDateOpen}\n          onValueChange={(value) =>\n            props.changeFn(props.idx, 'expiry_date', value)\n          }\n          fieldName='expiry_date'\n          fieldDefinition={{\n            field_type: 'date',\n            label: t`Expiry Date`,\n            description: t`Enter an expiry date for received items`,\n            value: props.item.expiry_date\n          }}\n          error={props.rowErrors?.expiry_date?.message}\n        />\n      )}\n      <TableFieldExtraRow\n        visible={packagingOpen}\n        onValueChange={(value) => props.changeFn(props.idx, 'packaging', value)}\n        fieldName='packaging'\n        fieldDefinition={{\n          field_type: 'string',\n          label: t`Packaging`\n        }}\n        defaultValue={record?.supplier_part_detail?.packaging}\n        error={props.rowErrors?.packaging?.message}\n      />\n      <TableFieldExtraRow\n        visible={statusOpen}\n        defaultValue={10}\n        fieldName='status'\n        onValueChange={(value) => props.changeFn(props.idx, 'status', value)}\n        fieldDefinition={{\n          field_type: 'choice',\n          api_url: apiUrl(ApiEndpoints.stock_status),\n          choices: statuses,\n          label: t`Status`\n        }}\n        error={props.rowErrors?.status?.message}\n      />\n      <TableFieldExtraRow\n        visible={noteOpen}\n        fieldName='note'\n        onValueChange={(value) => props.changeFn(props.idx, 'note', value)}\n        fieldDefinition={{\n          field_type: 'string',\n          label: t`Note`\n        }}\n        error={props.rowErrors?.note?.message}\n      />\n    </>\n  );\n}\n\ntype LineFormHandlers = {\n  onOpen?: () => void;\n  onClose?: () => void;\n};\n\ntype LineItemsForm = {\n  items: any[];\n  orderPk: number;\n  destinationPk?: number;\n  formProps?: LineFormHandlers;\n};\n\nexport function useReceiveLineItems(props: LineItemsForm) {\n  const stockStatusCodes = useMemo(\n    () => getStatusCodeOptions(ModelType.stockitem),\n    []\n  );\n\n  const records = Object.fromEntries(\n    props.items.map((item) => [item.pk, item])\n  );\n\n  const filteredItems = props.items.filter(\n    (elem) => elem.quantity !== elem.received\n  );\n\n  const fields: ApiFormFieldSet = useMemo(() => {\n    return {\n      id: {\n        value: props.orderPk,\n        hidden: true\n      },\n      items: {\n        field_type: 'table',\n        value: filteredItems.map((elem, idx) => {\n          return {\n            line_item: elem.pk,\n            location: elem.destination ?? elem.destination_detail?.pk ?? null,\n            quantity: elem.quantity - elem.received,\n            expiry_date: null,\n            batch_code: '',\n            serial_numbers: '',\n            status: 10,\n            barcode: null\n          };\n        }),\n        modelRenderer: (row: TableFieldRowProps) => {\n          const record = records[row.item.line_item];\n\n          if (!record) {\n            return null;\n          }\n\n          return (\n            <LineItemFormRow\n              props={row}\n              record={record}\n              statuses={stockStatusCodes}\n              key={record.pk}\n            />\n          );\n        },\n        headers: [\n          { title: t`Part`, style: { minWidth: '200px' } },\n          { title: t`SKU`, style: { minWidth: '200px' } },\n          { title: t`Received`, style: { minWidth: '200px' } },\n          { title: t`Quantity`, style: { width: '200px' } },\n          { title: t`Actions` },\n          { title: '', style: { width: '50px' } }\n        ]\n      },\n      location: {\n        filters: {\n          structural: false\n        }\n      }\n    };\n  }, [filteredItems, props, stockStatusCodes]);\n\n  return useCreateApiFormModal({\n    ...props.formProps,\n    url: apiUrl(ApiEndpoints.purchase_order_receive, props.orderPk),\n    title: t`Receive Line Items`,\n    fields: fields,\n    initialData: {\n      location: props.destinationPk\n    },\n    size: '80%',\n    successMessage: t`Items received`\n  });\n}\n","import { t } from '@lingui/core/macro';\nimport {\n  ActionIcon,\n  Card,\n  Divider,\n  Drawer,\n  Group,\n  Space,\n  Stack,\n  Stepper,\n  Tooltip\n} from '@mantine/core';\nimport {\n  IconArrowLeft,\n  IconArrowRight,\n  IconCircleCheck\n} from '@tabler/icons-react';\nimport { type ReactNode, useCallback, useMemo } from 'react';\nimport { Boundary } from '../Boundary';\nimport { StylishText } from '../items/StylishText';\n\n/**\n * Progress stepper displayed at the top of the wizard drawer.\n */\nfunction WizardProgressStepper({\n  currentStep,\n  steps,\n  onSelectStep,\n  disableManualStepChange = false\n}: {\n  currentStep: number;\n  steps: string[];\n  onSelectStep: (step: number) => void;\n  disableManualStepChange?: boolean;\n}) {\n  if (!steps || steps.length == 0) {\n    return null;\n  }\n\n  // Determine if the user can select a particular step\n  const canSelectStep = useCallback(\n    (step: number) => {\n      if (!steps || steps.length <= 1) {\n        return false;\n      }\n\n      // Only allow single-step progression\n      return Math.abs(step - currentStep) == 1;\n    },\n    [currentStep, steps]\n  );\n\n  const canStepBackward = currentStep > 0;\n  const canStepForward = currentStep < steps.length - 1;\n\n  return (\n    <Card p='xs' withBorder>\n      <Group\n        justify={disableManualStepChange ? 'center' : 'space-between'}\n        gap='xs'\n        wrap='nowrap'\n      >\n        {!disableManualStepChange && (\n          <Tooltip\n            label={steps[currentStep - 1]}\n            position='top'\n            disabled={!canStepBackward}\n          >\n            <ActionIcon\n              variant='transparent'\n              onClick={() => onSelectStep(currentStep - 1)}\n              disabled={!canStepBackward}\n            >\n              <IconArrowLeft />\n            </ActionIcon>\n          </Tooltip>\n        )}\n        <Stepper\n          active={currentStep}\n          onStepClick={(stepIndex: number) => {\n            if (disableManualStepChange) return;\n            onSelectStep(stepIndex);\n          }}\n          iconSize={20}\n          size='xs'\n        >\n          {steps.map((step: string, idx: number) => (\n            <Stepper.Step\n              label={step}\n              key={step}\n              aria-label={`wizard-step-${idx}`}\n              allowStepSelect={canSelectStep(idx)}\n            />\n          ))}\n        </Stepper>\n        {canStepForward ? (\n          !disableManualStepChange && (\n            <Tooltip\n              label={steps[currentStep + 1]}\n              position='top'\n              disabled={!canStepForward}\n            >\n              <ActionIcon\n                variant='transparent'\n                onClick={() => onSelectStep(currentStep + 1)}\n                disabled={!canStepForward || disableManualStepChange}\n              >\n                <IconArrowRight />\n              </ActionIcon>\n            </Tooltip>\n          )\n        ) : (\n          <Tooltip label={t`Complete`} position='top'>\n            <ActionIcon color='green' variant='transparent'>\n              <IconCircleCheck />\n            </ActionIcon>\n          </Tooltip>\n        )}\n      </Group>\n    </Card>\n  );\n}\n\n/**\n * A generic \"wizard\" drawer, for handling multi-step processes.\n */\nexport default function WizardDrawer({\n  title,\n  currentStep,\n  steps,\n  children,\n  opened,\n  onClose,\n  onNextStep,\n  onPreviousStep,\n  disableManualStepChange\n}: {\n  title: string;\n  currentStep: number;\n  steps: string[];\n  children: ReactNode;\n  opened: boolean;\n  onClose: () => void;\n  onNextStep?: () => void;\n  onPreviousStep?: () => void;\n  disableManualStepChange?: boolean;\n}) {\n  const titleBlock: ReactNode = useMemo(() => {\n    return (\n      <Stack gap='xs' style={{ width: '100%' }}>\n        <Group\n          gap='xs'\n          wrap='nowrap'\n          justify='space-between'\n          grow\n          preventGrowOverflow={false}\n        >\n          <StylishText size='xl'>{title}</StylishText>\n          <WizardProgressStepper\n            currentStep={currentStep}\n            steps={steps}\n            disableManualStepChange={disableManualStepChange}\n            onSelectStep={(step: number) => {\n              if (disableManualStepChange) return;\n              if (step < currentStep) {\n                onPreviousStep?.();\n              } else {\n                onNextStep?.();\n              }\n            }}\n          />\n          <Space />\n        </Group>\n        <Divider />\n      </Stack>\n    );\n  }, [title, currentStep, steps]);\n\n  return (\n    <Drawer\n      position='bottom'\n      size={'75%'}\n      title={titleBlock}\n      withCloseButton={true}\n      closeOnEscape={false}\n      closeOnClickOutside={false}\n      styles={{\n        header: {\n          width: '100%'\n        },\n        title: {\n          width: '100%'\n        }\n      }}\n      opened={opened}\n      onClose={onClose}\n    >\n      <Boundary label='wizard-drawer'>{children}</Boundary>\n    </Drawer>\n  );\n}\n","import { Alert, Stack } from '@mantine/core';\nimport { IconExclamationCircle } from '@tabler/icons-react';\nimport {\n  type ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState\n} from 'react';\nimport WizardDrawer from '../components/wizards/WizardDrawer';\n\nexport interface WizardProps {\n  title: string;\n  steps: string[];\n  disableManualStepChange?: boolean;\n  onClose?: () => void;\n  renderStep: (step: number) => ReactNode;\n  canStepForward?: (step: number) => boolean;\n  canStepBackward?: (step: number) => boolean;\n}\n\nexport interface WizardState {\n  opened: boolean;\n  currentStep: number;\n  clearError: () => void;\n  error: string | null;\n  setError: (error: string | null) => void;\n  errorDetail: string | null;\n  setErrorDetail: (errorDetail: string | null) => void;\n  openWizard: () => void;\n  closeWizard: () => void;\n  nextStep: () => void;\n  previousStep: () => void;\n  wizard: ReactNode;\n  setStep: (step: number) => void;\n}\n\n/**\n * Hook for managing a wizard-style multi-step process.\n * - Manage the current step of the wizard\n * - Allows opening and closing the wizard\n * - Handles progression between steps with optional validation\n */\nexport default function useWizard(props: WizardProps): WizardState {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [opened, setOpened] = useState(false);\n\n  const [error, setError] = useState<string | null>(null);\n  const [errorDetail, setErrorDetail] = useState<string | null>(null);\n\n  const clearError = useCallback(() => {\n    setError(null);\n    setErrorDetail(null);\n  }, []);\n\n  // Reset the wizard to an initial state when opened\n  useEffect(() => {\n    if (opened) {\n      setCurrentStep(0);\n      clearError();\n    }\n  }, [opened]);\n\n  // Open the wizard\n  const openWizard = useCallback(() => {\n    setOpened(true);\n  }, []);\n\n  // Close the wizard\n  const closeWizard = useCallback(() => {\n    props.onClose?.();\n    setOpened(false);\n  }, []);\n\n  // Progress the wizard to the next step\n  const nextStep = useCallback(() => {\n    setCurrentStep((c) => {\n      if (props.canStepForward && !props.canStepForward(c)) {\n        return c;\n      }\n      const newStep = Math.min(c + 1, props.steps.length - 1);\n      if (newStep !== c) clearError();\n      return newStep;\n    });\n  }, [props.canStepForward]);\n\n  // Go back to the previous step\n  const previousStep = useCallback(() => {\n    setCurrentStep((c) => {\n      if (props.canStepBackward && !props.canStepBackward(c)) {\n        return c;\n      }\n      const newStep = Math.max(c - 1, 0);\n      if (newStep !== c) clearError();\n      return newStep;\n    });\n  }, [props.canStepBackward]);\n\n  const setStep = useCallback(\n    (step: number) => {\n      if (step < 0 || step >= props.steps.length) {\n        return;\n      }\n      setCurrentStep(step);\n      clearError();\n    },\n    [props.steps.length]\n  );\n\n  // Render the wizard contents for the current step\n  const contents = useMemo(() => {\n    return props.renderStep(currentStep);\n  }, [opened, currentStep, props.renderStep]);\n\n  return {\n    currentStep,\n    opened,\n    clearError,\n    error,\n    setError,\n    errorDetail,\n    setErrorDetail,\n    openWizard,\n    closeWizard,\n    nextStep,\n    previousStep,\n    setStep,\n    wizard: (\n      <WizardDrawer\n        disableManualStepChange={props.disableManualStepChange}\n        title={props.title}\n        currentStep={currentStep}\n        steps={props.steps}\n        opened={opened}\n        onClose={closeWizard}\n        onNextStep={nextStep}\n        onPreviousStep={previousStep}\n      >\n        <Stack gap='xs'>\n          {error && (\n            <Alert color='red' title={error} icon={<IconExclamationCircle />}>\n              {errorDetail}\n            </Alert>\n          )}\n          {contents}\n        </Stack>\n      </WizardDrawer>\n    )\n  };\n}\n","import { ActionButton } from '@lib/components/ActionButton';\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { apiUrl } from '@lib/functions/Api';\nimport { formatDecimal } from '@lib/functions/Formatting';\nimport type { ApiFormFieldSet } from '@lib/types/Forms';\nimport { t } from '@lingui/core/macro';\nimport {\n  ActionIcon,\n  Alert,\n  Divider,\n  Group,\n  HoverCard,\n  Loader,\n  Paper,\n  Stack,\n  Text,\n  Tooltip\n} from '@mantine/core';\nimport { showNotification } from '@mantine/notifications';\nimport {\n  IconExclamationCircle,\n  IconInfoCircle,\n  IconShoppingCart\n} from '@tabler/icons-react';\nimport { DataTable } from 'mantine-datatable';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useSupplierPartFields } from '../../forms/CompanyForms';\nimport { usePurchaseOrderFields } from '../../forms/PurchaseOrderForms';\nimport { useCreateApiFormModal } from '../../hooks/UseForm';\nimport { useInstance } from '../../hooks/UseInstance';\nimport useWizard from '../../hooks/UseWizard';\nimport { RenderPartColumn } from '../../tables/ColumnRenderers';\nimport { CopyButton } from '../buttons/CopyButton';\nimport RemoveRowButton from '../buttons/RemoveRowButton';\nimport { StandaloneField } from '../forms/StandaloneField';\nimport Expand from '../items/Expand';\n\n/**\n * Render the \"requirements\" info for a part\n * This fetches the information dynamically from the API\n */\nfunction PartRequirementsInfo({\n  partId,\n  onQuantityChange\n}: {\n  partId: number | string;\n  onQuantityChange?: (quantity: number) => void;\n}) {\n  const [requiredQuantity, setRequiredQuantity] = useState<number>(0);\n\n  // Notify parent component of quantity change\n  useEffect(() => {\n    onQuantityChange?.(requiredQuantity);\n  }, [requiredQuantity]);\n\n  const requirements = useInstance({\n    endpoint: ApiEndpoints.part_requirements,\n    pk: partId,\n    hasPrimaryKey: true,\n    defaultValue: {}\n  });\n\n  const widget = useMemo(() => {\n    if (\n      requirements.instanceQuery.isFetching ||\n      requirements.instanceQuery.isLoading\n    ) {\n      return <Loader size='sm' />;\n    }\n\n    if (requirements.instanceQuery.isError) {\n      return (\n        <Tooltip label={t`Error fetching part requirements`}>\n          <ActionIcon variant='transparent' color='red'>\n            <IconExclamationCircle />\n          </ActionIcon>\n        </Tooltip>\n      );\n    }\n\n    // Calculate the total requirements\n    const buildRequirements =\n      requirements.instance?.required_for_build_orders || 0;\n    const salesRequirements =\n      requirements.instance?.required_for_sales_orders || 0;\n    const totalRequirements = buildRequirements + salesRequirements;\n\n    const building = requirements.instance?.building || 0;\n    const ordering = requirements.instance?.ordering || 0;\n    const incoming = building + ordering;\n\n    const inStock = requirements.instance?.total_stock || 0;\n\n    const required = Math.max(0, totalRequirements - inStock - incoming);\n\n    setRequiredQuantity(required);\n\n    return (\n      <HoverCard position='bottom-end'>\n        <HoverCard.Target>\n          <ActionIcon\n            variant='transparent'\n            color={required > 0 ? 'blue' : 'green'}\n            size='sm'\n          >\n            <IconInfoCircle />\n          </ActionIcon>\n        </HoverCard.Target>\n        <HoverCard.Dropdown>\n          <Stack gap='xs'>\n            <Text>{t`Requirements`}</Text>\n            <Divider />\n            {buildRequirements > 0 && (\n              <Group justify='space-between'>\n                <Text size='xs'>{t`Build Requirements`}</Text>\n                <Text size='xs'>{formatDecimal(buildRequirements)}</Text>\n              </Group>\n            )}\n            {salesRequirements > 0 && (\n              <Group justify='space-between'>\n                <Text size='xs'>{t`Sales Requirements`}</Text>\n                <Text size='xs'>{formatDecimal(salesRequirements)}</Text>\n              </Group>\n            )}\n            {inStock > 0 && (\n              <Group justify='space-between'>\n                <Text size='xs'>{t`In Stock`}</Text>\n                <Text size='xs'>{formatDecimal(inStock)}</Text>\n              </Group>\n            )}\n            {ordering > 0 && (\n              <Group justify='space-between'>\n                <Text size='xs'>{t`On Order`}</Text>\n                <Text size='xs'>{formatDecimal(ordering)}</Text>\n              </Group>\n            )}\n            {building > 0 && (\n              <Group justify='space-between'>\n                <Text size='xs'>{t`In Production`}</Text>\n                <Text size='xs'>{formatDecimal(building)}</Text>\n              </Group>\n            )}\n            <Group justify='space-between'>\n              <Text size='xs'>{t`Required Quantity`}</Text>\n              <Text size='xs'>{formatDecimal(required)}</Text>\n            </Group>\n          </Stack>\n        </HoverCard.Dropdown>\n      </HoverCard>\n    );\n  }, [\n    requirements.instanceQuery.isFetching,\n    requirements.instanceQuery.isLoading,\n    requirements.instanceQuery.isError,\n    requirements.instance,\n    setRequiredQuantity\n  ]);\n\n  return widget;\n}\n\n/**\n * Attributes for each selected part\n * - part: The part instance\n * - supplier_part: The selected supplier part instance\n * - purchase_order: The selected purchase order instance\n * - quantity: The quantity of the part to order\n * - errors: Error messages for each attribute\n */\ninterface PartOrderRecord {\n  part: any;\n  supplier_part: any;\n  purchase_order: any;\n  quantity: number;\n  errors: any;\n}\n\nfunction SelectPartsStep({\n  records,\n  onRemovePart,\n  onSelectQuantity,\n  onSelectSupplierPart,\n  onSelectPurchaseOrder\n}: {\n  records: PartOrderRecord[];\n  onRemovePart: (part: any) => void;\n  onSelectQuantity: (partId: number, quantity: number) => void;\n  onSelectSupplierPart: (partId: number, supplierPart: any) => void;\n  onSelectPurchaseOrder: (partId: number, purchaseOrder: any) => void;\n}) {\n  const [selectedRecord, setSelectedRecord] = useState<PartOrderRecord | null>(\n    null\n  );\n\n  const purchaseOrderFields = usePurchaseOrderFields({\n    supplierId: selectedRecord?.supplier_part?.supplier\n  });\n\n  const newPurchaseOrder = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.purchase_order_list),\n    title: t`New Purchase Order`,\n    fields: purchaseOrderFields,\n    successMessage: t`Purchase order created`,\n    onFormSuccess: (response: any) => {\n      onSelectPurchaseOrder(selectedRecord?.part.pk, response);\n    }\n  });\n\n  const supplierPartFields = useSupplierPartFields({\n    partId: selectedRecord?.part.pk\n  });\n\n  const newSupplierPart = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.supplier_part_list),\n    title: t`New Supplier Part`,\n    fields: supplierPartFields,\n    successMessage: t`Supplier part created`,\n    onFormSuccess: (response: any) => {\n      onSelectSupplierPart(selectedRecord?.part.pk, response);\n    }\n  });\n\n  const addToOrderFields: ApiFormFieldSet = useMemo(() => {\n    return {\n      order: {\n        value: selectedRecord?.purchase_order?.pk,\n        disabled: true\n      },\n      part: {\n        value: selectedRecord?.supplier_part?.pk,\n        disabled: true\n      },\n      reference: {},\n      quantity: {\n        // TODO: Auto-fill with the desired quantity\n      },\n      purchase_price: {},\n      purchase_price_currency: {},\n      merge_items: {}\n    };\n  }, [selectedRecord]);\n\n  const addToOrder = useCreateApiFormModal({\n    url: apiUrl(ApiEndpoints.purchase_order_line_list),\n    title: t`Add to Purchase Order`,\n    fields: addToOrderFields,\n    focus: 'quantity',\n    initialData: {\n      order: selectedRecord?.purchase_order?.pk,\n      part: selectedRecord?.supplier_part?.pk,\n      quantity: selectedRecord?.quantity\n    },\n    onFormSuccess: (response: any) => {\n      // Remove the row from the list\n      onRemovePart(selectedRecord?.part);\n    },\n    successMessage: t`Part added to purchase order`\n  });\n\n  const columns: any[] = useMemo(() => {\n    return [\n      {\n        accessor: 'left_actions',\n        title: ' ',\n        width: '1%',\n        render: (record: PartOrderRecord) => (\n          <Group gap='xs' wrap='nowrap' justify='left'>\n            <RemoveRowButton\n              tooltipAlignment={'top-start'}\n              onClick={() => onRemovePart(record.part)}\n            />\n          </Group>\n        )\n      },\n      {\n        accessor: 'part',\n        title: t`Part`,\n        render: (record: PartOrderRecord) => (\n          <Tooltip label={record.part?.description}>\n            <Paper p='xs'>\n              <RenderPartColumn part={record.part} />\n            </Paper>\n          </Tooltip>\n        )\n      },\n      {\n        accessor: 'supplier_part',\n        title: t`Supplier Part`,\n        width: '40%',\n        render: (record: PartOrderRecord) => (\n          <Group gap='xs' wrap='nowrap' justify='left'>\n            <Expand>\n              <StandaloneField\n                fieldName='supplier_part'\n                hideLabels={true}\n                error={record.errors?.supplier_part}\n                fieldDefinition={{\n                  field_type: 'related field',\n                  api_url: apiUrl(ApiEndpoints.supplier_part_list),\n                  model: ModelType.supplierpart,\n                  placeholder: t`Select supplier part`,\n                  required: true,\n                  autoFill: true,\n                  value: record.supplier_part?.pk,\n                  onValueChange: (value, instance) => {\n                    onSelectSupplierPart(record.part.pk, instance);\n                  },\n                  filters: {\n                    part: record.part.pk,\n                    active: true,\n                    part_detail: true,\n                    supplier_detail: true\n                  }\n                }}\n              />\n            </Expand>\n            <CopyButton\n              disabled={!record.supplier_part?.pk}\n              value={record.supplier_part?.SKU}\n              tooltipPosition='top-end'\n              tooltip={t`Copy supplier part number`}\n            />\n            <AddItemButton\n              tooltip={t`New supplier part`}\n              tooltipAlignment='top-end'\n              onClick={() => {\n                setSelectedRecord(record);\n                newSupplierPart.open();\n              }}\n            />\n          </Group>\n        )\n      },\n      {\n        accessor: 'purchase_order',\n        title: t`Purchase Order`,\n        width: '40%',\n        render: (record: PartOrderRecord) => (\n          <Group gap='xs' wrap='nowrap' justify='left'>\n            <Expand>\n              <StandaloneField\n                fieldName='purchase_order'\n                hideLabels={true}\n                fieldDefinition={{\n                  field_type: 'related field',\n                  api_url: apiUrl(ApiEndpoints.purchase_order_list),\n                  model: ModelType.purchaseorder,\n                  placeholder: t`Select purchase order`,\n                  disabled: !record.supplier_part?.supplier,\n                  value: record.purchase_order?.pk,\n                  filters: {\n                    supplier: record.supplier_part?.supplier,\n                    outstanding: true\n                  },\n                  onValueChange: (value, instance) => {\n                    onSelectPurchaseOrder(record.part.pk, instance);\n                  }\n                }}\n              />\n            </Expand>\n            <AddItemButton\n              tooltip={t`New purchase order`}\n              tooltipAlignment='top-end'\n              disabled={!record.supplier_part?.pk}\n              onClick={() => {\n                setSelectedRecord(record);\n                newPurchaseOrder.open();\n              }}\n            />\n          </Group>\n        )\n      },\n      {\n        accessor: 'quantity',\n        title: t`Quantity`,\n        width: 150,\n        render: (record: PartOrderRecord) => (\n          <Group gap='xs' wrap='nowrap'>\n            <StandaloneField\n              fieldName='quantity'\n              hideLabels={true}\n              error={record.errors?.quantity}\n              fieldDefinition={{\n                field_type: 'number',\n                required: true,\n                value: record.quantity,\n                onValueChange: (value) => {\n                  onSelectQuantity(record.part.pk, value);\n                }\n              }}\n            />\n            <PartRequirementsInfo\n              partId={record.part.pk}\n              onQuantityChange={(quantity: number) =>\n                onSelectQuantity(record.part.pk, quantity)\n              }\n            />\n          </Group>\n        )\n      },\n      {\n        accessor: 'right_actions',\n        title: ' ',\n        width: '1%',\n        render: (record: PartOrderRecord) => (\n          <Group grow gap='xs' wrap='nowrap' justify='right'>\n            <ActionButton\n              onClick={() => {\n                setSelectedRecord(record);\n                addToOrder.open();\n              }}\n              disabled={\n                !record.supplier_part?.pk ||\n                !record.quantity ||\n                !record.purchase_order?.pk\n              }\n              icon={<IconShoppingCart />}\n              tooltip={t`Add to selected purchase order`}\n              tooltipAlignment='top-end'\n              color='blue'\n            />\n          </Group>\n        )\n      }\n    ];\n  }, [onRemovePart]);\n\n  if (records.length === 0) {\n    return (\n      <Alert color='red' title={t`No parts selected`}>\n        {t`No purchaseable parts selected`}\n      </Alert>\n    );\n  }\n\n  return (\n    <>\n      <DataTable idAccessor='part.pk' columns={columns} records={records} />\n      {newPurchaseOrder.modal}\n      {newSupplierPart.modal}\n      {addToOrder.modal}\n    </>\n  );\n}\n\nexport default function OrderPartsWizard({\n  parts\n}: {\n  parts: any[];\n}) {\n  // Track a list of selected parts\n  const [selectedParts, setSelectedParts] = useState<PartOrderRecord[]>([]);\n\n  // Remove a part from the selected parts list\n  const removePart = useCallback(\n    (part: any) => {\n      const records = selectedParts.filter(\n        (record: PartOrderRecord) => record.part?.pk !== part.pk\n      );\n\n      setSelectedParts(records);\n\n      // If no parts remain, close the wizard\n      if (records.length === 0) {\n        wizard.closeWizard();\n        showNotification({\n          title: t`Parts Added`,\n          message: t`All selected parts added to a purchase order`,\n          color: 'green'\n        });\n      }\n    },\n    [selectedParts]\n  );\n\n  // Select a quantity to order\n  const selectQuantity = useCallback(\n    (partId: number, quantity: number) => {\n      const records = [...selectedParts];\n\n      records.forEach((record: PartOrderRecord, index: number) => {\n        if (record.part.pk === partId) {\n          records[index].quantity = quantity;\n        }\n      });\n\n      setSelectedParts(records);\n    },\n    [selectedParts]\n  );\n\n  // Select a supplier part for a part\n  const selectSupplierPart = useCallback(\n    (partId: number, supplierPart: any) => {\n      const records = [...selectedParts];\n\n      records.forEach((record: PartOrderRecord, index: number) => {\n        if (record.part.pk === partId) {\n          records[index].supplier_part = supplierPart;\n        }\n      });\n\n      setSelectedParts(records);\n    },\n    [selectedParts]\n  );\n\n  // Select purchase order for a part\n  const selectPurchaseOrder = useCallback(\n    (partId: number, purchaseOrder: any) => {\n      const records = [...selectedParts];\n\n      records.forEach((record: PartOrderRecord, index: number) => {\n        if (record.part.pk === partId) {\n          records[index].purchase_order = purchaseOrder;\n        }\n      });\n\n      setSelectedParts(records);\n    },\n    [selectedParts]\n  );\n\n  // Render the select wizard step\n  const renderStep = useCallback(\n    (step: number) => {\n      return (\n        <SelectPartsStep\n          records={selectedParts}\n          onRemovePart={removePart}\n          onSelectQuantity={selectQuantity}\n          onSelectSupplierPart={selectSupplierPart}\n          onSelectPurchaseOrder={selectPurchaseOrder}\n        />\n      );\n    },\n    [selectedParts]\n  );\n\n  const canStepForward = useCallback(\n    (step: number): boolean => {\n      if (!selectedParts?.length) {\n        wizard.setError(t`No parts selected`);\n        wizard.setErrorDetail(t`You must select at least one part to order`);\n        return false;\n      }\n\n      let result = true;\n      const records = [...selectedParts];\n\n      // Check for errors in each part\n      selectedParts.forEach((record: PartOrderRecord, index: number) => {\n        records[index].errors = {\n          supplier_part: !record.supplier_part\n            ? t`Supplier part is required`\n            : null,\n          quantity:\n            !record.quantity || record.quantity <= 0\n              ? t`Quantity is required`\n              : null\n        };\n\n        // If any errors are found, set the result to false\n        if (Object.values(records[index].errors).some((error) => error)) {\n          result = false;\n        }\n      });\n\n      setSelectedParts(records);\n\n      if (!result) {\n        wizard.setError(t`Invalid part selection`);\n        wizard.setErrorDetail(\n          t`Please correct the errors in the selected parts`\n        );\n      }\n\n      return result;\n    },\n    [selectedParts]\n  );\n\n  // Create the wizard manager\n  const wizard = useWizard({\n    title: t`Order Parts`,\n    steps: [],\n    renderStep: renderStep,\n    canStepForward: canStepForward\n  });\n\n  // Reset the wizard to a known state when opened\n  useEffect(() => {\n    const records: PartOrderRecord[] = [];\n\n    if (wizard.opened) {\n      parts\n        .filter((part) => part.purchaseable && part.active)\n        .forEach((part) => {\n          // Prevent duplicate entries based on pk\n          if (\n            !records.find(\n              (record: PartOrderRecord) => record.part?.pk === part.pk\n            )\n          ) {\n            // TODO: Make this calculation generic and reusable\n            // Calculate the \"to order\" quantity\n            const required =\n              (part.minimum_stock ?? 0) +\n              (part.required_for_build_orders ?? 0) +\n              (part.required_for_sales_orders ?? 0);\n            const on_hand = part.total_in_stock ?? 0;\n            const on_order = part.ordering ?? 0;\n            const in_production = part.building ?? 0;\n\n            const to_order = required - on_hand - on_order - in_production;\n\n            records.push({\n              part: part,\n              supplier_part: undefined,\n              purchase_order: undefined,\n              quantity: Math.max(to_order, 0),\n              errors: {}\n            });\n          }\n        });\n\n      setSelectedParts(records);\n    } else {\n      setSelectedParts([]);\n    }\n  }, [wizard.opened]);\n\n  return wizard;\n}\n"],"names":["__iconNode","IconArrowLeft","createReactComponent","usePurchaseOrderLineItemFields","supplierId","orderId","currency","create","globalSettings","useGlobalSettingsState","purchasePrice","setPurchasePrice","useState","purchasePriceCurrency","setPurchasePriceCurrency","autoPricing","setAutoPricing","quantity","setQuantity","part","setPart","priceBreaks","setPriceBreaks","suggestedPurchasePrice","setSuggestedPurchasePrice","undefined","useEffect","qty","toNumber","length","applicablePriceBreaks","filter","pb","sort","a","b","price","useMemo","fields","order","filters","supplier_detail","disabled","part_detail","active","part_active","price_breaks","onValueChange","value","record","adjustFilters","adjust","supplier","reference","purchase_price","icon","IconCurrencyDollar","placeholder","placeholderAutofill","purchase_price_currency","IconCoins","auto_pricing","project_code","description","_i18n","_","id","target_date","IconCalendar","destination","IconSitemap","build_order","assembly","external","outstanding","pk","notes","IconNotes","link","IconLink","isSet","usePurchaseOrderFields","duplicateOrderId","IconHash","is_supplier","supplier_reference","IconList","order_currency","start_date","structural","contact","IconUser","company","data","address","IconAddressBook","responsible","is_active","IconUsers","duplicate","children","order_id","hidden","copy_lines","copy_extra_lines","LineItemFormRow","props","statuses","opened","open","close","useDisclosure","onClose","changeFn","idx","locationOpen","locationHandlers","trackable","settings","batchCodeGenerator","useBatchCodeGenerator","isEnabled","batchOpen","onGenerate","serialNumberGenerator","useSerialNumberGenerator","packagingOpen","packagingHandlers","noteOpen","noteHandlers","batchHandlers","onOpen","update","supplier_part_detail","item","expiryDateOpen","expiryDateHandlers","defaultExpiry","default_expiry","dayjs","add","format","statusOpen","statusHandlers","barcodeInput","setBarcodeInput","barcode","setBarcode","batchToolTip","timeoutId","setTimeout","clearTimeout","locationDescription","text","location","destination_detail","category_default_location","received","default_location","jsxs","Fragment","jsx","Modal","StylishText","FocusTrap","TextInput","e","target","Table","Flex","Thumbnail","thumbnail","name","SKU","ProgressBar","whiteSpace","StandaloneField","field_type","rowErrors","message","width","ActionButton","toggle","InvenTreeIcon","IconCalendarExclamation","RemoveRowButton","removeFn","Group","Container","model","ModelType","stocklocation","api_url","apiUrl","ApiEndpoints","stock_location_list","label","marginBottom","TableFieldExtraRow","batch_code","serial_numbers","expiry_date","packaging","stock_status","choices","status","note","useReceiveLineItems","stockStatusCodes","getStatusCodeOptions","stockitem","records","Object","fromEntries","items","map","filteredItems","elem","orderPk","line_item","modelRenderer","row","headers","title","style","minWidth","useCreateApiFormModal","formProps","url","purchase_order_receive","initialData","destinationPk","size","successMessage","WizardProgressStepper","currentStep","steps","onSelectStep","disableManualStepChange","canSelectStep","useCallback","step","Math","abs","canStepBackward","canStepForward","Card","Tooltip","ActionIcon","Stepper","stepIndex","IconArrowRight","IconCircleCheck","WizardDrawer","onNextStep","onPreviousStep","titleBlock","Stack","Space","Divider","Drawer","header","Boundary","useWizard","setCurrentStep","setOpened","error","setError","errorDetail","setErrorDetail","clearError","openWizard","closeWizard","nextStep","c","newStep","min","previousStep","max","setStep","contents","renderStep","wizard","Alert","IconExclamationCircle","PartRequirementsInfo","partId","onQuantityChange","requiredQuantity","setRequiredQuantity","requirements","useInstance","endpoint","part_requirements","hasPrimaryKey","defaultValue","instanceQuery","isFetching","isLoading","Loader","isError","buildRequirements","instance","required_for_build_orders","salesRequirements","required_for_sales_orders","totalRequirements","building","ordering","incoming","inStock","total_stock","required","HoverCard","IconInfoCircle","Text","formatDecimal","SelectPartsStep","onRemovePart","onSelectQuantity","onSelectSupplierPart","onSelectPurchaseOrder","selectedRecord","setSelectedRecord","purchaseOrderFields","supplier_part","newPurchaseOrder","purchase_order_list","onFormSuccess","response","supplierPartFields","useSupplierPartFields","newSupplierPart","supplier_part_list","addToOrderFields","purchase_order","merge_items","addToOrder","purchase_order_line_list","focus","columns","accessor","render","Paper","RenderPartColumn","Expand","errors","supplierpart","autoFill","CopyButton","AddItemButton","purchaseorder","IconShoppingCart","DataTable","modal","OrderPartsWizard","parts","selectedParts","setSelectedParts","removePart","showNotification","color","selectQuantity","forEach","index","selectSupplierPart","supplierPart","selectPurchaseOrder","purchaseOrder","result","values","some","purchaseable","find","minimum_stock","on_hand","total_in_stock","on_order","in_production","to_order","push"],"mappings":"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","x_google_ignoreList":[0]}