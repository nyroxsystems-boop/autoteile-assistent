import{r as s,ab as e,j as t,ao as c,bb as i,ag as S,N as h,aa as N,b1 as _,an as E,b4 as K,d as q,aD as A,S as B,ap as G}from"./index-Db7AGPIq.js";import{A as O}from"./AdminButton-BR7cWvGK.js";import{S as U}from"./StarredToggleButton-CDXkiThv.js";import{I as V,D as T,a as L}from"./InstanceDetail-CF-uHhEW.js";import{u as Q,A as Z,R as Y,I as W,O as H,E as J,D as X}from"./InvenTreeTable-DmN557zY.js";import{A as j,a as z,b as v,e as $,d as ee,c as te}from"./Filter-BgnAqEQC.js";import{N as ae}from"./NavigationTree-D8kcQU6q.js";import{P as oe}from"./PageDetail-Bm50kpyR.js";import{P as re}from"./PanelGroup-Bif3iIGQ.js";import{P as se,S as ie,I as ne}from"./ParametricDataTable-DArALdrx.js";import{p as P}from"./ImportPartWizard-DE8Rg4Ga.js";import{u as le}from"./UseInstance-BPJQEWDW.js";import{P as ce,D}from"./ColumnRenderers-BUH0stTX.js";import{Y as de}from"./YesNoButton-BaVgP5u9.js";import{A as pe,t as w,E as me,a as ue,P as _e,r as ge,U as be,V as ye,G as fe}from"./ThemeContext-CxdCkKtz.js";import xe from"./PartCategoryTemplateTable-BrMqqGec.js";import{P as he}from"./PartTable-Bj-hT2fm.js";import{S as je}from"./StockItemTable-CHHhSxX_.js";import{I as ke}from"./IconCategory-0YVN1Q-i.js";import{I as Ie}from"./IconListCheck-Bp3Z6623.js";import"./ActionButton-Cv5j5I5R.js";import"./DesktopAppView-BuH2j218.js";import"./index-DRtKJP-e.js";import"./formatters-B4ehJgEk.js";import"./ModelType-DSs66IM7.js";import"./GenericErrorPage-D-1fKCA7.js";import"./NotFound-CsJ_VLc_.js";import"./PermissionDenied-BDbEipg4.js";import"./IconChevronDown-CzbIU38Y.js";import"./QRCode-BaIEIQ2d.js";import"./browser-DSycY7kT.js";import"./IconDotsVertical-D8D3XsjG.js";import"./IconTags-DnGx22aA.js";import"./IconChevronRight-V14UdNcU.js";import"./PageTitle-B4iaHXKM.js";import"./PluginUIFeature-DCu8wTdG.js";import"./RemoteComponent-uZoHDwds.js";import"./CommonForms-DKQecQmS.js";import"./IconUsers-Dr_Sln9A.js";import"./use-hover-Cq0v4QX_.js";import"./OrderPartsWizard-BcMgRjfh.js";import"./CompanyForms-CIJgkbDe.js";import"./IconAt-rYwKGkPn.js";import"./IconAddressBook-CdNRMeyy.js";import"./ImporterForms-D2fp0CPO.js";import"./IconCircleDashedCheck-DnGBn8Eq.js";import"./UsePlugins-BAQCKs7Q.js";import"./UseStockAdjustActions-BrgagWbF.js";function Ce({categoryId:l}){const o=s.useMemo(()=>[{name:"active",label:e._({id:"F6pfE9"}),description:e._({id:"xqUGVc"})},{name:"locked",label:e._({id:"G2fuEb"}),description:e._({id:"tB/dWJ"})},{name:"assembly",label:e._({id:"WL36Yh"}),description:e._({id:"IxF0Eq"})}],[]),n=s.useMemo(()=>[ce({part:"",switchable:!1}),D({defaultVisible:!1}),{accessor:"IPN",sortable:!0,defaultVisible:!1},{accessor:"total_in_stock",sortable:!0}],[]);return t.jsx(se,{modelType:i.part,endpoint:c.part_list,customColumns:n,customFilters:o,queryParams:{category:l,cascade:!0,category_detail:!0}})}function Pe({parentId:l}){const o=Q("partcategory"),n=S(),d=s.useMemo(()=>[{accessor:"name",sortable:!0,switchable:!1,render:r=>t.jsxs(h,{gap:"xs",wrap:"nowrap",justify:"space-between",children:[t.jsxs(h,{gap:"xs",wrap:"nowrap",children:[r.icon&&t.jsx(j,{name:r.icon}),r.name]}),t.jsx(h,{gap:"xs",justify:"flex-end",wrap:"nowrap",children:r.starred&&t.jsx(N,{label:e._({id:"mUyvRx"}),children:t.jsx(pe,{color:"green",size:16})})})]})},D({}),{accessor:"pathstring",sortable:!1},{accessor:"structural",sortable:!0,defaultVisible:!1,render:r=>t.jsx(de,{value:r.structural})},{accessor:"part_count",sortable:!0}],[]),k=s.useMemo(()=>[{name:"cascade",label:e._({id:"NgZniC"}),description:e._({id:"Tt3/Pp"})},{name:"structural",label:e._({id:"PRKZBP"}),description:e._({id:"kHkg2b"})},{name:"starred",label:e._({id:"7VIaU3"}),description:e._({id:"mcDc03"})}],[]),f=P({create:!0}),a=z({url:c.category_list,title:e._({id:"sIMwJx"}),fields:f,focus:"name",initialData:{parent:l},follow:!0,modelType:i.partcategory,table:o}),[g,p]=s.useState(-1),I=P({create:!1}),m=v({url:c.category_list,pk:g,title:e._({id:"7fjpj0"}),fields:I,onFormSuccess:r=>o.updateRecord(r)}),b=$({url:c.category_list,items:o.selectedIds,title:e._({id:"H52WlQ"}),fields:{parent:{}},onFormSuccess:o.refreshTable}),x=s.useMemo(()=>{const r=n.hasAddRole(_.part_category),y=n.hasChangeRole(_.part_category);return[t.jsx(Z,{tooltip:e._({id:"O/o81A"}),icon:t.jsx(w,{icon:"category"}),disabled:!o.hasSelectedRecords,actions:[{name:e._({id:"OORNPU"}),icon:t.jsx(w,{icon:"category"}),tooltip:e._({id:"rB20aK"}),hidden:!y,disabled:!o.hasSelectedRecords,onClick:()=>{b.open()}}]}),t.jsx(ee,{tooltip:e._({id:"5LuNgu"}),onClick:()=>a.open(),hidden:!r},"add-part-category")]},[n,o.hasSelectedRecords]),C=s.useCallback(r=>{const y=n.hasChangeRole(_.part_category);return[Y({hidden:!y,onClick:()=>{p(r.pk),m.open()}})]},[n]);return t.jsxs(t.Fragment,{children:[a.modal,m.modal,b.modal,t.jsx(W,{url:E(c.category_list),tableState:o,columns:d,props:{enableDownload:!0,enableSelection:!0,params:{parent:l,top_level:l===void 0?!0:void 0},tableFilters:k,tableActions:x,rowActions:C,modelType:i.partcategory}})]})}function ht(){const{id:l}=me(),o=s.useMemo(()=>Number.isNaN(Number.parseInt(l||""))?void 0:l,[l]),n=ue(),d=S(),[k,f]=s.useState(!1),{instance:a,refreshInstance:g,instanceQuery:p}=le({endpoint:c.category_list,hasPrimaryKey:!0,pk:o,params:{path_detail:!0}}),I=s.useMemo(()=>{if(o&&p.isFetching)return t.jsx(K,{});const u=[{type:"text",name:"name",label:e._({id:"6YtxFj"}),copy:!0,value_formatter:()=>t.jsxs(h,{gap:"xs",children:[a.icon&&t.jsx(j,{name:a.icon}),a.name]})},{type:"text",name:"pathstring",label:e._({id:"I6gXOa"}),icon:"sitemap",copy:!0,hidden:!o},{type:"text",name:"description",label:e._({id:"Nu4oKW"}),copy:!0},{type:"link",name:"parent",model_field:"name",icon:"location",label:e._({id:"o8hZ41"}),model:i.partcategory,hidden:!a?.parent},{type:"boolean",name:"starred",icon:"notification",label:e._({id:"7VIaU3"})}],M=[{type:"text",name:"part_count",label:e._({id:"pmRbKZ"}),icon:"part",value_formatter:()=>a?.part_count||"0"},{type:"text",name:"subcategories",label:e._({id:"7lonqg"}),icon:"sitemap",hidden:!a?.subcategories},{type:"boolean",name:"structural",label:e._({id:"PRKZBP"}),icon:"sitemap"},{type:"link",name:"parent_default_location",label:e._({id:"XLVNTv"}),model:i.stocklocation,hidden:!a.parent_default_location||a.default_location},{type:"link",name:"default_location",label:e._({id:"QC5Msb"}),model:i.stocklocation,hidden:!a.default_location}];return t.jsxs(V,{children:[o&&a?.pk?t.jsx(T,{item:a,fields:u}):t.jsx(q,{children:e._({id:"PFKWrQ"})}),o&&a?.pk&&t.jsx(T,{item:a,fields:M})]})},[a,p]),m=v({url:c.category_list,pk:o,title:e._({id:"7fjpj0"}),fields:P({}),onFormSuccess:g}),b=s.useMemo(()=>[{value:"false",display_name:e._({id:"y6iD6w"})},{value:"true",display_name:e._({id:"lzGbCT"})}],[]),x=te({url:c.category_list,pk:o,title:e._({id:"2tjyh5"}),fields:{delete_parts:{label:e._({id:"PJYQQn"}),description:e._({id:"ZqK0DP"}),choices:b,required:!0,field_type:"choice"},delete_child_categories:{label:e._({id:"QgH9YK"}),description:e._({id:"ISGGrw"}),choices:b,required:!0,field_type:"choice"}},onFormSuccess:()=>{a.parent?n(A(i.partcategory,a.parent)):n("/part/")}}),C=s.useMemo(()=>[t.jsx(O,{model:i.partcategory,id:a.pk},"admin"),t.jsx(U,{instance:a,model:i.partcategory,successFunction:()=>{g()}},"starred_change"),t.jsx(H,{tooltip:e._({id:"O/o81A"}),actions:[J({hidden:!o||!d.hasChangeRole(_.part_category),tooltip:e._({id:"7fjpj0"}),onClick:()=>m.open()}),X({hidden:!o||!d.hasDeleteRole(_.part_category),tooltip:e._({id:"2tjyh5"}),onClick:()=>x.open()})]},"category-actions")],[o,d,a.pk,a.starred]),[r,y]=_e({key:"category-parts-view",defaultValue:"table"}),F=s.useMemo(()=>[{name:"details",label:e._({id:"wp9B4i"}),icon:t.jsx(ge,{}),content:I},{name:"subcategories",label:o?e._({id:"7lonqg"}):e._({id:"2GkbLI"}),icon:t.jsx(be,{}),content:t.jsx(Pe,{parentId:o})},ie({name:"parts",label:e._({id:"pmRbKZ"}),icon:t.jsx(ke,{}),selection:r,onChange:y,options:[{value:"table",label:e._({id:"8x9Qq9"}),icon:t.jsx(ne,{}),content:t.jsx(he,{props:{params:{category:o}}})},{value:"parametric",label:e._({id:"78yypk"}),icon:t.jsx(ye,{}),content:t.jsx(Ce,{categoryId:o})}]}),{name:"stockitem",label:e._({id:"Jbck4N"}),icon:t.jsx(fe,{}),hidden:!o,content:t.jsx(je,{params:{category:o},allowAdd:!1,tableName:"category-stockitems"})},{name:"category_parameters",label:e._({id:"6r/kUX"}),icon:t.jsx(Ie,{}),hidden:!o||!a.pk,content:t.jsx(xe,{categoryId:a?.pk})}],[a,o,r]),R=s.useMemo(()=>[{name:e._({id:"pmRbKZ"}),url:"/part"},...(a.path??[]).map(u=>({name:u.name,url:A(i.partcategory,u.pk),icon:u.icon?t.jsx(j,{name:u.icon}):void 0}))],[a]);return t.jsxs(t.Fragment,{children:[m.modal,x.modal,t.jsx(L,{query:p,requiredRole:_.part_category,children:t.jsxs(B,{gap:"xs",children:[t.jsx(G,{visible:p.isFetching}),t.jsx(ae,{modelType:i.partcategory,title:e._({id:"2GkbLI"}),endpoint:c.category_tree,opened:k,onClose:()=>{f(!1)},selectedId:a?.pk}),t.jsx(oe,{title:a?.name??o?e._({id:"QXANxH"}):e._({id:"pmRbKZ"}),subtitle:a?.description,icon:a?.icon&&t.jsx(j,{name:a?.icon}),breadcrumbs:R,breadcrumbAction:()=>{f(!0)},actions:C,editAction:m.open,editEnabled:!!a?.pk&&d.hasChangePermission(i.partcategory)}),t.jsx(re,{pageKey:"partcategory",panels:F,model:i.partcategory,instance:a,reloadInstance:g,id:a.pk??null})]})})]})}export{ht as default};
//# sourceMappingURL=CategoryDetail-h_mJMFSQ.js.map
