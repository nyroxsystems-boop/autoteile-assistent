{"version":3,"file":"SalesIndex-CMycY0KZ.js","sources":["../../../../../../frontend/src/tables/sales/ReturnOrderParametricTable.tsx","../../../../../../frontend/src/tables/sales/SalesOrderParametricTable.tsx","../../../../../../frontend/src/pages/sales/SalesIndex.tsx"],"sourcesContent":["import { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { t } from '@lingui/core/macro';\nimport { type ReactNode, useMemo } from 'react';\nimport {\n  CompanyColumn,\n  DescriptionColumn,\n  ReferenceColumn\n} from '../ColumnRenderers';\nimport {\n  AssignedToMeFilter,\n  OrderStatusFilter,\n  OutstandingFilter,\n  OverdueFilter,\n  ProjectCodeFilter,\n  ResponsibleFilter\n} from '../Filter';\nimport ParametricDataTable from '../general/ParametricDataTable';\n\nexport default function ReturnOrderParametricTable({\n  queryParams\n}: {\n  queryParams?: Record<string, any>;\n}): ReactNode {\n  const customColumns: TableColumn[] = useMemo(() => {\n    return [\n      ReferenceColumn({ switchable: false }),\n      {\n        accessor: 'customer__name',\n        title: t`Customer`,\n        sortable: true,\n        render: (record: any) => (\n          <CompanyColumn company={record.customer_detail} />\n        )\n      },\n      DescriptionColumn({})\n    ];\n  }, []);\n\n  const customFilters: TableFilter[] = useMemo(() => {\n    return [\n      OrderStatusFilter({ model: ModelType.returnorder }),\n      OutstandingFilter(),\n      OverdueFilter(),\n      AssignedToMeFilter(),\n      ProjectCodeFilter(),\n      ResponsibleFilter()\n    ];\n  }, []);\n\n  return (\n    <ParametricDataTable\n      modelType={ModelType.returnorder}\n      endpoint={ApiEndpoints.return_order_list}\n      customColumns={customColumns}\n      customFilters={customFilters}\n      queryParams={{\n        ...queryParams,\n        customer_detail: true\n      }}\n    />\n  );\n}\n","import { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { t } from '@lingui/core/macro';\nimport { type ReactNode, useMemo } from 'react';\nimport {\n  CompanyColumn,\n  DescriptionColumn,\n  ReferenceColumn\n} from '../ColumnRenderers';\nimport {\n  AssignedToMeFilter,\n  OrderStatusFilter,\n  OutstandingFilter,\n  OverdueFilter,\n  ProjectCodeFilter,\n  ResponsibleFilter\n} from '../Filter';\nimport ParametricDataTable from '../general/ParametricDataTable';\n\nexport default function SalesOrderParametricTable({\n  queryParams\n}: {\n  queryParams?: Record<string, any>;\n}): ReactNode {\n  const customColumns: TableColumn[] = useMemo(() => {\n    return [\n      ReferenceColumn({ switchable: false }),\n      {\n        accessor: 'customer__name',\n        title: t`Customer`,\n        sortable: true,\n        render: (record: any) => (\n          <CompanyColumn company={record.customer_detail} />\n        )\n      },\n      DescriptionColumn({})\n    ];\n  }, []);\n\n  const customFilters: TableFilter[] = useMemo(() => {\n    return [\n      OrderStatusFilter({ model: ModelType.salesorder }),\n      OutstandingFilter(),\n      OverdueFilter(),\n      AssignedToMeFilter(),\n      ProjectCodeFilter(),\n      ResponsibleFilter()\n    ];\n  }, []);\n\n  return (\n    <ParametricDataTable\n      modelType={ModelType.salesorder}\n      endpoint={ApiEndpoints.sales_order_list}\n      customColumns={customColumns}\n      customFilters={customFilters}\n      queryParams={{\n        ...queryParams,\n        customer_detail: true\n      }}\n    />\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Stack } from '@mantine/core';\nimport {\n  IconBuildingStore,\n  IconCalendar,\n  IconCubeSend,\n  IconListDetails,\n  IconTable,\n  IconTruckDelivery,\n  IconTruckReturn\n} from '@tabler/icons-react';\nimport { useMemo } from 'react';\n\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { useLocalStorage } from '@mantine/hooks';\nimport OrderCalendar from '../../components/calendar/OrderCalendar';\nimport PermissionDenied from '../../components/errors/PermissionDenied';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport SegmentedControlPanel from '../../components/panels/SegmentedControlPanel';\nimport { useUserState } from '../../states/UserState';\nimport { CompanyTable } from '../../tables/company/CompanyTable';\nimport ParametricCompanyTable from '../../tables/company/ParametricCompanyTable';\nimport ReturnOrderParametricTable from '../../tables/sales/ReturnOrderParametricTable';\nimport { ReturnOrderTable } from '../../tables/sales/ReturnOrderTable';\nimport SalesOrderParametricTable from '../../tables/sales/SalesOrderParametricTable';\nimport SalesOrderShipmentTable from '../../tables/sales/SalesOrderShipmentTable';\nimport { SalesOrderTable } from '../../tables/sales/SalesOrderTable';\n\nexport default function SalesIndex() {\n  const user = useUserState();\n\n  const [customersView, setCustomersView] = useLocalStorage<string>({\n    key: 'customer-view',\n    defaultValue: 'table'\n  });\n\n  const [salesOrderView, setSalesOrderView] = useLocalStorage<string>({\n    key: 'sales-order-view',\n    defaultValue: 'table'\n  });\n\n  const [returnOrderView, setReturnOrderView] = useLocalStorage<string>({\n    key: 'return-order-view',\n    defaultValue: 'table'\n  });\n\n  const panels = useMemo(() => {\n    return [\n      SegmentedControlPanel({\n        name: 'salesorders',\n        label: t`Sales Orders`,\n        icon: <IconTruckDelivery />,\n        hidden: !user.hasViewRole(UserRoles.sales_order),\n        selection: salesOrderView,\n        onChange: setSalesOrderView,\n        options: [\n          {\n            value: 'table',\n            label: t`Table View`,\n            icon: <IconTable />,\n            content: <SalesOrderTable />\n          },\n          {\n            value: 'calendar',\n            label: t`Calendar View`,\n            icon: <IconCalendar />,\n            content: (\n              <OrderCalendar\n                model={ModelType.returnorder}\n                role={UserRoles.return_order}\n                params={{ outstanding: true }}\n              />\n            )\n          },\n          {\n            value: 'parametric',\n            label: t`Parametric View`,\n            icon: <IconListDetails />,\n            content: <SalesOrderParametricTable />\n          }\n        ]\n      }),\n      {\n        name: 'shipments',\n        label: t`Pending Shipments`,\n        icon: <IconCubeSend />,\n        content: (\n          <SalesOrderShipmentTable\n            tableName={'sales-order-pending-shipment'}\n            showOrderInfo\n            filters={{ shipped: false, order_outstanding: true }}\n          />\n        )\n      },\n      SegmentedControlPanel({\n        name: 'returnorders',\n        label: t`Return Orders`,\n        icon: <IconTruckReturn />,\n        hidden: !user.hasViewRole(UserRoles.return_order),\n        selection: returnOrderView,\n        onChange: setReturnOrderView,\n        options: [\n          {\n            value: 'table',\n            label: t`Table View`,\n            icon: <IconTable />,\n            content: <ReturnOrderTable />\n          },\n          {\n            value: 'calendar',\n            label: t`Calendar View`,\n            icon: <IconCalendar />,\n            content: (\n              <OrderCalendar\n                model={ModelType.returnorder}\n                role={UserRoles.return_order}\n                params={{ outstanding: true }}\n              />\n            )\n          },\n          {\n            value: 'parametric',\n            label: t`Parametric View`,\n            icon: <IconListDetails />,\n            content: <ReturnOrderParametricTable />\n          }\n        ]\n      }),\n      SegmentedControlPanel({\n        name: 'customers',\n        label: t`Customers`,\n        icon: <IconBuildingStore />,\n        selection: customersView,\n        onChange: setCustomersView,\n        options: [\n          {\n            value: 'table',\n            label: t`Table View`,\n            icon: <IconTable />,\n            content: (\n              <CompanyTable\n                path='sales/customer'\n                params={{ is_customer: true }}\n              />\n            )\n          },\n          {\n            value: 'parametric',\n            label: t`Parametric View`,\n            icon: <IconListDetails />,\n            content: (\n              <ParametricCompanyTable queryParams={{ is_customer: true }} />\n            )\n          }\n        ]\n      })\n    ];\n  }, [user, customersView, salesOrderView, returnOrderView]);\n\n  if (!user.isLoggedIn() || !user.hasViewRole(UserRoles.sales_order)) {\n    return <PermissionDenied />;\n  }\n\n  return (\n    <Stack>\n      <PageDetail title={t`Sales`} />\n      <PanelGroup\n        pageKey='sales-index'\n        panels={panels}\n        model={'sales'}\n        id={null}\n      />\n    </Stack>\n  );\n}\n"],"names":["ReturnOrderParametricTable","queryParams","customColumns","useMemo","ReferenceColumn","switchable","accessor","title","_i18n","_","id","sortable","render","record","CompanyColumn","customer_detail","DescriptionColumn","customFilters","OrderStatusFilter","model","ModelType","returnorder","OutstandingFilter","OverdueFilter","AssignedToMeFilter","ProjectCodeFilter","ResponsibleFilter","jsx","ParametricDataTable","ApiEndpoints","return_order_list","SalesOrderParametricTable","salesorder","sales_order_list","SalesIndex","user","useUserState","customersView","setCustomersView","useLocalStorage","key","defaultValue","salesOrderView","setSalesOrderView","returnOrderView","setReturnOrderView","panels","SegmentedControlPanel","name","label","icon","IconTruckDelivery","hidden","hasViewRole","UserRoles","sales_order","selection","onChange","options","value","IconTable","content","SalesOrderTable","IconCalendar","OrderCalendar","return_order","outstanding","IconListDetails","IconCubeSend","SalesOrderShipmentTable","shipped","order_outstanding","IconTruckReturn","ReturnOrderTable","IconBuildingStore","CompanyTable","is_customer","ParametricCompanyTable","isLoggedIn","PermissionDenied","Stack","PageDetail","PanelGroup"],"mappings":"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"}