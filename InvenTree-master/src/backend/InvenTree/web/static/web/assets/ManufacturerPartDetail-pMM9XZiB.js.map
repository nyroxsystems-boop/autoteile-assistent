{"version":3,"file":"ManufacturerPartDetail-pMM9XZiB.js","sources":["../../../../../../frontend/src/pages/company/ManufacturerPartDetail.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Grid, Skeleton, Stack } from '@mantine/core';\nimport {\n  IconBuildingWarehouse,\n  IconInfoCircle,\n  IconPackages\n} from '@tabler/icons-react';\nimport { useMemo } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\n\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport { getDetailUrl } from '@lib/functions/Navigation';\nimport AdminButton from '../../components/buttons/AdminButton';\nimport {\n  type DetailsField,\n  DetailsTable\n} from '../../components/details/Details';\nimport { DetailsImage } from '../../components/details/DetailsImage';\nimport { ItemDetailsGrid } from '../../components/details/ItemDetails';\nimport {\n  DeleteItemAction,\n  DuplicateItemAction,\n  EditItemAction,\n  OptionsActionDropdown\n} from '../../components/items/ActionDropdown';\nimport InstanceDetail from '../../components/nav/InstanceDetail';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport AttachmentPanel from '../../components/panels/AttachmentPanel';\nimport NotesPanel from '../../components/panels/NotesPanel';\nimport type { PanelType } from '../../components/panels/Panel';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport ParametersPanel from '../../components/panels/ParametersPanel';\nimport { useManufacturerPartFields } from '../../forms/CompanyForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useInstance } from '../../hooks/UseInstance';\nimport { useUserState } from '../../states/UserState';\nimport { SupplierPartTable } from '../../tables/purchasing/SupplierPartTable';\nimport { StockItemTable } from '../../tables/stock/StockItemTable';\n\nexport default function ManufacturerPartDetail() {\n  const { id } = useParams();\n  const user = useUserState();\n  const navigate = useNavigate();\n\n  const {\n    instance: manufacturerPart,\n    instanceQuery,\n    refreshInstance\n  } = useInstance({\n    endpoint: ApiEndpoints.manufacturer_part_list,\n    pk: id,\n    hasPrimaryKey: true,\n    params: {\n      part_detail: true,\n      manufacturer_detail: true\n    }\n  });\n\n  const detailsPanel = useMemo(() => {\n    if (instanceQuery.isFetching) {\n      return <Skeleton />;\n    }\n\n    const data = manufacturerPart ?? {};\n\n    const tl: DetailsField[] = [\n      {\n        type: 'link',\n        name: 'part',\n        label: t`Internal Part`,\n        model: ModelType.part,\n        hidden: !manufacturerPart.part\n      },\n      {\n        type: 'string',\n        name: 'part_detail.IPN',\n        label: t`IPN`,\n        copy: true,\n        icon: 'serial',\n        hidden: !data.part_detail?.IPN\n      },\n      {\n        type: 'string',\n        name: 'part_detail.description',\n        label: t`Description`,\n        copy: true,\n        icon: 'info',\n        hidden: !manufacturerPart.description\n      }\n    ];\n\n    const tr: DetailsField[] = [\n      {\n        type: 'link',\n        name: 'manufacturer',\n        label: t`Manufacturer`,\n        icon: 'manufacturers',\n        model: ModelType.company,\n        hidden: !manufacturerPart.manufacturer\n      },\n      {\n        type: 'string',\n        name: 'MPN',\n        label: t`Manufacturer Part Number`,\n        copy: true,\n        hidden: !manufacturerPart.MPN,\n        icon: 'reference'\n      },\n      {\n        type: 'string',\n        name: 'description',\n        label: t`Description`,\n        copy: true,\n        hidden: !manufacturerPart.description,\n        icon: 'info'\n      },\n      {\n        type: 'link',\n        external: true,\n        name: 'link',\n        label: t`External Link`,\n        copy: true,\n        hidden: !manufacturerPart.link\n      }\n    ];\n\n    return (\n      <ItemDetailsGrid>\n        <Grid grow>\n          <DetailsImage\n            appRole={UserRoles.part}\n            src={manufacturerPart?.part_detail?.image}\n            apiPath={apiUrl(\n              ApiEndpoints.part_list,\n              manufacturerPart?.part_detail?.pk\n            )}\n            pk={manufacturerPart?.part_detail?.pk}\n          />\n          <Grid.Col span={{ base: 12, sm: 8 }}>\n            <DetailsTable title={t`Part Details`} fields={tl} item={data} />\n          </Grid.Col>\n        </Grid>\n        <DetailsTable title={t`Manufacturer Details`} fields={tr} item={data} />\n      </ItemDetailsGrid>\n    );\n  }, [manufacturerPart, instanceQuery]);\n\n  const panels: PanelType[] = useMemo(() => {\n    return [\n      {\n        name: 'details',\n        label: t`Manufacturer Part Details`,\n        icon: <IconInfoCircle />,\n        content: detailsPanel\n      },\n      {\n        name: 'stock',\n        label: t`Received Stock`,\n        hidden: !user.hasViewRole(UserRoles.stock),\n        icon: <IconPackages />,\n        content: (\n          <StockItemTable\n            tableName='manufacturer-part-stock'\n            params={{\n              manufacturer_part: id\n            }}\n          />\n        )\n      },\n      {\n        name: 'suppliers',\n        label: t`Suppliers`,\n        icon: <IconBuildingWarehouse />,\n        content: manufacturerPart?.pk ? (\n          <SupplierPartTable\n            partId={manufacturerPart.part}\n            manufacturerId={manufacturerPart.manufacturer}\n            manufacturerPartId={manufacturerPart.pk}\n          />\n        ) : (\n          <Skeleton />\n        )\n      },\n      ParametersPanel({\n        model_type: ModelType.manufacturerpart,\n        model_id: manufacturerPart?.pk\n      }),\n      AttachmentPanel({\n        model_type: ModelType.manufacturerpart,\n        model_id: manufacturerPart?.pk\n      }),\n      NotesPanel({\n        model_type: ModelType.manufacturerpart,\n        model_id: manufacturerPart?.pk\n      })\n    ];\n  }, [user, manufacturerPart]);\n\n  const editManufacturerPartFields = useManufacturerPartFields();\n\n  const editManufacturerPart = useEditApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: manufacturerPart?.pk,\n    title: t`Edit Manufacturer Part`,\n    fields: editManufacturerPartFields,\n    onFormSuccess: refreshInstance\n  });\n\n  const duplicateManufacturerPart = useCreateApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    title: t`Add Manufacturer Part`,\n    fields: editManufacturerPartFields,\n    initialData: {\n      ...manufacturerPart\n    },\n    follow: true,\n    modelType: ModelType.manufacturerpart\n  });\n\n  const deleteManufacturerPart = useDeleteApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: manufacturerPart?.pk,\n    title: t`Delete Manufacturer Part`,\n    onFormSuccess: () => {\n      navigate(getDetailUrl(ModelType.part, manufacturerPart.part));\n    }\n  });\n\n  const manufacturerPartActions = useMemo(() => {\n    return [\n      <AdminButton\n        key='admin'\n        model={ModelType.manufacturerpart}\n        id={manufacturerPart.pk}\n      />,\n      <OptionsActionDropdown\n        key='options'\n        tooltip={t`Manufacturer Part Actions`}\n        actions={[\n          DuplicateItemAction({\n            hidden: !user.hasAddRole(UserRoles.purchase_order),\n            onClick: () => duplicateManufacturerPart.open()\n          }),\n          EditItemAction({\n            hidden: !user.hasChangeRole(UserRoles.purchase_order),\n            onClick: () => editManufacturerPart.open()\n          }),\n          DeleteItemAction({\n            hidden: !user.hasDeleteRole(UserRoles.purchase_order),\n            onClick: () => deleteManufacturerPart.open()\n          })\n        ]}\n      />\n    ];\n  }, [user, manufacturerPart]);\n\n  const breadcrumbs = useMemo(() => {\n    return [\n      {\n        name: t`Purchasing`,\n        url: '/purchasing/'\n      },\n      {\n        name: manufacturerPart?.manufacturer_detail?.name ?? t`Manufacturer`,\n        url: `/purchasing/manufacturer/${manufacturerPart?.manufacturer_detail?.pk}/`\n      }\n    ];\n  }, [manufacturerPart]);\n\n  return (\n    <>\n      {deleteManufacturerPart.modal}\n      {duplicateManufacturerPart.modal}\n      {editManufacturerPart.modal}\n      <InstanceDetail\n        query={instanceQuery}\n        requiredPermission={ModelType.manufacturerpart}\n      >\n        <Stack gap='xs'>\n          <PageDetail\n            title={t`Manufacturer Part`}\n            subtitle={`${manufacturerPart.MPN} - ${manufacturerPart.part_detail?.name}`}\n            breadcrumbs={breadcrumbs}\n            lastCrumb={[\n              {\n                name: manufacturerPart.MPN,\n                url: getDetailUrl(\n                  ModelType.manufacturerpart,\n                  manufacturerPart.pk\n                )\n              }\n            ]}\n            actions={manufacturerPartActions}\n            imageUrl={manufacturerPart?.part_detail?.thumbnail}\n            editAction={editManufacturerPart.open}\n            editEnabled={user.hasChangePermission(ModelType.manufacturerpart)}\n          />\n          <PanelGroup\n            pageKey='manufacturerpart'\n            panels={panels}\n            instance={manufacturerPart}\n            reloadInstance={refreshInstance}\n            model={ModelType.manufacturerpart}\n            id={manufacturerPart.pk}\n          />\n        </Stack>\n      </InstanceDetail>\n    </>\n  );\n}\n"],"names":["ManufacturerPartDetail","id","useParams","user","useUserState","navigate","useNavigate","instance","manufacturerPart","instanceQuery","refreshInstance","useInstance","endpoint","ApiEndpoints","manufacturer_part_list","pk","hasPrimaryKey","params","part_detail","manufacturer_detail","detailsPanel","useMemo","isFetching","Skeleton","data","tl","type","name","label","_i18n","_","model","ModelType","part","hidden","copy","icon","IPN","description","tr","company","manufacturer","MPN","external","link","ItemDetailsGrid","jsxs","Grid","jsx","DetailsImage","UserRoles","image","apiUrl","part_list","base","sm","DetailsTable","panels","IconInfoCircle","content","hasViewRole","stock","IconPackages","StockItemTable","manufacturer_part","IconBuildingWarehouse","SupplierPartTable","ParametersPanel","model_type","manufacturerpart","model_id","AttachmentPanel","NotesPanel","editManufacturerPartFields","useManufacturerPartFields","editManufacturerPart","useEditApiFormModal","url","title","fields","onFormSuccess","duplicateManufacturerPart","useCreateApiFormModal","initialData","follow","modelType","deleteManufacturerPart","useDeleteApiFormModal","getDetailUrl","manufacturerPartActions","AdminButton","OptionsActionDropdown","DuplicateItemAction","hasAddRole","purchase_order","onClick","open","EditItemAction","hasChangeRole","DeleteItemAction","hasDeleteRole","breadcrumbs","Fragment","modal","InstanceDetail","Stack","PageDetail","thumbnail","hasChangePermission","PanelGroup"],"mappings":"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"}