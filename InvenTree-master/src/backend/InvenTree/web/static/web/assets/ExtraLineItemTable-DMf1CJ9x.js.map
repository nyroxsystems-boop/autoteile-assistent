{"version":3,"file":"ExtraLineItemTable-DMf1CJ9x.js","sources":["../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconSquareArrowRight.mjs","../../../../../../frontend/src/tables/general/ExtraLineItemTable.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M12 16l4 -4l-4 -4\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M8 12h8\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z\", \"key\": \"svg-2\" }]];\nconst IconSquareArrowRight = createReactComponent(\"outline\", \"square-arrow-right\", \"SquareArrowRight\", __iconNode);\n\nexport { __iconNode, IconSquareArrowRight as default };\n//# sourceMappingURL=IconSquareArrowRight.mjs.map\n","import { t } from '@lingui/core/macro';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowDuplicateAction,\n  RowEditAction\n} from '@lib/components/RowActions';\nimport type { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport type { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { formatCurrency } from '../../defaults/formatters';\nimport { extraLineItemFields } from '../../forms/CommonForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  DecimalColumn,\n  DescriptionColumn,\n  LinkColumn,\n  NoteColumn,\n  ProjectCodeColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\nexport default function ExtraLineItemTable({\n  endpoint,\n  orderId,\n  orderDetailRefresh,\n  currency,\n  editable,\n  role\n}: Readonly<{\n  endpoint: ApiEndpoints;\n  orderId: number;\n  editable: boolean;\n  orderDetailRefresh: () => void;\n  currency: string;\n  role: UserRoles;\n}>) {\n  const table = useTable('extra-line-item');\n  const user = useUserState();\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'reference',\n        switchable: false\n      },\n      DescriptionColumn({}),\n      DecimalColumn({\n        accessor: 'quantity',\n        switchable: false\n      }),\n      {\n        accessor: 'price',\n        title: t`Unit Price`,\n        render: (record: any) =>\n          formatCurrency(record.price, {\n            currency: record.price_currency\n          })\n      },\n      {\n        accessor: 'total_price',\n        title: t`Total Price`,\n        render: (record: any) =>\n          formatCurrency(record.price, {\n            currency: record.price_currency,\n            multiplier: record.quantity\n          })\n      },\n      ProjectCodeColumn({}),\n      NoteColumn({\n        accessor: 'notes'\n      }),\n      LinkColumn({\n        accessor: 'link'\n      })\n    ];\n  }, []);\n\n  const [initialData, setInitialData] = useState<any>({});\n\n  const [selectedLine, setSelectedLine] = useState<number>(0);\n\n  const newLineItem = useCreateApiFormModal({\n    url: endpoint,\n    title: t`Add Line Item`,\n    fields: extraLineItemFields(),\n    initialData: {\n      ...initialData,\n      price_currency: currency\n    },\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const editLineItem = useEditApiFormModal({\n    url: endpoint,\n    pk: selectedLine,\n    title: t`Edit Line Item`,\n    fields: extraLineItemFields(),\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const deleteLineItem = useDeleteApiFormModal({\n    url: endpoint,\n    pk: selectedLine,\n    title: t`Delete Line Item`,\n    onFormSuccess: orderDetailRefresh,\n    table: table\n  });\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !editable || !user.hasChangeRole(role),\n          onClick: () => {\n            setSelectedLine(record.pk);\n            editLineItem.open();\n          }\n        }),\n        RowDuplicateAction({\n          hidden: !editable || !user.hasAddRole(role),\n          onClick: () => {\n            setInitialData({ ...record });\n            newLineItem.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !editable || !user.hasDeleteRole(role),\n          onClick: () => {\n            setSelectedLine(record.pk);\n            deleteLineItem.open();\n          }\n        })\n      ];\n    },\n    [editable, user, role]\n  );\n\n  const tableActions = useMemo(() => {\n    return [\n      <AddItemButton\n        key='add-line-item'\n        tooltip={t`Add Extra Line Item`}\n        hidden={!editable || !user.hasAddRole(role)}\n        onClick={() => {\n          setInitialData({\n            order: orderId\n          });\n          newLineItem.open();\n        }}\n      />\n    ];\n  }, [editable, user, role]);\n\n  return (\n    <>\n      {newLineItem.modal}\n      {editLineItem.modal}\n      {deleteLineItem.modal}\n      <InvenTreeTable\n        tableState={table}\n        url={apiUrl(endpoint)}\n        columns={tableColumns}\n        props={{\n          params: {\n            order: orderId\n          },\n          rowActions: rowActions,\n          tableActions: tableActions\n        }}\n      />\n    </>\n  );\n}\n"],"names":["__iconNode","IconSquareArrowRight","createReactComponent","ExtraLineItemTable","endpoint","orderId","orderDetailRefresh","currency","editable","role","table","useTable","user","useUserState","tableColumns","useMemo","accessor","switchable","DescriptionColumn","DecimalColumn","title","_i18n","_","id","render","record","formatCurrency","price","price_currency","multiplier","quantity","ProjectCodeColumn","NoteColumn","LinkColumn","initialData","setInitialData","useState","selectedLine","setSelectedLine","newLineItem","useCreateApiFormModal","url","fields","extraLineItemFields","onFormSuccess","editLineItem","useEditApiFormModal","pk","deleteLineItem","useDeleteApiFormModal","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","onClick","open","RowDuplicateAction","hasAddRole","RowDeleteAction","hasDeleteRole","tableActions","jsx","AddItemButton","order","jsxs","Fragment","modal","InvenTreeTable","apiUrl","params"],"mappings":"kYAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,EAAa,CAAC,CAAC,OAAQ,CAAE,EAAK,oBAAqB,IAAO,OAAO,CAAE,EAAG,CAAC,OAAQ,CAAE,EAAK,UAAW,IAAO,QAAS,EAAG,CAAC,OAAQ,CAAE,EAAK,kFAAmF,IAAO,OAAO,CAAE,CAAC,EACxOC,EAAuBC,EAAqB,UAAW,qBAAsB,mBAAoBF,CAAU,ECsBjH,SAAwBG,EAAmB,CACzCC,SAAAA,EACAC,QAAAA,EACAC,mBAAAA,EACAC,SAAAA,EACAC,SAAAA,EACAC,KAAAA,CAQD,EAAG,CACF,MAAMC,EAAQC,EAAS,iBAAiB,EAClCC,EAAOC,EAAAA,EAEPC,EAA8BC,EAAAA,QAAQ,IACnC,CACL,CACEC,SAAU,YACVC,WAAY,EAAA,EAEdC,EAAkB,EAAE,EACpBC,EAAc,CACZH,SAAU,WACVC,WAAY,EAAA,CACb,EACD,CACED,SAAU,QACVI,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAY,EACnBC,OAASC,GACPC,EAAeD,EAAOE,MAAO,CAC3BpB,SAAUkB,EAAOG,cAAAA,CAClB,CAAA,EAEL,CACEZ,SAAU,cACVI,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAa,EACpBC,OAASC,GACPC,EAAeD,EAAOE,MAAO,CAC3BpB,SAAUkB,EAAOG,eACjBC,WAAYJ,EAAOK,QAAAA,CACpB,CAAA,EAELC,EAAkB,EAAE,EACpBC,EAAW,CACThB,SAAU,OAAA,CACX,EACDiB,EAAW,CACTjB,SAAU,MAAA,CACX,CAAC,EAEH,CAAA,CAAE,EAEC,CAACkB,EAAaC,CAAc,EAAIC,EAAAA,SAAc,CAAA,CAAE,EAEhD,CAACC,EAAcC,CAAe,EAAIF,EAAAA,SAAiB,CAAC,EAEpDG,EAAcC,EAAsB,CACxCC,IAAKrC,EACLgB,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAe,EACtBmB,OAAQC,EAAAA,EACRT,YAAa,CACX,GAAGA,EACHN,eAAgBrB,CAAAA,EAElBqC,cAAetC,EACfI,MAAAA,CAAAA,CACD,EAEKmC,EAAeC,EAAoB,CACvCL,IAAKrC,EACL2C,GAAIV,EACJjB,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAgB,EACvBmB,OAAQC,EAAAA,EACRC,cAAetC,EACfI,MAAAA,CAAAA,CACD,EAEKsC,EAAiBC,EAAsB,CAC3CR,IAAKrC,EACL2C,GAAIV,EACJjB,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAkB,EACzBqB,cAAetC,EACfI,MAAAA,CAAAA,CACD,EAEKwC,EAAaC,cAChB1B,GACQ,CACL2B,EAAc,CACZC,OAAQ,CAAC7C,GAAY,CAACI,EAAK0C,cAAc7C,CAAI,EAC7C8C,QAASA,IAAM,CACbjB,EAAgBb,EAAOsB,EAAE,EACzBF,EAAaW,KAAAA,CACf,CAAA,CACD,EACDC,EAAmB,CACjBJ,OAAQ,CAAC7C,GAAY,CAACI,EAAK8C,WAAWjD,CAAI,EAC1C8C,QAASA,IAAM,CACbpB,EAAe,CAAE,GAAGV,CAAAA,CAAQ,EAC5Bc,EAAYiB,KAAAA,CACd,CAAA,CACD,EACDG,EAAgB,CACdN,OAAQ,CAAC7C,GAAY,CAACI,EAAKgD,cAAcnD,CAAI,EAC7C8C,QAASA,IAAM,CACbjB,EAAgBb,EAAOsB,EAAE,EACzBC,EAAeQ,KAAAA,CACjB,CAAA,CACD,CAAC,EAGN,CAAChD,EAAUI,EAAMH,CAAI,CACvB,EAEMoD,EAAe9C,EAAAA,QAAQ,IACpB,CACL+C,EAAAA,IAACC,EAAA,CAEC,QAAQ1C,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAqB,EAC9B,OAAQ,CAACf,GAAY,CAACI,EAAK8C,WAAWjD,CAAI,EAC1C,QAAS,IAAM,CACb0B,EAAe,CACb6B,MAAO3D,CAAAA,CACR,EACDkC,EAAYiB,KAAAA,CACd,CAAA,EARI,gBASJ,EAEH,CAAChD,EAAUI,EAAMH,CAAI,CAAC,EAEzB,OACEwD,EAAAA,KAAAC,WAAA,CACG3B,SAAAA,CAAAA,EAAY4B,MACZtB,EAAasB,MACbnB,EAAemB,MAChBL,EAAAA,IAACM,EAAA,CACC,WAAY1D,EACZ,IAAK2D,EAAOjE,CAAQ,EACpB,QAASU,EACT,MAAO,CACLwD,OAAQ,CACNN,MAAO3D,CAAAA,EAET6C,WAAAA,EACAW,aAAAA,CAAAA,CACF,CAAE,CAAA,EAEN,CAEJ","x_google_ignoreList":[0]}