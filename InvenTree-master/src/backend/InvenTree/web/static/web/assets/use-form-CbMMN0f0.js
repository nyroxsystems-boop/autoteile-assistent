import{r as a,au as Se}from"./index-Db7AGPIq.js";function Fe(t){if(!/^[0-9a-zA-Z-]+$/.test(t))throw new Error(`[@mantine/use-form] Form name "${t}" is invalid, it should contain only letters, numbers and dashes`)}const me=typeof window<"u"?a.useLayoutEffect:a.useEffect;function j(t,e){me(()=>{if(t)return window.addEventListener(t,e),()=>window.removeEventListener(t,e)},[t])}function he(t,e){t&&Fe(t),j(`mantine-form:${t}:set-field-value`,r=>e.setFieldValue(r.detail.path,r.detail.value)),j(`mantine-form:${t}:set-values`,r=>e.setValues(r.detail)),j(`mantine-form:${t}:set-initial-values`,r=>e.setInitialValues(r.detail)),j(`mantine-form:${t}:set-errors`,r=>e.setErrors(r.detail)),j(`mantine-form:${t}:set-field-error`,r=>e.setFieldError(r.detail.path,r.detail.error)),j(`mantine-form:${t}:clear-field-error`,r=>e.clearFieldError(r.detail)),j(`mantine-form:${t}:clear-errors`,e.clearErrors),j(`mantine-form:${t}:reset`,e.reset),j(`mantine-form:${t}:validate`,e.validate),j(`mantine-form:${t}:validate-field`,r=>e.validateField(r.detail)),j(`mantine-form:${t}:reorder-list-item`,r=>e.reorderListItem(r.detail.path,r.detail.payload)),j(`mantine-form:${t}:remove-list-item`,r=>e.removeListItem(r.detail.path,r.detail.index)),j(`mantine-form:${t}:insert-list-item`,r=>e.insertListItem(r.detail.path,r.detail.item,r.detail.index)),j(`mantine-form:${t}:set-dirty`,r=>e.setDirty(r.detail)),j(`mantine-form:${t}:set-touched`,r=>e.setTouched(r.detail)),j(`mantine-form:${t}:reset-dirty`,r=>e.resetDirty(r.detail)),j(`mantine-form:${t}:reset-touched`,e.resetTouched)}function je(t){return e=>{if(!e)t(e);else if(typeof e=="function")t(e);else if(typeof e=="object"&&"nativeEvent"in e){const{currentTarget:r}=e;r instanceof HTMLInputElement?r.type==="checkbox"?t(r.checked):t(r.value):(r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement)&&t(r.value)}else t(e)}}function X(t){return t===null||typeof t!="object"?{}:Object.keys(t).reduce((e,r)=>{const n=t[r];return n!=null&&n!==!1&&(e[r]=n),e},{})}function Ce(t){const[e,r]=a.useState(X(t)),n=a.useRef(e),s=a.useCallback(u=>{r(f=>{const V=X(typeof u=="function"?u(f):u);return n.current=V,V})},[]),o=a.useCallback(()=>s({}),[]),c=a.useCallback(u=>{n.current[u]!==void 0&&s(f=>{const V={...f};return delete V[u],V})},[e]),i=a.useCallback((u,f)=>{f==null||f===!1?c(u):n.current[u]!==f&&s(V=>({...V,[u]:f}))},[e]);return{errorsState:e,setErrors:s,clearErrors:o,setFieldError:i,clearFieldError:c}}function Z(t,e){if(e===null||typeof e!="object")return{};const r={...e};return Object.keys(e).forEach(n=>{n.includes(`${String(t)}.`)&&delete r[n]}),r}function ee(t,e){const r=t.substring(e.length+1).split(".")[0];return parseInt(r,10)}function te(t,e,r,n){if(e===void 0)return r;const s=`${String(t)}`;let o=r;n===-1&&(o=Z(`${s}.${e}`,o));const c={...o},i=new Set;return Object.entries(o).filter(([u])=>{if(!u.startsWith(`${s}.`))return!1;const f=ee(u,s);return Number.isNaN(f)?!1:f>=e}).forEach(([u,f])=>{const V=ee(u,s),m=u.replace(`${s}.${V}`,`${s}.${V+n}`);c[m]=f,i.add(m),i.has(u)||delete c[u]}),c}function ke(t,{from:e,to:r},n){const s=`${t}.${e}`,o=`${t}.${r}`,c={...n},i=new Set;return Object.keys(n).forEach(u=>{if(i.has(u))return;let f,V;if(u.startsWith(s)?(f=u,V=u.replace(s,o)):u.startsWith(o)&&(f=u.replace(o,s),V=u),f&&V){const m=c[f],h=c[V];h===void 0?delete c[f]:c[f]=h,m===void 0?delete c[V]:c[V]=m,i.add(f),i.add(V)}}),c}function re(t,e,r){typeof r.value=="object"&&(r.value=L(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||e==="__proto__"?Object.defineProperty(t,e,r):t[e]=r.value}function L(t){if(typeof t!="object")return t;var e=0,r,n,s,o=Object.prototype.toString.call(t);if(o==="[object Object]"?s=Object.create(t.__proto__||null):o==="[object Array]"?s=Array(t.length):o==="[object Set]"?(s=new Set,t.forEach(function(c){s.add(L(c))})):o==="[object Map]"?(s=new Map,t.forEach(function(c,i){s.set(L(i),L(c))})):o==="[object Date]"?s=new Date(+t):o==="[object RegExp]"?s=new RegExp(t.source,t.flags):o==="[object DataView]"?s=new t.constructor(L(t.buffer)):o==="[object ArrayBuffer]"?s=t.slice(0):o.slice(-6)==="Array]"&&(s=new t.constructor(t)),s){for(n=Object.getOwnPropertySymbols(t);e<n.length;e++)re(s,n[e],Object.getOwnPropertyDescriptor(t,n[e]));for(e=0,n=Object.getOwnPropertyNames(t);e<n.length;e++)Object.hasOwnProperty.call(s,r=n[e])&&s[r]===t[r]||re(s,r,Object.getOwnPropertyDescriptor(t,r))}return s||t}function ue(t){return typeof t!="string"?[]:t.split(".")}function F(t,e){const r=ue(t);if(r.length===0||typeof e!="object"||e===null)return;let n=e[r[0]];for(let s=1;s<r.length&&n!=null;s+=1)n=n[r[s]];return n}function N(t,e,r){const n=ue(t);if(n.length===0)return r;const s=L(r);if(n.length===1)return s[n[0]]=e,s;let o=s[n[0]];for(let c=1;c<n.length-1;c+=1){if(o===void 0)return s;o=o[n[c]]}return o[n[n.length-1]]=e,s}function De(t,{from:e,to:r},n){const s=F(t,n);if(!Array.isArray(s))return n;const o=[...s],c=s[e];return o.splice(e,1),o.splice(r,0,c),N(t,o,n)}function Oe(t,e,r,n){const s=F(t,n);if(!Array.isArray(s))return n;const o=[...s];return o.splice(typeof r=="number"?r:o.length,0,e),N(t,o,n)}function we(t,e,r){const n=F(t,r);return Array.isArray(n)?N(t,n.filter((s,o)=>o!==e),r):r}function $e(t,e,r,n){const s=F(t,n);if(!Array.isArray(s)||s.length<=r)return n;const o=[...s];return o[r]=e,N(t,o,n)}function Ie({$values:t,$errors:e,$status:r}){const n=a.useCallback((i,u)=>{r.clearFieldDirty(i),e.setErrors(f=>ke(i,u,f)),t.setValues({values:De(i,u,t.refValues.current),updateState:!0})},[]),s=a.useCallback((i,u)=>{r.clearFieldDirty(i),e.setErrors(f=>te(i,u,f,-1)),t.setValues({values:we(i,u,t.refValues.current),updateState:!0})},[]),o=a.useCallback((i,u,f)=>{r.clearFieldDirty(i),e.setErrors(V=>te(i,f,V,1)),t.setValues({values:Oe(i,u,f,t.refValues.current),updateState:!0})},[]),c=a.useCallback((i,u,f)=>{r.clearFieldDirty(i),t.setValues({values:$e(i,f,u,t.refValues.current),updateState:!0})},[]);return{reorderListItem:n,removeListItem:s,insertListItem:o,replaceListItem:c}}var U,se;function Re(){return se||(se=1,U=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;s--!==0;){var c=o[s];if(!t(e[c],r[c]))return!1}return!0}return e!==e&&r!==r}),U}var Te=Re();const W=Se(Te);function q(t,e){const r=Object.keys(t);if(typeof e=="string"){const n=r.filter(s=>s.startsWith(`${e}.`));return t[e]||n.some(s=>t[s])||!1}return r.some(n=>t[n])}function Ae({initialDirty:t,initialTouched:e,mode:r,$values:n}){const[s,o]=a.useState(e),[c,i]=a.useState(t),u=a.useRef(e),f=a.useRef(t),V=a.useCallback(b=>{const p=typeof b=="function"?b(u.current):b;u.current=p,r==="controlled"&&o(p)},[]),m=a.useCallback((b,p=!1)=>{const S=typeof b=="function"?b(f.current):b;f.current=S,(r==="controlled"||p)&&i(S)},[]),h=a.useCallback(()=>V({}),[]),A=a.useCallback(b=>{const p=b?{...n.refValues.current,...b}:n.refValues.current;n.setValuesSnapshot(p),m({})},[]),P=a.useCallback((b,p)=>{V(S=>q(S,b)===p?S:{...S,[b]:p})},[]),v=a.useCallback((b,p,S)=>{m(O=>q(O,b)===p?O:{...O,[b]:p},S)},[]),d=a.useCallback((b,p)=>{const S=q(f.current,b),O=!W(F(b,n.getValuesSnapshot()),p),R=Z(b,f.current);R[b]=O,m(R,S!==O)},[]),y=a.useCallback(b=>q(u.current,b),[]),g=a.useCallback(b=>m(p=>{if(typeof b!="string")return p;const S=Z(b,p);return delete S[b],W(S,p)?p:S}),[]),D=a.useCallback(b=>{if(b){const S=F(b,f.current);if(typeof S=="boolean")return S;const O=F(b,n.refValues.current),R=F(b,n.valuesSnapshot.current);return!W(O,R)}return Object.keys(f.current).length>0?q(f.current):!W(n.refValues.current,n.valuesSnapshot.current)},[]),C=a.useCallback(()=>f.current,[]),I=a.useCallback(()=>u.current,[]);return{touchedState:s,dirtyState:c,touchedRef:u,dirtyRef:f,setTouched:V,setDirty:m,resetDirty:A,resetTouched:h,isTouched:y,setFieldTouched:P,setFieldDirty:v,setTouchedState:o,setDirtyState:i,clearFieldDirty:g,isDirty:D,getDirty:C,getTouched:I,setCalculatedFieldDirty:d}}function Le({initialValues:t,onValuesChange:e,mode:r}){const n=a.useRef(!1),[s,o]=a.useState(t||{}),c=a.useRef(s),i=a.useRef(s),u=a.useCallback(({values:d,subscribers:y,updateState:g=!0,mergeWithPreviousValues:D=!0})=>{const C=c.current,I=d instanceof Function?d(c.current):d,b=D?{...C,...I}:I;c.current=b,g&&(o(b),r==="uncontrolled"&&(c.current=b)),e?.(b,C),y?.filter(Boolean).forEach(p=>p({updatedValues:b,previousValues:C}))},[e]),f=a.useCallback(d=>{const y=F(d.path,c.current),g=d.value instanceof Function?d.value(y):d.value;if(y!==g){const D=c.current,C=N(d.path,g,c.current);u({values:C,updateState:d.updateState}),d.subscribers?.filter(Boolean).forEach(I=>I({path:d.path,updatedValues:C,previousValues:D}))}},[u]),V=a.useCallback(d=>{i.current=d},[]),m=a.useCallback((d,y)=>{n.current||(n.current=!0,u({values:d,updateState:r==="controlled"}),V(d),y())},[u]),h=a.useCallback(()=>{u({values:i.current,updateState:!0,mergeWithPreviousValues:!1})},[u]),A=a.useCallback(()=>c.current,[]),P=a.useCallback(()=>i.current,[]),v=a.useCallback((d,y)=>{const g=F(d,i.current);typeof g>"u"||f({path:d,value:g,updateState:r==="controlled",subscribers:y})},[f,r]);return{initialized:n,stateValues:s,refValues:c,valuesSnapshot:i,setValues:u,setFieldValue:f,resetValues:h,setValuesSnapshot:V,initialize:m,getValues:A,getValuesSnapshot:P,resetField:v}}function Pe({$status:t,cascadeUpdates:e}){const r=a.useRef({}),n=a.useCallback((o,c)=>{a.useEffect(()=>(r.current[o]=r.current[o]||[],r.current[o].push(c),()=>{r.current[o]=r.current[o].filter(i=>i!==c)}),[c])},[]),s=a.useCallback(o=>{const c=r.current[o]?.map(i=>u=>i({previousValue:F(o,u.previousValues),value:F(o,u.updatedValues),touched:t.isTouched(o),dirty:t.isDirty(o)}))??[];if(e)for(const i in r.current)(i.startsWith(`${o}.`)||o.startsWith(`${i}.`))&&c.push(...r.current[i].map(u=>f=>u({previousValue:F(i,f.previousValues),value:F(i,f.updatedValues),touched:t.isTouched(i),dirty:t.isDirty(i)})));return c},[]);return{subscribers:r,watch:n,getFieldSubscribers:s}}function ne(t,e){return t?`${t}-${e.toString()}`:e.toString()}const z=Symbol("root-rule");function oe(t){const e=X(t);return{hasErrors:Object.keys(e).length>0,errors:e}}function G(t,e,r="",n={}){return typeof t!="object"||t===null?n:Object.keys(t).reduce((s,o)=>{const c=t[o],i=`${r===""?"":`${r}.`}${o}`,u=F(i,e);let f=!1;return typeof c=="function"&&(s[i]=c(u,e,i)),typeof c=="object"&&Array.isArray(u)&&(f=!0,u.forEach((V,m)=>G(c,e,`${i}.${m}`,s)),z in c&&(s[i]=c[z](u,e,i))),typeof c=="object"&&typeof u=="object"&&u!==null&&(f||G(c,e,i,s),z in c&&(s[i]=c[z](u,e,i))),s},n)}function J(t,e){return oe(typeof t=="function"?t(e):G(t,e))}function B(t,e,r){if(typeof t!="string")return{hasError:!1,error:null};const n=J(e,r),s=Object.keys(n.errors).find(o=>t.split(".").every((c,i)=>c===o.split(".")[i]));return{hasError:!!s,error:s?n.errors[s]:null}}const ve="__MANTINE_FORM_INDEX__";function ce(t,e){return e?typeof e=="boolean"?e:Array.isArray(e)?e.includes(t.replace(/[.][0-9]+/g,`.${ve}`)):!1:!1}function qe({name:t,mode:e="controlled",initialValues:r,initialErrors:n={},initialDirty:s={},initialTouched:o={},clearInputErrorOnChange:c=!0,validateInputOnChange:i=!1,validateInputOnBlur:u=!1,onValuesChange:f,transformValues:V=d=>d,enhanceGetInputProps:m,validate:h,onSubmitPreventDefault:A="always",touchTrigger:P="change",cascadeUpdates:v=!1}={}){const d=Ce(n),y=Le({initialValues:r,onValuesChange:f,mode:e}),g=Ae({initialDirty:s,initialTouched:o,$values:y,mode:e}),D=Ie({$values:y,$errors:d,$status:g}),C=Pe({$status:g,cascadeUpdates:v}),[I,b]=a.useState(0),[p,S]=a.useState({}),[O,R]=a.useState(!1),Q=a.useCallback(()=>{y.resetValues(),d.clearErrors(),g.resetDirty(),g.resetTouched(),e==="uncontrolled"&&b(l=>l+1)},[]),K=a.useCallback(l=>{c&&d.clearErrors(),e==="uncontrolled"&&b(E=>E+1),Object.keys(C.subscribers.current).forEach(E=>{const k=F(E,y.refValues.current),w=F(E,l);k!==w&&C.getFieldSubscribers(E).forEach(T=>T({previousValues:l,updatedValues:y.refValues.current}))})},[c]),ie=a.useCallback(l=>{const E=y.refValues.current;y.initialize(l,()=>e==="uncontrolled"&&b(k=>k+1)),K(E)},[K]),Y=a.useCallback((l,E,k)=>{const w=ce(l,i),T=E instanceof Function?E(F(l,y.refValues.current)):E;g.setCalculatedFieldDirty(l,T),P==="change"&&g.setFieldTouched(l,!0),!w&&c&&d.clearFieldError(l),y.setFieldValue({path:l,value:E,updateState:e==="controlled",subscribers:[...C.getFieldSubscribers(l),w?_=>{const $=B(l,h,_.updatedValues);$.hasError?d.setFieldError(l,$.error):d.clearFieldError(l)}:null,k?.forceUpdate!==!1&&e!=="controlled"?()=>S(_=>({..._,[l]:(_[l]||0)+1})):null]})},[f,h]),le=a.useCallback(l=>{const E=y.refValues.current;y.setValues({values:l,updateState:e==="controlled"}),K(E)},[f,K]),x=a.useCallback(()=>{const l=J(h,y.refValues.current);return d.setErrors(l.errors),l},[h]),ae=a.useCallback(l=>{const E=B(l,h,y.refValues.current);return E.hasError?d.setFieldError(l,E.error):d.clearFieldError(l),E},[h]),fe=(l,{type:E="input",withError:k=!0,withFocus:w=!0,...T}={})=>{const $={onChange:je(M=>Y(l,M,{forceUpdate:!1})),"data-path":ne(t,l)};return k&&($.error=d.errorsState[l]),E==="checkbox"?$[e==="controlled"?"checked":"defaultChecked"]=F(l,y.refValues.current):$[e==="controlled"?"value":"defaultValue"]=F(l,y.refValues.current),w&&($.onFocus=()=>g.setFieldTouched(l,!0),$.onBlur=()=>{if(ce(l,u)){const M=B(l,h,y.refValues.current);M.hasError?d.setFieldError(l,M.error):d.clearFieldError(l)}}),Object.assign($,m?.({inputProps:$,field:l,options:{type:E,withError:k,withFocus:w,...T},form:H}))},de=(l,E)=>k=>{A==="always"&&k?.preventDefault();const w=x();if(w.hasErrors)A==="validation-failed"&&k?.preventDefault(),E?.(w.errors,y.refValues.current,k);else{const T=l?.(V(y.refValues.current),k);T instanceof Promise&&(R(!0),T.finally(()=>R(!1)))}},be=l=>V(l||y.refValues.current),ye=a.useCallback(l=>{l.preventDefault(),Q()},[]),Ve=a.useCallback(l=>l?!B(l,h,y.refValues.current).hasError:!J(h,y.refValues.current).hasErrors,[h]),Ee=l=>`${I}-${String(l)}-${p[String(l)]||0}`,ge=a.useCallback(l=>document.querySelector(`[data-path="${ne(t,l)}"]`),[]),pe=a.useCallback(l=>{y.resetField(l,[e!=="controlled"?()=>S(E=>({...E,[l]:(E[l]||0)+1})):null])},[y.resetField,e,S]),H={watch:C.watch,initialized:y.initialized.current,values:e==="uncontrolled"?y.refValues.current:y.stateValues,getValues:y.getValues,getInitialValues:y.getValuesSnapshot,setInitialValues:y.setValuesSnapshot,resetField:pe,initialize:ie,setValues:le,setFieldValue:Y,submitting:O,setSubmitting:R,errors:d.errorsState,setErrors:d.setErrors,setFieldError:d.setFieldError,clearFieldError:d.clearFieldError,clearErrors:d.clearErrors,resetDirty:g.resetDirty,setTouched:g.setTouched,setDirty:g.setDirty,isTouched:g.isTouched,resetTouched:g.resetTouched,isDirty:g.isDirty,getTouched:g.getTouched,getDirty:g.getDirty,reorderListItem:D.reorderListItem,insertListItem:D.insertListItem,removeListItem:D.removeListItem,replaceListItem:D.replaceListItem,reset:Q,validate:x,validateField:ae,getInputProps:fe,onSubmit:de,onReset:ye,isValid:Ve,getTransformedValues:be,key:Ee,getInputNode:ge};return he(t,H),H}export{qe as u};
//# sourceMappingURL=use-form-CbMMN0f0.js.map
