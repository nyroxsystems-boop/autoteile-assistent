import{K as Fe,ag as pe,r as d,bb as l,ab as t,an as S,ao as p,j as e,aq as v,a8 as Oe,b1 as C,bi as Pe,N as X,a7 as me,d as U,S as Q,b9 as Ae,aj as Be,$ as ie,al as oe,az as De,b4 as P,by as le,aD as Te}from"./index-Db7AGPIq.js";import{A as Le}from"./AdminButton-BR7cWvGK.js";import{P as re}from"./PrimaryActionButton-CsYjCYWq.js";import{u as Re,R as we,I as Ee,B as qe,P as Me,O as Ne,E as ve,b as Ue,H as ze,C as Ge}from"./InvenTreeTable-DmN557zY.js";import{I as He,D as K,a as Ve}from"./InstanceDetail-CF-uHhEW.js";import{D as We}from"./DetailsBadge-rxZ_XzUd.js";import{D as Ke,A as Je,N as Qe}from"./NotesPanel-BpiQDImp.js";import{P as Ze}from"./PageDetail-Bm50kpyR.js";import{P as Ye}from"./PanelGroup-Bif3iIGQ.js";import{P as Xe}from"./ParametersPanel-CrcKbDM0.js";import{a as I,b as _e,i as $e,y as et,H as tt,B as st,z as at,C as it,D as ot,E as lt,d as rt,T as nt,p as dt,q as ct}from"./Filter-BgnAqEQC.js";import{u as ut,a as pt,b as mt,c as _t,d as ne}from"./BuildForms-BotNgtQh.js";import{u as J}from"./UseInstance-BPJQEWDW.js";import{u as be}from"./ImporterForms-D2fp0CPO.js";import{B as bt}from"./BuildAllocatedStockTable-BwnJFOHY.js";import{a as he,P as ht}from"./BuildLineTable-BpYYPAMV.js";import{B as ft}from"./BuildOrderTable-DbWov0Ph.js";import{a as xt,v as de,t as y,ac as kt,ad as jt,S as yt,E as gt,r as fe,Y as Ct,a3 as It,ae as St,F as Ft,U as xe}from"./ThemeContext-CxdCkKtz.js";import{A as Y}from"./ActionButton-Cv5j5I5R.js";import{P as ce}from"./index-DRtKJP-e.js";import{u as Ot}from"./DesktopAppView-BuH2j218.js";import{f as Pt,g as At}from"./PluginUIFeature-DCu8wTdG.js";import{u as Bt}from"./UseStockAdjustActions-BrgagWbF.js";import{P as Dt,S as Tt,f as Lt,g as Rt}from"./ColumnRenderers-BUH0stTX.js";import{P as wt}from"./PurchaseOrderTable-D3f1t8t_.js";import{S as ue}from"./StockItemTable-CHHhSxX_.js";import{I as Et}from"./IconListCheck-Bp3Z6623.js";import{I as qt}from"./IconChecklist-CFul5P3t.js";import"./IconChevronDown-CzbIU38Y.js";import"./QRCode-BaIEIQ2d.js";import"./browser-DSycY7kT.js";import"./IconDotsVertical-D8D3XsjG.js";import"./IconTags-DnGx22aA.js";import"./YesNoButton-BaVgP5u9.js";import"./formatters-B4ehJgEk.js";import"./ModelType-DSs66IM7.js";import"./GenericErrorPage-D-1fKCA7.js";import"./NotFound-CsJ_VLc_.js";import"./PermissionDenied-BDbEipg4.js";import"./use-hover-Cq0v4QX_.js";import"./index-Chjiymov.js";import"./AttachmentLink-D_UWVUZG.js";import"./PageTitle-B4iaHXKM.js";import"./RemoteComponent-uZoHDwds.js";import"./ParameterTable-CGnscd1r.js";import"./CommonForms-DKQecQmS.js";import"./IconUsers-Dr_Sln9A.js";import"./IconCircleDashedCheck-DnGBn8Eq.js";import"./OrderPartsWizard-BcMgRjfh.js";import"./CompanyForms-CIJgkbDe.js";import"./IconAt-rYwKGkPn.js";import"./IconAddressBook-CdNRMeyy.js";import"./RowExpansionIcon-DC7o6kBm.js";import"./IconChevronRight-V14UdNcU.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],Nt=Fe("outline","list-numbers","ListNumbers",Mt);function vt({build:a,output:n,opened:h,close:c}){return e.jsxs(Ae,{position:"bottom",size:"lg",title:e.jsxs(X,{p:"xs",wrap:"nowrap",justify:"space-apart",children:[e.jsx(yt,{size:"lg",children:t._({id:"XqhL5S"})}),e.jsx(oe,{h:"lg"}),e.jsx(ie,{withBorder:!0,p:"sm",children:e.jsxs(X,{gap:"xs",children:[e.jsx(Rt,{part:a.part_detail}),n?.serial&&e.jsxs(U,{size:"sm",children:[t._({id:"AXeJt4"}),": ",n.serial]}),n?.batch&&e.jsxs(U,{size:"sm",children:[t._({id:"Vea6Aj"}),": ",n.batch]})]})}),e.jsx(oe,{h:"lg"})]}),opened:h,onClose:c,withCloseButton:!0,closeOnEscape:!0,closeOnClickOutside:!0,styles:{header:{width:"100%"},title:{width:"100%"}},children:[e.jsx(Be,{}),e.jsx(ie,{p:"md",children:e.jsx(he,{build:a,output:n,params:{tracked:!0}})})]})}function Ut({build:a,refreshBuild:n}){const h=Ot(),c=pe();xt();const o=Re("build-outputs"),r=d.useMemo(()=>a.pk??-1,[a.pk]),s=d.useMemo(()=>a.part??-1,[a.part]),f=be({modelType:l.build}),{data:b,refetch:z}=de({queryKey:["buildoutputtests",s,a],queryFn:async()=>!s||s<0?[]:a?.part_detail?.testable?h.get(S(p.part_test_template_list),{params:{part:s,include_inherited:!0,enabled:!0,required:!0}}).then(i=>i.data):[]}),A=d.useMemo(()=>(b?.length??0)>0,[s,b]),{data:k,refetch:B}=de({queryKey:["trackeditems",r],queryFn:async()=>!r||r<0?[]:h.get(S(p.build_line_list),{params:{build:r,tracked:!0}}).then(i=>i.data)}),j=d.useMemo(()=>(k?.length??0)>0,[k]);d.useEffect(()=>{o.refreshTable()},[b,k,j,A]);const w=d.useCallback(i=>(i?.forEach((x,g)=>{const te=[];let se=0;b?.forEach(R=>{const N=x.tests?.filter(O=>O.template==R.pk).sort((O,Se)=>O.pk<Se.pk?1:-1).shift();R?.required&&N?.result&&(se+=1),te.push({name:R.test_name,result:N?.result??!1})}),i[g].passCount=se,i[g].results=te;let ae=0;k?.forEach(R=>{let N=0;R.allocations?.filter(O=>O.install_into==x.pk)?.forEach(O=>{N+=O.quantity}),N>=R.bom_item_detail.quantity&&(ae+=1)}),i[g].fullyAllocated=ae}),i),[s,r,b,k]),Z=ut({build:a,modalId:"add-build-output"}),G=I({url:S(p.build_output_create,r),title:t._({id:"jgrPxc"}),modalId:"add-build-output",fields:Z,successMessage:t._({id:"U3Kfc5"}),timeout:1e4,initialData:{batch_code:a.batch,location:a.destination??a.part_detail?.default_location},onFormSuccess:()=>{B(),z(),o.refreshTable(!0)}}),[m,_]=d.useState([]),D=pt({build:a,outputs:m,onFormSuccess:()=>{o.refreshTable(!0),n()}}),T=mt({build:a,outputs:m,onFormSuccess:()=>{o.refreshTable(!0),n()}}),E=_t({build:a,outputs:m,onFormSuccess:()=>{o.refreshTable(!0),n()}}),H=Pt({create:!1,partId:s,stockItem:m[0],modalId:"edit-build-output"}),V=_e({url:p.stock_item_list,pk:m[0]?.pk,title:t._({id:"yP367G"}),modalId:"edit-build-output",fields:H,table:o}),W=I({url:p.build_order_deallocate,pk:a.pk,title:t._({id:"ZZL0Jx"}),preFormContent:e.jsx(v,{color:"yellow",icon:e.jsx(Oe,{}),title:t._({id:"ZZL0Jx"}),children:t._({id:"1s7aZ2"})}),fields:{output:{hidden:!0}},initialData:{output:m[0]?.pk},onFormSuccess:()=>{B()}}),u=At({partId:m[0]?.part,trackable:m[0]?.part_detail?.trackable,modalId:"build-output-serialize"}),L=I({url:p.stock_serialize,pk:m[0]?.pk,title:t._({id:"euHSRJ"}),modalId:"build-output-serialize",fields:u,initialData:{quantity:m[0]?.quantity??1,destination:m[0]?.location??a.destination},onFormSuccess:()=>{o.refreshTable(!0),n()}}),q=d.useMemo(()=>[{name:"status",label:t._({id:"uAQUqI"}),description:t._({id:"+Jr1e4"}),choiceFunction:$e(l.stockitem)},et(),tt(),st(),at(),it(),ot(),lt()],[]),M=d.useMemo(()=>({items:o.selectedRecords,model:l.stockitem,refresh:o.refreshTable,filters:{}}),[o.selectedRecords,o.refreshTable]),F=Bt({formProps:M,merge:!1,assign:!1,delete:!1,add:!1,count:!1,remove:!1}),je=d.useMemo(()=>[F.dropdown,e.jsx(Y,{tooltip:t._({id:"jNuqfk"}),icon:e.jsx(y,{icon:"success"}),color:"green",disabled:!o.hasSelectedRecords,onClick:()=>{_(o.selectedRecords),D.open()}},"complete-selected-outputs"),e.jsx(Y,{tooltip:t._({id:"ps+JBt"}),icon:e.jsx(y,{icon:"scrap"}),color:"red",disabled:!o.hasSelectedRecords,onClick:()=>{_(o.selectedRecords),T.open()}},"scrap-selected-outputs"),e.jsx(Y,{tooltip:t._({id:"MXiIO4"}),icon:e.jsx(y,{icon:"cancel"}),color:"red",disabled:!o.hasSelectedRecords,onClick:()=>{_(o.selectedRecords),E.open()}},"cancel-selected-outputs"),e.jsx(rt,{tooltip:t._({id:"jgrPxc"}),hidden:a.external||!c.hasAddRole(C.build),onClick:G.open},"add-build-output")],[a,c,o.selectedRecords,o.hasSelectedRecords,F.dropdown]),ye=d.useCallback(i=>{const x=a?.status==f.PRODUCTION;return[{title:t._({id:"9X8lAk"}),tooltip:t._({id:"kHgU4C"}),color:"blue",hidden:!x||!j||!c.hasChangeRole(C.build),icon:e.jsx(y,{icon:"plus"}),onClick:()=>{_([i]),$()}},{title:t._({id:"kp5oT9"}),tooltip:t._({id:"NLp8ve"}),color:"red",hidden:!x||!j||!c.hasChangeRole(C.build),icon:e.jsx(y,{icon:"minus"}),onClick:()=>{_([i]),W.open()}},{title:t._({id:"Wlr+mY"}),tooltip:t._({id:"+as741"}),color:"blue",hidden:!i.part_detail?.trackable||!!i.serial,icon:e.jsx(y,{icon:"serial"}),onClick:()=>{_([i]),L.open()}},{title:t._({id:"bD8I7O"}),tooltip:t._({id:"BdMeIY"}),color:"green",icon:e.jsx(y,{icon:"success"}),onClick:()=>{_([i]),D.open()}},we({tooltip:t._({id:"yP367G"}),onClick:()=>{_([i]),V.open()}}),{title:t._({id:"5mspUE"}),tooltip:t._({id:"oise/z"}),icon:e.jsx(y,{icon:"scrap"}),color:"red",onClick:()=>{_([i]),T.open()}},{title:t._({id:"dEgA5A"}),tooltip:t._({id:"ewDpt2"}),icon:e.jsx(y,{icon:"cancel"}),color:"red",onClick:()=>{_([i]),E.open()}}]},[f,c,s,j]),ge=d.useMemo(()=>[Dt({}),{accessor:"quantity",ordering:"stock",sortable:!0,switchable:!1,title:t._({id:"gILim+"}),render:i=>{let x=i.quantity;return i.serial&&(x=`# ${i.serial}`),x}},{accessor:"batch",sortable:!0},Tt({accessor:"status",sortable:!0,model:l.stockitem}),Lt({accessor:"location_detail"}),{accessor:"allocations",sortable:!1,switchable:!1,hidden:!j,title:t._({id:"/b62hy"}),render:i=>e.jsx(ce,{progressLabel:!0,value:i.fullyAllocated??0,maximum:k?.length??0})},{accessor:"tests",sortable:!1,switchable:!1,title:t._({id:"E4lFEY"}),hidden:!A,render:i=>{const x=i.results?.map(g=>g&&e.jsxs(X,{justify:"left",wrap:"nowrap",children:[g.result?e.jsx(me,{color:"green"}):e.jsx(kt,{color:"red"}),e.jsx(U,{children:g.name})]},g.name))??[];return e.jsx(nt,{value:e.jsx(ce,{progressLabel:!0,value:i.passCount??0,maximum:b?.length??0}),extra:x,title:t._({id:"isbwWo"})})}}],[r,s,A,j,b,k]),[Ce,{open:$,close:ee}]=Pe(!1),Ie=d.useCallback(()=>{ee(),B()},[ee,B]);return e.jsxs(e.Fragment,{children:[G.modal,D.modal,T.modal,V.modal,W.modal,E.modal,L.modal,F.modals.map(i=>i.modal),e.jsx(vt,{build:a,output:m[0],opened:Ce,close:Ie}),e.jsxs(Q,{gap:"xs",children:[a.external&&e.jsx(v,{color:"blue",icon:e.jsx(jt,{}),title:t._({id:"ckc7Jf"}),children:t._({id:"5pH9Hn"})}),e.jsx(Ee,{tableState:o,url:S(p.stock_item_list),columns:ge,props:{params:{part_detail:!0,location_detail:!0,tests:!0,is_building:!0,build:r},enableLabels:!0,enableReports:!0,modelType:l.stockitem,dataFormatter:w,tableFilters:q,tableActions:je,rowActions:ye,enableSelection:!0,onRowClick:i=>{j&&i.serial&&(_([i]),$())}}})]})]})}function ke(){return e.jsx(v,{color:"blue",icon:e.jsx(fe,{}),title:t._({id:"RBkcix"}),children:e.jsxs(Q,{gap:"xs",children:[e.jsx(U,{children:t._({id:"bcmsL1"})}),e.jsx(U,{children:t._({id:"qMpNaN"})})]})})}function zt({build:a,isLoading:n,hasItems:h}){const c=J({endpoint:p.stock_location_list,pk:a?.take_from,hasPrimaryKey:!0,defaultValue:{}});return n||!a.pk?e.jsx(P,{w:"100%",h:400,animate:!0}):h?e.jsxs(Q,{gap:"xs",children:[c.instance.pk&&e.jsx(v,{color:"blue",icon:e.jsx(xe,{}),title:t._({id:"/00Ond"}),children:e.jsx(ct,{instance:c.instance})}),e.jsx(he,{build:a})]}):e.jsx(ke,{})}function Gt({build:a,isLoading:n,hasItems:h}){return n||!a.pk?e.jsx(P,{w:"100%",h:400,animate:!0}):h?e.jsx(bt,{buildId:a.pk,showPartInfo:!0,allowEdit:!0}):e.jsx(ke,{})}function Hs(){const{id:a}=gt(),n=pe(),h=De(),{instance:c,instanceQuery:o}=J({endpoint:p.build_line_list,params:{build:a,allocations:!1,part_detail:!1,build_detail:!1,bom_item_detail:!1,limit:1},disabled:!a,hasPrimaryKey:!1,defaultValue:{}}),r=be({modelType:l.build}),{instance:s,refreshInstance:f,instanceQuery:b}=J({endpoint:p.build_order_list,pk:a,params:{part_detail:!0},refetchOnMount:!0}),{instance:z,instanceQuery:A}=J({endpoint:p.part_requirements,pk:s?.part,hasPrimaryKey:!0,defaultValue:{}}),k=d.useMemo(()=>{if(b.isFetching)return e.jsx(P,{});const u={...s,can_build:z?.can_build??0},L=[{type:"link",name:"part",label:t._({id:"vgP+9p"}),model:l.part},{type:"text",name:"part_detail.IPN",icon:"part",label:t._({id:"3wXEsN"}),hidden:!s.part_detail?.IPN,copy:!0},{type:"string",name:"part_detail.revision",icon:"revision",label:t._({id:"6LTyxl"}),hidden:!s.part_detail?.revision,copy:!0},{type:"status",name:"status",label:t._({id:"uAQUqI"}),model:l.build},{type:"status",name:"status_custom_key",label:t._({id:"4DvUAJ"}),model:l.build,icon:"status",hidden:!s.status_custom_key||s.status_custom_key==s.status},{type:"boolean",name:"external",label:t._({id:"bVhrVt"}),icon:"manufacturers",hidden:!s.external},{type:"text",name:"reference",label:t._({id:"N2C89m"}),copy:!0},{type:"text",name:"title",label:t._({id:"Nu4oKW"}),icon:"description",copy:!0},{type:"link",name:"parent",icon:"builds",label:t._({id:"jqsG41"}),model_field:"reference",model:l.build,hidden:!s.parent}],q=[{type:"number",name:"quantity",label:t._({id:"Ee+3kG"})},{type:"number",name:"can_build",unit:s.part_detail?.units,label:t._({id:"S/9nwz"}),hidden:A.isFetching},{type:"progressbar",name:"completed",icon:"progress",total:s.quantity,progress:s.completed,label:t._({id:"Mzv4va"})},{type:"link",name:"sales_order",label:t._({id:"LozYBo"}),icon:"sales_orders",model:l.salesorder,model_field:"reference",hidden:!s.sales_order}],M=[{type:"text",name:"issued_by",label:t._({id:"kmUN8p"}),icon:"user",badge:"user",hidden:!s.issued_by},{type:"text",name:"responsible",label:t._({id:"XQACoK"}),badge:"owner",hidden:!s.responsible},{type:"text",name:"project_code_label",label:t._({id:"Sdfr6G"}),icon:"reference",copy:!0,hidden:!s.project_code},{type:"link",name:"take_from",icon:"location",model:l.stocklocation,label:t._({id:"/00Ond"}),backup_value:t._({id:"aZD9Yv"})},{type:"link",name:"destination",icon:"location",model:l.stocklocation,label:t._({id:"o35LCI"}),hidden:!s.destination},{type:"text",name:"batch",label:t._({id:"Vea6Aj"}),hidden:!s.batch,copy:!0}],F=[{type:"date",name:"creation_date",label:t._({id:"d+F6q9"}),icon:"calendar",copy:!0,hidden:!s.creation_date},{type:"date",name:"start_date",label:t._({id:"D3iCkb"}),icon:"calendar",copy:!0,hidden:!s.start_date},{type:"date",name:"target_date",label:t._({id:"ZmykKo"}),icon:"calendar",copy:!0,hidden:!s.target_date},{type:"date",name:"completion_date",label:t._({id:"qqWcBV"}),icon:"calendar",copy:!0,hidden:!s.completion_date}];return e.jsxs(He,{children:[e.jsxs(le,{grow:!0,children:[e.jsx(Ke,{appRole:C.part,apiPath:p.part_list,src:s.part_detail?.image??s.part_detail?.thumbnail,pk:s.part}),e.jsx(le.Col,{span:{base:12,sm:8},children:e.jsx(K,{fields:L,item:u})})]}),e.jsx(K,{fields:q,item:u}),e.jsx(K,{fields:M,item:u}),e.jsx(K,{fields:F,item:u})]})},[s,b,z,A.isFetching]),B=d.useMemo(()=>[{name:"details",label:t._({id:"98Q4bz"}),icon:e.jsx(fe,{}),content:k},{name:"line-items",label:t._({id:"T2s1M7"}),icon:e.jsx(Nt,{}),content:e.jsx(zt,{build:s,isLoading:o.isFetching||o.isLoading,hasItems:c?.count>0})},{name:"allocated-stock",label:t._({id:"MD2yP5"}),icon:e.jsx(Ct,{}),hidden:s.status==r.COMPLETE||s.status==r.CANCELLED||(c?.count??0)<=0,content:e.jsx(Gt,{build:s,isLoading:o.isFetching||o.isLoading,hasItems:c?.count>0})},{name:"consumed-stock",label:t._({id:"US3GCq"}),icon:e.jsx(Et,{}),hidden:(c?.count??0)<=0,content:e.jsx(ue,{allowAdd:!1,tableName:"build-consumed",showLocation:!1,allowReturn:!0,params:{consumed_by:a}})},{name:"incomplete-outputs",label:t._({id:"E9en8O"}),icon:e.jsx(It,{}),content:s.pk?e.jsx(Ut,{build:s,refreshBuild:f}):e.jsx(P,{}),hidden:s.status==r.COMPLETE||s.status==r.CANCELLED},{name:"complete-outputs",label:t._({id:"Mzv4va"}),icon:e.jsx(St,{}),content:e.jsx(ue,{allowAdd:!1,tableName:"completed-build-outputs",params:{build:a,is_building:!1}})},{name:"external-purchase-orders",label:t._({id:"X0hvRl"}),icon:e.jsx(Ft,{}),content:s.pk?e.jsx(wt,{externalBuildId:s.pk}):e.jsx(P,{}),hidden:!n.hasViewRole(C.purchase_order)||!s.external||!h.isSet("BUILDORDER_EXTERNAL_BUILDS")},{name:"child-orders",label:t._({id:"CVlgqS"}),icon:e.jsx(xe,{}),content:s.pk?e.jsx(ft,{parentBuildId:s.pk}):e.jsx(P,{})},{name:"test-results",label:t._({id:"isbwWo"}),icon:e.jsx(qt,{}),hidden:!s.part_detail?.testable,content:s.pk?e.jsx(ht,{buildId:s.pk,partId:s.part}):e.jsx(P,{})},Xe({model_type:l.build,model_id:s.pk}),Je({model_type:l.build,model_id:s.pk}),Qe({model_type:l.build,model_id:s.pk})],[s,a,n,r,h,o.isFetching,o.isLoading,c]),j=ne({create:!1,modalId:"edit-build-order"}),w=_e({url:p.build_order_list,pk:s.pk,title:t._({id:"B7ynKf"}),modalId:"edit-build-order",fields:j,onFormSuccess:f}),Z=d.useMemo(()=>{const u={...s};return delete u.reference,u},[s]),G=ne({create:!1,modalId:"duplicate-build-order"}),m=I({url:p.build_order_list,title:t._({id:"59jtLx"}),modalId:"duplicate-build-order",fields:G,initialData:Z,follow:!0,modelType:l.build}),_=I({url:S(p.build_order_cancel,s.pk),title:t._({id:"MTYJu1"}),onFormSuccess:f,successMessage:t._({id:"H5qWhm"}),preFormWarning:t._({id:"MPFqR0"}),fields:{remove_allocated_stock:{},remove_incomplete_outputs:{}}}),D=I({url:S(p.build_order_hold,s.pk),title:t._({id:"hZIvSn"}),onFormSuccess:f,preFormWarning:t._({id:"3Wfk51"}),successMessage:t._({id:"0NH/ob"})}),T=I({url:S(p.build_order_issue,s.pk),title:t._({id:"Z4Rl+B"}),onFormSuccess:f,preFormWarning:t._({id:"lLiNZC"}),successMessage:t._({id:"R/WvFK"})}),E=d.useMemo(()=>{const u=(c?.count??0)>0;return{accept_overallocated:{hidden:!u},accept_unallocated:{hidden:!u},accept_incomplete:{}}},[c.count]),H=I({url:S(p.build_order_complete,s.pk),title:t._({id:"Q/TP3B"}),onFormSuccess:f,preFormContent:e.jsx(v,{color:"green",icon:e.jsx(me,{}),title:t._({id:"DYITap"})}),successMessage:t._({id:"W7TghJ"}),fields:E}),V=d.useMemo(()=>{const u=n.hasChangeRole(C.build),L=u&&(s.status==r.PENDING||s.status==r.ON_HOLD),q=u&&s.status==r.PRODUCTION,M=u&&(s.status==r.PENDING||s.status==r.PRODUCTION),F=u&&(s.status==r.PENDING||s.status==r.ON_HOLD||s.status==r.PRODUCTION);return[e.jsx(re,{title:t._({id:"WajCDs"}),icon:"issue",hidden:!L,color:"blue",onClick:T.open}),e.jsx(re,{title:t._({id:"NPZqBL"}),icon:"complete",hidden:!q,color:"green",onClick:H.open}),e.jsx(Le,{model:l.build,id:s.pk}),e.jsx(qe,{model:l.build,pk:s.pk,hash:s?.barcode_hash}),e.jsx(Me,{modelType:l.build,items:[s.pk],enableLabels:!0,enableReports:!0}),e.jsx(Ne,{tooltip:t._({id:"tDgG1Y"}),actions:[ve({onClick:()=>w.open(),hidden:!u,tooltip:t._({id:"mVeaUg"})}),Ue({onClick:()=>m.open(),tooltip:t._({id:"oi/3Pq"}),hidden:!n.hasAddRole(C.build)}),ze({tooltip:t._({id:"20mLBC"}),hidden:!M,onClick:D.open}),Ge({tooltip:t._({id:"tVJk4q"}),onClick:_.open,hidden:!F})]})]},[a,s,n,r]),W=d.useMemo(()=>b.isFetching?[]:[e.jsx(dt,{status:s.status_custom_key,type:l.build,options:{size:"lg"}}),e.jsx(We,{label:t._({id:"bVhrVt"}),color:"blue",visible:s.external},"external")],[s,b]);return e.jsxs(e.Fragment,{children:[w.modal,m.modal,_.modal,D.modal,T.modal,H.modal,e.jsx(Ve,{query:b,requiredRole:C.build,children:e.jsxs(Q,{gap:"xs",children:[e.jsx(Ze,{title:`${t._({id:"YxwWvi"})}: ${s.reference}`,subtitle:`${s.quantity} x ${s.part_detail?.full_name}`,badges:W,editAction:w.open,editEnabled:n.hasChangePermission(l.part),imageUrl:s.part_detail?.image??s.part_detail?.thumbnail,breadcrumbs:[{name:t._({id:"3ctapx"}),url:"/manufacturing"}],lastCrumb:[{name:s.reference,url:Te(l.build,s.pk)}],actions:V}),e.jsx(Ye,{pageKey:"build",panels:B,instance:s,reloadInstance:f,model:l.build,id:s.pk})]})})]})}export{Hs as default};
//# sourceMappingURL=BuildDetail-DqqT307k.js.map
