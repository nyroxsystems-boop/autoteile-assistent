{"version":3,"file":"UseStockAdjustActions-BrgagWbF.js","sources":["../../../../../../frontend/src/hooks/UseStockAdjustActions.tsx"],"sourcesContent":["import { UserRoles } from '@lib/index';\nimport type { StockOperationProps } from '@lib/types/Forms';\nimport type { UseModalReturn } from '@lib/types/Modals';\nimport { t } from '@lingui/core/macro';\nimport { type ReactNode, useMemo } from 'react';\nimport type { ActionDropdownItem } from '../components/items/ActionDropdown';\nimport { ActionDropdown } from '../components/items/ActionDropdown';\nimport {\n  useAddStockItem,\n  useAssignStockItem,\n  useChangeStockStatus,\n  useCountStockItem,\n  useDeleteStockItem,\n  useMergeStockItem,\n  useRemoveStockItem,\n  useReturnStockItem,\n  useTransferStockItem\n} from '../forms/StockForms';\nimport { InvenTreeIcon } from '../functions/icons';\nimport { useUserState } from '../states/UserState';\n\ninterface StockAdjustActionProps {\n  formProps: StockOperationProps;\n  enabled?: boolean;\n  add?: boolean;\n  assign?: boolean;\n  count?: boolean;\n  changeStatus?: boolean;\n  delete?: boolean;\n  merge?: boolean;\n  remove?: boolean;\n  transfer?: boolean;\n  return?: boolean;\n}\n\ninterface StockAdjustActionReturnProps {\n  modals: UseModalReturn[];\n  dropdown: ReactNode;\n  menuActions: ActionDropdownItem[];\n  hasActions: boolean;\n}\n\n/**\n * Hook to provide an interface for stock transfer actions.\n * - Provides a set of modals for creating, editing, and deleting stock transfers.\n * - Provides a set of menu actions for opening the modals.\n */\n\nexport function useStockAdjustActions(\n  props: StockAdjustActionProps\n): StockAdjustActionReturnProps {\n  const user = useUserState();\n\n  // The available modals for stock adjustment actions\n  const addStock = useAddStockItem(props.formProps);\n  const assignStock = useAssignStockItem(props.formProps);\n  const changeStatus = useChangeStockStatus(props.formProps);\n  const countStock = useCountStockItem(props.formProps);\n  const deleteStock = useDeleteStockItem(props.formProps);\n  const mergeStock = useMergeStockItem(props.formProps);\n  const removeStock = useRemoveStockItem(props.formProps);\n  const transferStock = useTransferStockItem(props.formProps);\n  const returnStock = useReturnStockItem(props.formProps);\n\n  // Construct a list of modals available for stock adjustment actions\n  const modals: UseModalReturn[] = useMemo(() => {\n    const modals: UseModalReturn[] = [];\n\n    if (!user.hasChangeRole(UserRoles.stock)) {\n      return [];\n    }\n\n    props.add != false && modals.push(addStock);\n    props.assign != false && modals.push(assignStock);\n    props.count != false && modals.push(countStock);\n    props.changeStatus != false && modals.push(changeStatus);\n    props.merge != false && modals.push(mergeStock);\n    props.remove != false && modals.push(removeStock);\n    props.transfer != false && modals.push(transferStock);\n    props.return === true && modals.push(returnStock);\n    props.delete != false &&\n      user.hasDeleteRole(UserRoles.stock) &&\n      modals.push(deleteStock);\n\n    return modals;\n  }, [props, user]);\n\n  // Construct a list of actions available in the stock adjustment dropdown menu\n  const menuActions: ActionDropdownItem[] = useMemo(() => {\n    const menuActions: ActionDropdownItem[] = [];\n\n    if (!user.hasChangeRole(UserRoles.stock)) {\n      return [];\n    }\n\n    props.count != false &&\n      menuActions.push({\n        name: t`Count Stock`,\n        icon: <InvenTreeIcon icon='stocktake' iconProps={{ color: 'blue' }} />,\n        tooltip: t`Count selected stock items`,\n        onClick: () => {\n          countStock.open();\n        }\n      });\n\n    props.add != false &&\n      menuActions.push({\n        name: t`Add Stock`,\n        icon: <InvenTreeIcon icon='add' iconProps={{ color: 'green' }} />,\n        tooltip: t`Add to selected stock items`,\n        onClick: () => {\n          addStock.open();\n        }\n      });\n\n    props.remove != false &&\n      menuActions.push({\n        name: t`Remove Stock`,\n        icon: <InvenTreeIcon icon='remove' iconProps={{ color: 'red' }} />,\n        tooltip: t`Remove from selected stock items`,\n        onClick: () => {\n          removeStock.open();\n        }\n      });\n\n    props.transfer != false &&\n      menuActions.push({\n        name: t`Transfer Stock`,\n        icon: <InvenTreeIcon icon='transfer' iconProps={{ color: 'blue' }} />,\n        tooltip: t`Transfer selected stock items`,\n        onClick: () => {\n          transferStock.open();\n        }\n      });\n\n    props.merge != false &&\n      menuActions.push({\n        name: t`Merge Stock`,\n        icon: <InvenTreeIcon icon='merge' />,\n        tooltip: t`Merge selected stock items`,\n        onClick: () => {\n          mergeStock.open();\n        }\n      });\n\n    props.changeStatus != false &&\n      menuActions.push({\n        name: t`Change Status`,\n        icon: <InvenTreeIcon icon='info' iconProps={{ color: 'blue' }} />,\n        tooltip: t`Change status of selected stock items`,\n        onClick: () => {\n          changeStatus.open();\n        }\n      });\n\n    props.assign != false &&\n      menuActions.push({\n        name: t`Assign Stock`,\n        icon: <InvenTreeIcon icon='customer' />,\n        tooltip: t`Assign selected stock items to a customer`,\n        onClick: () => {\n          assignStock.open();\n        }\n      });\n\n    props.return === true &&\n      menuActions.push({\n        name: t`Return Stock`,\n        icon: <InvenTreeIcon icon='return' iconProps={{ color: 'blue' }} />,\n        tooltip: t`Return selected items into stock`,\n        onClick: () => {\n          returnStock.open();\n        }\n      });\n\n    props.delete != false &&\n      menuActions.push({\n        name: t`Delete Stock`,\n        icon: <InvenTreeIcon icon='delete' iconProps={{ color: 'red' }} />,\n        tooltip: t`Delete selected stock items`,\n        disabled: !user.hasDeleteRole(UserRoles.stock),\n        onClick: () => {\n          deleteStock.open();\n        }\n      });\n\n    return menuActions;\n  }, [props, user]);\n\n  // Determine if there are any items selected\n  const hasItems: boolean = useMemo(() => {\n    return (props.formProps?.items?.length ?? 0) > 0;\n  }, [props.formProps.items]);\n\n  // Determine if there are any actions available\n  const hasActions: boolean = useMemo(() => {\n    return menuActions.length > 0;\n  }, [menuActions]);\n\n  // Construct a dropdown menu for stock actions\n  const dropdown: ReactNode = useMemo(() => {\n    return (\n      <ActionDropdown\n        key='stock-adjust-actions'\n        tooltip={t`Stock Actions`}\n        icon={<InvenTreeIcon icon='stock' />}\n        actions={menuActions}\n        disabled={\n          props.enabled != true && (props.enabled == false || !hasItems)\n        }\n        hidden={!hasActions}\n      />\n    );\n  }, [props.enabled, hasActions, hasItems, menuActions]);\n\n  return {\n    modals,\n    menuActions,\n    hasActions,\n    dropdown\n  };\n}\n"],"names":["useStockAdjustActions","props","user","useUserState","addStock","useAddStockItem","formProps","assignStock","useAssignStockItem","changeStatus","useChangeStockStatus","countStock","useCountStockItem","deleteStock","useDeleteStockItem","mergeStock","useMergeStockItem","removeStock","useRemoveStockItem","transferStock","useTransferStockItem","returnStock","useReturnStockItem","modals","useMemo","hasChangeRole","UserRoles","stock","add","push","assign","count","merge","remove","transfer","return","delete","hasDeleteRole","menuActions","name","_i18n","_","id","icon","jsx","InvenTreeIcon","color","tooltip","onClick","open","disabled","hasItems","items","length","hasActions","dropdown","ActionDropdown","enabled"],"mappings":"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"}