{"version":3,"file":"ParametricDataTable-DArALdrx.js","sources":["../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconTable.mjs","../../../../../../frontend/src/components/buttons/SegmentedIconControl.tsx","../../../../../../frontend/src/components/panels/SegmentedControlPanel.tsx","../../../../../../frontend/src/tables/general/ParametricDataTableFilters.tsx","../../../../../../frontend/src/tables/general/ParametricDataTable.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M3 10h18\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M10 3v18\", \"key\": \"svg-2\" }]];\nconst IconTable = createReactComponent(\"outline\", \"table\", \"Table\", __iconNode);\n\nexport { __iconNode, IconTable as default };\n//# sourceMappingURL=IconTable.mjs.map\n","import {\n  ActionIcon,\n  type MantineColor,\n  type MantineSize,\n  SegmentedControl,\n  Tooltip\n} from '@mantine/core';\nimport type { ReactNode } from 'react';\n\nexport type SegmentedIconControlItem = {\n  label: string;\n  value: string;\n  icon: ReactNode;\n};\n\nexport default function SegmentedIconControl({\n  data,\n  value,\n  size = 'sm',\n  color,\n  onChange\n}: {\n  data: SegmentedIconControlItem[];\n  value: string;\n  size?: MantineSize;\n  color?: MantineColor;\n  onChange: (value: string) => void;\n}) {\n  return (\n    <SegmentedControl\n      value={value}\n      onChange={onChange}\n      data={data.map((item) => ({\n        value: item.value,\n        label: (\n          <Tooltip label={item.label} position='top-end'>\n            <ActionIcon\n              variant='transparent'\n              color={color}\n              size={size}\n              aria-label={`segmented-icon-control-${item.value}`}\n              onClick={() => onChange(item.value)}\n            >\n              {item.icon}\n            </ActionIcon>\n          </Tooltip>\n        )\n      }))}\n    />\n  );\n}\n","import SegmentedIconControl from '../buttons/SegmentedIconControl';\nimport type { PanelType } from './Panel';\n\nexport type SegmentedControlPanelSelection = {\n  value: string;\n  label: string;\n  icon: React.ReactNode;\n  content: React.ReactNode;\n};\n\ninterface SegmentedPanelType extends PanelType {\n  options: SegmentedControlPanelSelection[];\n  selection: string;\n  onChange: (value: string) => void;\n}\n\n/**\n * Display a panel which can be used to display multiple options,\n * based on a built-in segmented control.\n */\nexport default function SegmentedControlPanel(\n  props: SegmentedPanelType\n): PanelType {\n  // Extract the content based on the selection\n  let content = null;\n\n  for (const option of props.options) {\n    if (option.value === props.selection) {\n      content = option.content;\n      break;\n    }\n  }\n\n  if (content === null && props.options.length > 0) {\n    content = props.options[0].content;\n  }\n\n  return {\n    ...props,\n    content: content,\n    controls: (\n      <SegmentedIconControl\n        value={props.selection}\n        onChange={props.onChange}\n        data={props.options.map((option: any) => ({\n          value: option.value,\n          label: option.label,\n          icon: option.icon\n        }))}\n      />\n    )\n  };\n}\n","import { t } from '@lingui/core/macro';\nimport { Divider, Group, Input, Select, Stack, TextInput } from '@mantine/core';\nimport { useEffect, useMemo, useState } from 'react';\n\n// Define set of allowed operators for parameter filters\nexport const PARAMETER_FILTER_OPERATORS: Record<string, string> = {\n  '=': '',\n  '>': '_gt',\n  '>=': '_gte',\n  '<': '_lt',\n  '<=': '_lte',\n  '!=': '_ne',\n  '~': '_icontains'\n};\n\ntype ParameterFilterProps = {\n  template: any;\n  filters: any;\n  setFilter: (templateId: number, value: string, operator: string) => void;\n  clearFilter: (templateId: number, operator?: string) => void;\n  closeFilter: () => void;\n};\n\n/**\n * UI element for viewing and changing boolean filter associated with a given parameter template\n */\nfunction BooleanParameterFilter(props: ParameterFilterProps) {\n  const filterValue = useMemo(() => {\n    return props.filters['='] ?? '';\n  }, [props.filters]);\n\n  return (\n    <Select\n      aria-label={`filter-${props.template.name}`}\n      data={[\n        { value: 'true', label: t`True` },\n        { value: 'false', label: t`False` }\n      ]}\n      value={filterValue}\n      clearable={true}\n      defaultValue={filterValue}\n      onClear={() => {\n        props.clearFilter(props.template.pk, '');\n        props.closeFilter();\n      }}\n      onChange={(val) => props.setFilter(props.template.pk, val ?? '', '=')}\n      placeholder={t`Select a choice`}\n      clearButtonProps={{\n        'aria-label': `clear-filter-${props.template.name}`\n      }}\n    />\n  );\n}\n\n/*\n * UI element for viewing and changing choice filter associated with a given parameter template.\n * In this case, the template defines a set of choices that can be selected.\n */\nfunction ChoiceParameterFilter(props: ParameterFilterProps) {\n  const filterValue = useMemo(() => {\n    return props.filters['='] ?? '';\n  }, [props.filters]);\n\n  return (\n    <Select\n      aria-label={`filter-${props.template.name}`}\n      data={props.template.choices\n        .split(',')\n        .map((choice: string) => choice.trim())}\n      value={filterValue}\n      defaultValue={filterValue}\n      onChange={(val) => props.setFilter(props.template.pk, val ?? '', '=')}\n      onClear={() => {\n        props.clearFilter(props.template.pk, '');\n        props.closeFilter();\n      }}\n      clearButtonProps={{\n        'aria-label': `clear-filter-${props.template.name}`\n      }}\n      placeholder={t`Select a choice`}\n      searchable\n      clearable\n      // rightSection={<ClearFilterButton props={props} />}\n    />\n  );\n}\n\nfunction GenericFilterRow({\n  props,\n  value,\n  operator,\n  readonly\n}: {\n  props: ParameterFilterProps;\n  value: string;\n  operator: string;\n  readonly?: boolean;\n}) {\n  const placeholder: string = useMemo(() => {\n    let placeholder = t`Enter a value`;\n\n    if (props.template.units) {\n      placeholder += ` [${props.template.units}]`;\n    }\n\n    return placeholder;\n  }, [props.template.units]);\n\n  const [op, setOp] = useState<string>(operator);\n\n  useEffect(() => {\n    setOp(operator);\n  }, [operator]);\n\n  return (\n    <Group gap='xs' wrap='nowrap'>\n      <div onMouseDown={(e) => e.stopPropagation()} style={{ width: 75 }}>\n        <Select\n          onClick={(event) => {\n            event?.stopPropagation();\n          }}\n          aria-label={`filter-${props.template.name}-operator`}\n          data={Object.keys(PARAMETER_FILTER_OPERATORS)}\n          value={op}\n          searchable={false}\n          clearable={false}\n          defaultValue={'='}\n          onChange={(value) => {\n            setOp(value ?? '=');\n          }}\n          size='sm'\n          disabled={readonly}\n          width={75}\n        />\n      </div>\n      <TextInput\n        aria-label={`filter-${props.template.name}`}\n        placeholder={placeholder}\n        defaultValue={value}\n        onKeyDown={(event) => {\n          if (event.key === 'Enter') {\n            props.setFilter(\n              props.template.pk,\n              event.currentTarget.value || '',\n              op\n            );\n            props.closeFilter();\n          }\n        }}\n        rightSection={\n          readonly && (\n            <Input.ClearButton\n              onClick={(event) => {\n                event.stopPropagation();\n                props.clearFilter(props.template.pk, op);\n                props.closeFilter();\n              }}\n              aria-label={`clear-filter-${props.template.name}`}\n            />\n          )\n        }\n      />\n    </Group>\n  );\n}\n\n/*\n * In this case, the template is generic and does not have a specific type.\n * Here, the user can apply multiple filter types (e.g., '=', '<', '>')\n */\nfunction GenericParameterFilter(props: ParameterFilterProps) {\n  return (\n    <Stack gap='xs'>\n      {/* Render a row for each operator defined in the filters object */}\n      {Object.keys(props.filters).map((operator) => {\n        return (\n          <GenericFilterRow\n            props={props}\n            value={props.filters[operator] ?? ''}\n            operator={operator}\n            readonly\n          />\n        );\n      })}\n      <Divider />\n      {/* Render an empty row for adding a new filter */}\n      <GenericFilterRow props={props} value='' operator='=' />\n    </Stack>\n  );\n}\n\n/**\n * UI element for viewing and changing filter(s) associated with a given parameter template\n * @param template - The parameter template object\n * @param filters - The current filters applied to the table\n * @param setFilter - Function to set a filter for the template\n * @param clearFilter - Function to clear the filter for the template\n * @param closeFilter - Function to close the filter UI\n */\nexport function ParameterFilter(props: ParameterFilterProps) {\n  // Filter input element (depends on template type)\n  return useMemo(() => {\n    if (props.template.checkbox) {\n      return <BooleanParameterFilter {...props} />;\n    } else if (!!props.template.choices) {\n      return <ChoiceParameterFilter {...props} />;\n    } else {\n      return <GenericParameterFilter {...props} />;\n    }\n  }, [props]);\n}\n","import { cancelEvent } from '@lib/functions/Events';\nimport {\n  ApiEndpoints,\n  type ApiFormFieldSet,\n  type ModelType,\n  UserRoles,\n  YesNoButton,\n  apiUrl,\n  formatDecimal,\n  getDetailUrl,\n  navigateToLink\n} from '@lib/index';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { t } from '@lingui/core/macro';\nimport { Group } from '@mantine/core';\nimport { useHover } from '@mantine/hooks';\nimport { IconCirclePlus } from '@tabler/icons-react';\nimport { useQuery } from '@tanstack/react-query';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useApi } from '../../contexts/ApiContext';\nimport { useParameterFields } from '../../forms/CommonForms';\nimport {\n  useCreateApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport { InvenTreeTable } from '../InvenTreeTable';\nimport { TableHoverCard } from '../TableHoverCard';\nimport {\n  PARAMETER_FILTER_OPERATORS,\n  ParameterFilter\n} from './ParametricDataTableFilters';\n\n// Render an individual parameter cell\nfunction ParameterCell({\n  record,\n  template,\n  canEdit\n}: Readonly<{\n  record: any;\n  template: any;\n  canEdit: boolean;\n}>) {\n  const { hovered, ref } = useHover();\n\n  // Find matching template parameter\n  const parameter = useMemo(() => {\n    return record.parameters?.find((p: any) => p.template == template.pk);\n  }, [record, template]);\n\n  const extra: any[] = [];\n\n  // Format the value for display\n  const value: ReactNode = useMemo(() => {\n    let v: any = parameter?.data;\n\n    // Handle boolean values\n    if (template?.checkbox && v != undefined) {\n      v = <YesNoButton value={parameter.data} />;\n    }\n\n    return v;\n  }, [parameter, template]);\n\n  if (\n    template.units &&\n    parameter &&\n    parameter.data_numeric &&\n    parameter.data_numeric != parameter.data\n  ) {\n    const numeric = formatDecimal(parameter.data_numeric, { digits: 15 });\n    extra.push(`${numeric} [${template.units}]`);\n  }\n\n  if (hovered && canEdit) {\n    extra.push(t`Click to edit`);\n  }\n\n  return (\n    <div>\n      <Group grow ref={ref} justify='space-between'>\n        <Group grow>\n          <TableHoverCard\n            value={value ?? '-'}\n            extra={extra}\n            icon={hovered && canEdit ? 'edit' : 'info'}\n            title={template.name}\n          />\n        </Group>\n      </Group>\n    </div>\n  );\n}\n\n/**\n * A table which displays parametric data for generic model types.\n * The table can be extended by passing in additional column, filters, and actions.\n */\nexport default function ParametricDataTable({\n  modelType,\n  endpoint,\n  queryParams,\n  customFilters,\n  customColumns\n}: {\n  modelType: ModelType;\n  endpoint: ApiEndpoints | string;\n  queryParams?: Record<string, any>;\n  customFilters?: TableFilter[];\n  customColumns?: TableColumn[];\n}) {\n  const api = useApi();\n  const table = useTable(`parametric-data-${modelType}`);\n  const user = useUserState();\n  const navigate = useNavigate();\n\n  // Fetch all active parameter templates for the given model type\n  const parameterTemplates = useQuery({\n    queryKey: ['parameter-templates', modelType],\n    queryFn: async () => {\n      return api\n        .get(apiUrl(ApiEndpoints.parameter_template_list), {\n          params: {\n            active: true,\n            for_model: modelType,\n            exists_for_model: modelType\n          }\n        })\n        .then((response) => response.data);\n    },\n    refetchOnMount: true\n  });\n\n  /* Store filters against selected part parameters.\n   * These are stored in the format:\n   * {\n   *   parameter_1: {\n   *    '=': 'value1',\n   *    '<': 'value2',\n   *    ...\n   *   },\n   *   parameter_2: {\n   *    '=': 'value3',\n   *   },\n   *   ...\n   * }\n   *\n   * Which allows multiple filters to be applied against each parameter template.\n   */\n  const [parameterFilters, setParameterFilters] = useState<any>({});\n\n  /* Remove filters for a specific parameter template\n   * - If no operator is specified, remove all filters for this template\n   * - If an operator is specified, remove filters for that operator only\n   */\n  const clearParameterFilter = useCallback(\n    (templateId: number, operator?: string) => {\n      const filterName = `parameter_${templateId}`;\n\n      if (!operator) {\n        // If no operator is specified, remove all filters for this template\n        setParameterFilters((prev: any) => {\n          const newFilters = { ...prev };\n          // Remove any filters that match the template ID\n          Object.keys(newFilters).forEach((key: string) => {\n            if (key == filterName) {\n              delete newFilters[key];\n            }\n          });\n          return newFilters;\n        });\n\n        return;\n      }\n\n      // An operator is specified, so we remove filters for that operator only\n      setParameterFilters((prev: any) => {\n        const filters = { ...prev };\n\n        const paramFilters = filters[filterName] || {};\n\n        if (paramFilters[operator] !== undefined) {\n          // Remove the specific operator filter\n          delete paramFilters[operator];\n        }\n\n        return {\n          ...filters,\n          [filterName]: paramFilters\n        };\n      });\n\n      table.refreshTable();\n    },\n    [setParameterFilters, table.refreshTable]\n  );\n\n  /**\n   * Add (or update) a filter for a specific parameter template.\n   * @param templateId - The ID of the parameter template to filter on.\n   * @param value - The value to filter by.\n   * @param operator - The operator to use for filtering (e.g., '=', '<', '>', etc.).\n   */\n  const addParameterFilter = useCallback(\n    (templateId: number, value: string, operator: string) => {\n      const filterName = `parameter_${templateId}`;\n\n      const filterValue = value?.toString().trim() ?? '';\n\n      if (filterValue.length > 0) {\n        setParameterFilters((prev: any) => {\n          const filters = { ...prev };\n          const paramFilters = filters[filterName] || {};\n\n          paramFilters[operator] = filterValue;\n\n          return {\n            ...filters,\n            [filterName]: paramFilters\n          };\n        });\n\n        table.refreshTable();\n      }\n    },\n    [setParameterFilters, clearParameterFilter, table.refreshTable]\n  );\n\n  // Construct the query filters for the table based on the parameter filters\n  const parametricQueryFilters = useMemo(() => {\n    const filters: Record<string, string> = {};\n\n    Object.keys(parameterFilters).forEach((key: string) => {\n      const paramFilters: any = parameterFilters[key];\n\n      Object.keys(paramFilters).forEach((operator: string) => {\n        const name = `${key}${PARAMETER_FILTER_OPERATORS[operator] || ''}`;\n        const value = paramFilters[operator];\n\n        filters[name] = value;\n      });\n    });\n\n    return filters;\n  }, [parameterFilters]);\n\n  const [selectedInstance, setSelectedInstance] = useState<number>(-1);\n  const [selectedTemplate, setSelectedTemplate] = useState<number | null>(null);\n  const [selectedParameter, setSelectedParameter] = useState<number>(-1);\n\n  const parameterFields: ApiFormFieldSet = useParameterFields({\n    modelType: modelType,\n    modelId: selectedInstance\n  });\n\n  const addParameter = useCreateApiFormModal({\n    url: ApiEndpoints.parameter_list,\n    title: t`Add Parameter`,\n    fields: useMemo(() => ({ ...parameterFields }), [parameterFields]),\n    focus: 'data',\n    onFormSuccess: (parameter: any) => {\n      updateParameterRecord(selectedInstance, parameter);\n\n      // Ensure that the parameter template is included in the table\n      const template = parameterTemplates.data.find(\n        (t: any) => t.pk == parameter.template\n      );\n\n      if (!template) {\n        // Reload the parameter templates\n        parameterTemplates.refetch();\n      }\n    },\n    initialData: {\n      part: selectedInstance,\n      template: selectedTemplate\n    }\n  });\n\n  const editParameter = useEditApiFormModal({\n    url: ApiEndpoints.parameter_list,\n    title: t`Edit Parameter`,\n    pk: selectedParameter,\n    fields: useMemo(() => ({ ...parameterFields }), [parameterFields]),\n    focus: 'data',\n    onFormSuccess: (parameter: any) => {\n      updateParameterRecord(selectedInstance, parameter);\n    }\n  });\n\n  // Update a single parameter record in the table\n  const updateParameterRecord = useCallback(\n    (part: number, parameter: any) => {\n      const records = table.records;\n      const recordIndex = records.findIndex((record: any) => record.pk == part);\n\n      if (recordIndex < 0) {\n        // No matching part: reload the entire table\n        table.refreshTable();\n        return;\n      }\n\n      const parameterIndex = records[recordIndex].parameters.findIndex(\n        (p: any) => p.pk == parameter.pk\n      );\n\n      if (parameterIndex < 0) {\n        // No matching parameter - append new parameter\n        records[recordIndex].parameters.push(parameter);\n      } else {\n        records[recordIndex].parameters[parameterIndex] = parameter;\n      }\n\n      table.updateRecord(records[recordIndex]);\n    },\n    [table.records, table.updateRecord]\n  );\n\n  const parameterColumns: TableColumn[] = useMemo(() => {\n    const data = parameterTemplates?.data || [];\n\n    return data.map((template: any) => {\n      let title = template.name;\n\n      if (template.units) {\n        title += ` [${template.units}]`;\n      }\n\n      const filters = parameterFilters[`parameter_${template.pk}`] || {};\n\n      return {\n        accessor: `parameter_${template.pk}`,\n        title: title,\n        sortable: true,\n        extra: {\n          template: template.pk\n        },\n        render: (record: any) => (\n          <ParameterCell\n            record={record}\n            template={template}\n            canEdit={user.hasChangeRole(UserRoles.part)}\n          />\n        ),\n        filtering: Object.keys(filters).length > 0,\n        filter: ({ close }: { close: () => void }) => {\n          return (\n            <ParameterFilter\n              template={template}\n              filters={parameterFilters[`parameter_${template.pk}`] || {}}\n              setFilter={addParameterFilter}\n              clearFilter={clearParameterFilter}\n              closeFilter={close}\n            />\n          );\n        }\n      };\n    });\n  }, [user, parameterTemplates.data, parameterFilters]);\n\n  // Callback function when a parameter cell is clicked\n  const onParameterClick = useCallback((template: number, instance: any) => {\n    setSelectedTemplate(template);\n    setSelectedInstance(instance.pk);\n    const parameter = instance.parameters?.find(\n      (p: any) => p.template == template\n    );\n\n    if (parameter) {\n      setSelectedParameter(parameter.pk);\n      editParameter.open();\n    } else {\n      addParameter.open();\n    }\n  }, []);\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [...(customFilters || [])];\n  }, [customFilters]);\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [...(customColumns || []), ...parameterColumns];\n  }, [customColumns, parameterColumns]);\n\n  const rowActions = useCallback(\n    (record: any) => {\n      return [\n        {\n          title: t`Add Parameter`,\n          icon: <IconCirclePlus />,\n          color: 'green',\n          hidden: !user.hasAddPermission(modelType),\n          onClick: () => {\n            setSelectedInstance(record.pk);\n            setSelectedTemplate(null);\n            addParameter.open();\n          }\n        }\n      ];\n    },\n    [modelType, user]\n  );\n\n  return (\n    <>\n      {addParameter.modal}\n      {editParameter.modal}\n      <InvenTreeTable\n        url={apiUrl(endpoint)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          enableDownload: true,\n          rowActions: rowActions,\n          tableFilters: tableFilters,\n          params: {\n            ...queryParams,\n            parameters: true,\n            ...parametricQueryFilters\n          },\n          modelType: modelType,\n          onCellClick: ({ event, record, index, column, columnIndex }) => {\n            cancelEvent(event);\n\n            // Is this a \"parameter\" cell?\n            if (column?.accessor?.toString()?.startsWith('parameter_')) {\n              const col = column as any;\n              onParameterClick(col.extra.template, record);\n            } else if (record?.pk) {\n              // Navigate through to the detail page\n              const url = getDetailUrl(modelType, record.pk);\n              navigateToLink(url, navigate, event);\n            }\n          }\n        }}\n      />\n    </>\n  );\n}\n"],"names":["__iconNode","IconTable","createReactComponent","SegmentedIconControl","data","value","size","color","onChange","SegmentedControl","map","item","label","jsx","Tooltip","ActionIcon","icon","SegmentedControlPanel","props","content","option","options","selection","length","controls","PARAMETER_FILTER_OPERATORS","BooleanParameterFilter","filterValue","useMemo","filters","Select","template","name","_i18n","_","id","clearFilter","pk","closeFilter","val","setFilter","ChoiceParameterFilter","choices","split","choice","trim","GenericFilterRow","operator","readonly","placeholder","units","op","setOp","useState","useEffect","jsxs","Group","e","stopPropagation","width","event","Object","keys","TextInput","key","currentTarget","Input","GenericParameterFilter","Stack","Divider","ParameterFilter","checkbox","ParameterCell","record","canEdit","hovered","ref","useHover","parameter","parameters","find","p","extra","v","undefined","YesNoButton","data_numeric","numeric","formatDecimal","digits","push","TableHoverCard","ParametricDataTable","modelType","endpoint","queryParams","customFilters","customColumns","api","useApi","table","useTable","user","useUserState","navigate","useNavigate","parameterTemplates","useQuery","queryKey","queryFn","get","apiUrl","ApiEndpoints","parameter_template_list","params","active","for_model","exists_for_model","then","response","refetchOnMount","parameterFilters","setParameterFilters","clearParameterFilter","useCallback","templateId","filterName","prev","newFilters","forEach","paramFilters","refreshTable","addParameterFilter","toString","parametricQueryFilters","selectedInstance","setSelectedInstance","selectedTemplate","setSelectedTemplate","selectedParameter","setSelectedParameter","parameterFields","useParameterFields","modelId","addParameter","useCreateApiFormModal","url","parameter_list","title","fields","focus","onFormSuccess","updateParameterRecord","t","refetch","initialData","part","editParameter","useEditApiFormModal","records","recordIndex","findIndex","parameterIndex","updateRecord","parameterColumns","accessor","sortable","render","hasChangeRole","UserRoles","filtering","filter","close","onParameterClick","instance","open","tableFilters","tableColumns","rowActions","IconCirclePlus","hidden","hasAddPermission","onClick","Fragment","modal","InvenTreeTable","enableDownload","onCellClick","index","column","columnIndex","cancelEvent","startsWith","getDetailUrl","navigateToLink"],"mappings":"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","x_google_ignoreList":[0]}