{"version":3,"file":"Notifications-DqzN4g1-.js","sources":["../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconBellExclamation.mjs","../../../../../../frontend/node_modules/@tabler/icons-react/dist/esm/icons/IconMailOpened.mjs","../../../../../../frontend/src/tables/notifications/NotificationTable.tsx","../../../../../../frontend/src/pages/Notifications.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M15 17h-11a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6a2 2 0 1 1 4 0a7 7 0 0 1 4 6v1.5\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M9 17v1a3 3 0 0 0 6 0v-1\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M19 16v3\", \"key\": \"svg-2\" }], [\"path\", { \"d\": \"M19 22v.01\", \"key\": \"svg-3\" }]];\nconst IconBellExclamation = createReactComponent(\"outline\", \"bell-exclamation\", \"BellExclamation\", __iconNode);\n\nexport { __iconNode, IconBellExclamation as default };\n//# sourceMappingURL=IconBellExclamation.mjs.map\n","/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3 9l9 6l9 -6l-9 -6l-9 6\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M21 9v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M3 19l6 -6\", \"key\": \"svg-2\" }], [\"path\", { \"d\": \"M15 13l6 6\", \"key\": \"svg-3\" }]];\nconst IconMailOpened = createReactComponent(\"outline\", \"mail-opened\", \"MailOpened\", __iconNode);\n\nexport { __iconNode, IconMailOpened as default };\n//# sourceMappingURL=IconMailOpened.mjs.map\n","import { t } from '@lingui/core/macro';\nimport { useMemo } from 'react';\n\nimport type { RowAction } from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableState } from '@lib/types/Tables';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\nexport function NotificationTable({\n  params,\n  tableState,\n  tableActions,\n  actions\n}: Readonly<{\n  params: any;\n  tableState: TableState;\n  tableActions: any[];\n  actions: (record: any) => RowAction[];\n}>) {\n  const columns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'age_human',\n        title: t`Age`,\n        sortable: true,\n        ordering: 'creation'\n      },\n      {\n        accessor: 'category',\n        title: t`Category`,\n        sortable: true\n      },\n      {\n        accessor: 'name',\n        title: t`Notification`\n      },\n      {\n        accessor: 'message',\n        title: t`Message`\n      }\n    ];\n  }, []);\n\n  return (\n    <InvenTreeTable\n      url={apiUrl(ApiEndpoints.notifications_list)}\n      tableState={tableState}\n      columns={columns}\n      props={{\n        rowActions: actions,\n        tableActions: tableActions,\n        enableSelection: true,\n        enableBulkDelete: true,\n        params: params\n      }}\n    />\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Stack } from '@mantine/core';\nimport {\n  IconBellCheck,\n  IconBellExclamation,\n  IconCircleCheck,\n  IconMail,\n  IconMailOpened,\n  IconTrash\n} from '@tabler/icons-react';\nimport { useCallback, useMemo } from 'react';\n\nimport { ActionButton } from '@lib/components/ActionButton';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { apiUrl } from '@lib/functions/Api';\nimport { PageDetail } from '../components/nav/PageDetail';\nimport { PanelGroup } from '../components/panels/PanelGroup';\nimport { useApi } from '../contexts/ApiContext';\nimport { useTable } from '../hooks/UseTable';\nimport { NotificationTable } from '../tables/notifications/NotificationTable';\n\nexport default function NotificationsPage() {\n  const api = useApi();\n  const unreadTable = useTable('unreadnotifications');\n  const readTable = useTable('readnotifications');\n\n  const markAllAsRead = useCallback(() => {\n    api\n      .get(apiUrl(ApiEndpoints.notifications_readall), {\n        params: {\n          read: false\n        }\n      })\n      .then((_response) => {\n        unreadTable.refreshTable();\n        readTable.refreshTable();\n      })\n      .catch((_error) => {});\n  }, []);\n\n  const notificationPanels = useMemo(() => {\n    return [\n      {\n        name: 'unread',\n        label: t`Notifications`,\n        icon: <IconBellExclamation size='18' />,\n        content: (\n          <NotificationTable\n            params={{ read: false }}\n            tableState={unreadTable}\n            actions={(record) => [\n              {\n                title: t`Mark as read`,\n                color: 'green',\n                icon: <IconCircleCheck />,\n                onClick: () => {\n                  const url = apiUrl(\n                    ApiEndpoints.notifications_list,\n                    record.pk\n                  );\n                  api\n                    .patch(url, {\n                      read: true\n                    })\n                    .then((response) => {\n                      unreadTable.refreshTable();\n                    });\n                }\n              }\n            ]}\n            tableActions={[\n              <ActionButton\n                icon={<IconMailOpened />}\n                tooltip={t`Mark all as read`}\n                onClick={markAllAsRead}\n              />\n            ]}\n          />\n        )\n      },\n      {\n        name: 'history',\n        label: t`History`,\n        icon: <IconBellCheck size='18' />,\n        content: (\n          <NotificationTable\n            params={{ read: true }}\n            tableState={readTable}\n            actions={(record) => [\n              {\n                title: t`Mark as unread`,\n                icon: <IconMail />,\n                onClick: () => {\n                  const url = apiUrl(\n                    ApiEndpoints.notifications_list,\n                    record.pk\n                  );\n\n                  api\n                    .patch(url, {\n                      read: false\n                    })\n                    .then((response) => {\n                      readTable.refreshTable();\n                    });\n                }\n              },\n              {\n                title: t`Delete`,\n                color: 'red',\n                icon: <IconTrash />,\n                onClick: () => {\n                  api\n                    .delete(apiUrl(ApiEndpoints.notifications_list, record.pk))\n                    .then((response) => {\n                      readTable.refreshTable();\n                    });\n                }\n              }\n            ]}\n            tableActions={[]}\n          />\n        )\n      }\n    ];\n  }, [unreadTable, readTable]);\n\n  return (\n    <Stack>\n      <PageDetail title={t`Notifications`} />\n      <PanelGroup pageKey='notifications' panels={notificationPanels} />\n    </Stack>\n  );\n}\n"],"names":["__iconNode","IconBellExclamation","createReactComponent","IconMailOpened","NotificationTable","params","tableState","tableActions","actions","columns","useMemo","accessor","title","_i18n","_","id","sortable","ordering","jsx","InvenTreeTable","apiUrl","ApiEndpoints","notifications_list","rowActions","enableSelection","enableBulkDelete","NotificationsPage","api","useApi","unreadTable","useTable","readTable","markAllAsRead","useCallback","get","notifications_readall","read","then","_response","refreshTable","catch","_error","notificationPanels","name","label","icon","content","color","IconCircleCheck","onClick","url","record","pk","patch","response","ActionButton","IconBellCheck","IconMail","IconTrash","delete","Stack","PageDetail","PanelGroup"],"mappings":"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","x_google_ignoreList":[0,1]}